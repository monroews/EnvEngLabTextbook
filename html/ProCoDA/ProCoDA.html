

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ProCoDA: Process Control and Data Acquisition &mdash; Environmental Engineering Laboratory Research Textbook  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Nutrient Removal with Sequencing Batch Reactors" href="../Nutrient_Removal/Nutrient_Removal.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Environmental Engineering Laboratory Research Textbook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Title and Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Title_and_Preface/Title_and_Preface.html">Laboratory Research in Environmental Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Title_and_Preface/Title_and_Preface.html#laboratory-manual">Laboratory Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 1: Laboratory Safety</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Laboratory_Safety/Laboratory_Safety.html">Laboratory Safety</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 2: Laboratory Measurements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Laboratory_Measurements/Laboratory_Measurements.html">Laboratory Measurements and Procedures</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 3: Acid Rain</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Acid_Rain/Acid_Rain.html">Acid Precipitation and Remediation of Acid Lakes</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 4: Acid Neutralizing Capacity</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity.html">Acid Neutralizing Capacity</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 5: Reactor Characteristics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Reactor_Characteristics/Reactor_Characteristics.html">Reactor Characteristics</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 6: Adsorption</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Adsorption/Adsorption.html">Adsorption</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 7: Gas Transfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Gas_Transfer/Gas_Transfer.html">Gas Transfer</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 8: Nutrient Removal</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Nutrient_Removal/Nutrient_Removal.html">Nutrient Removal with Sequencing Batch Reactors</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 9: ProCoDA</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ProCoDA: Process Control and Data Acquisition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-notes">General Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-acquisition">Data Acquisition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure">Configure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sensors-config-sensors">Sensors </a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pressure-measurement">Pressure Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#temperature-measurement">Temperature Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ph-measurement-sensor-ph">pH Measurement </a></li>
<li class="toctree-l3"><a class="reference internal" href="#gran-plot">Gran Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dissolved-oxygen-sensor-do">Dissolved Oxygen </a></li>
<li class="toctree-l3"><a class="reference internal" href="#photometer-sensor-photometer">Photometer </a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calibration-steps">Calibration steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sipper-cell-flow-calibration">Sipper cell flow Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#continuous-flow-calibration">Continuous flow Calibration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logging-data">Logging Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logic-states-and-outputs-config-edit-rules">Logic, States, and Outputs </a><ul>
<li class="toctree-l3"><a class="reference internal" href="#set-points">Set Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external-code">External code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#meters-and-modbus">Meters and Modbus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tips-for-modbus-success">Tips for Modbus success!</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-an-hf-scientific-microtol-turbidimeter">Connect an HF Scientific MicroTol turbidimeter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-a-golander-peristaltic-pump">Connect a Golander Peristaltic Pump</a></li>
<li class="toctree-l4"><a class="reference internal" href="#change-the-unit-id-of-a-golander-pump">Change the Unit ID of a Golander pump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#increment-functions">Increment functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#feedback-control">Feedback Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#on-off-controller">On-Off Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="#proportional-integral-derivative-control">Proportional Integral Derivative Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#states">States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rules-config-edit-rules">Rules </a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#analog-control-of-pumps">Analog control of pumps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calibrate-peristaltic-pump-flow-rates">Calibrate peristaltic pump flow rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#on-off-devices">On-off devices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#process-operation">Process Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-set-up-a-timed-test">How to set up a timed test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#experimental-design">Experimental design</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-up-a-timed-cycle-of-two-states-run-and-warmup">Set up a timed cycle of two states (run and warmup)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-up-two-pumps">Set up two pumps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-the-end-condition-for-the-experiment">Set the end condition for the experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-your-automation-sequence">Test your automation sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#play">Play</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#wiring">Wiring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sensors">Sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modbus">Modbus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Environmental Engineering Laboratory Research Textbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>ProCoDA: Process Control and Data Acquisition</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ProCoDA/ProCoDA.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="procoda-process-control-and-data-acquisition">
<span id="title-procoda"></span><h1>ProCoDA: Process Control and Data Acquisition<a class="headerlink" href="#procoda-process-control-and-data-acquisition" title="Permalink to this headline">¶</a></h1>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>ProCoDA is easily configured process control and data acquisition software and hardware that significantly enhances experimental evaluation of unit processes and that permits fully automated parametric studies. The <a class="reference external" href="https://github.com/monroews/LabVIEW/wiki/ProCoDA">ProCoDA software</a> is a LabVIEW executable and incorporates sensors, states, rules, an external microprocessor for controls, the ability to link to external LabVIEW code to add new features, and data logging. The composite system is flexible and user friendly. First year undergraduates have used the software to control a bench top drinking water treatment plant and both undergraduate and graduate students have used the software to conduct parametric studies of methane generation, the activated sludge process, flocculation, and porous media filtration. The system offers the user the ability to program an entire series of experimental runs including variation of a parameter over a series of values and inclusion of replicate tests to confirm repeatability of the results. The automated parametric testing has greatly increased our ability to study the response of complex systems. Evaluation of colloidal particle flocculation and porous media filtration in bench-scale experiments are presented here as example applications of the ProCoDA software.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Process control is commonly used in undergraduate teaching laboratories in electrical and mechanical engineering with an emphasis on the PID (proportional, derivative, integral) control algorithm (Braatz and Johnson, 1998). Process control laboratory experiences typically focus on control of a single parameter such as flow rate, temperature, liquid level, pressure (Rehg et al., 1999), or motor angular velocity (Choi, 2004). Control of real processes generally requires integration of individual process control components into a larger system that includes data acquisition and data logging, as well as the concepts of process state and operating rules. Although researchers have frequently created customized process control code for specific applications ProCoDA is a highly configurable system that can be used to automate the control of parametric experiments or complex processes.</p>
<p>Experimental work is often characterized by repetitive experiments and the need for an individual to configure each of those experiments and then measure and record the data. In the case of engineered environmental systems we are often interested in optimizing the performance of unit processes and exploring the response of processes to a range of inputs. It is often necessary to cycle a selected process through a sequence of operational stages or states, to change process related variables, and to subject the process to a range of inputs. For example, operation of porous media filtration requires implementation of backwash, optional pretreatment, and particle challenge states. Filtration process variables might include flow velocities or the duration of a state, and inputs might include variation in the type and concentration of colloidal particles or coagulant type and dose. In conventional jar tests an experimenter would evaluate flocculation efficiency based on the turbidity of settled water or measure the critical sedimentation velocity by taking a batch sample of the flocs and measuring the turbidity as the sample settles. The measurement of settled water turbidity requires first loading the sample vial with flocs, then measuring turbidity as the flocs settle, and finally purging the sample vial with clean water. Although the states to control porous media filtration and to measure the effectiveness of flocculation could be implemented by a human operator, they are well suited for automation.</p>
<p>We have taken the automation components that are commonly used to control industrial and municipal processes and adapted them for use in the laboratory. Our objective was to create process control software that was highly configurable and link it to sensors and outputs for control. The <a class="reference external" href="https://github.com/monroews/LabVIEW/wiki/ProCoDA">ProCoDA software</a> began as data acquisition software capable of remote monitoring of experiments with easily configured sensors. The ability to control on/off devices (valves, pumps, mixers, etc.) and the ability to control continuously variable devices such as a variable flow peristaltic pumps was then added. The process control and data acquisition components were integrated and a user friendly programming environment that is highly configurable was created that incorporates the concepts of states, rules, constants, variables, and customizable external functions.</p>
<p>The guiding principle in developing the ProCoDA code was to create an application that was general and easily configured to handle a wide variety of challenges. Thus the code is not designed for a particular unit process. The goal of designing code that was highly adaptable required implementing features that make it possible for users to customize the software for specific tasks. The ProCoDA software includes a built in programming environment for defining variables, constants, and sensors and for writing the logic that controls moving from one process state to the next. To extend the capabilities of the software without making the interface overly complex the ability to use external code to define new functions was added. Examples of external code that we have used to extend the capabilities of the ProCoDA software include proportional integral derivative control algorithms, acquisition of data from turbidimeters and electronic balances over USB ports, functions that incrementally vary a parameter over a specified range and functions that take a flow rate and tubing size and calculate the peristaltic pump speed.</p>
<p>The <a class="reference external" href="https://github.com/monroews/LabVIEW/wiki/ProCoDA">ProCoDA software</a> was written using LabVIEW. The high level predefined functions, the ease of developing graphical user interfaces, and the integration with input and output devices made LabVIEW the preferred programming environment. In addition to the software we designed hardware interfaces to simplify the use of sensors and controls.</p>
<p>The <a class="reference external" href="https://github.com/monroews/LabVIEW/wiki/ProCoDA">ProCoDA software</a> runs six parallel processes during normal operation. The six processes are:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Data acquisition from the ProCoDA hardware</li>
<li>Calculation of output values, processing of rules to determine state changes, sending commands to the ProCoDA hardware, and logging of state changes and the rule that caused the state to change</li>
<li>Data logging of sensor data as well as all user defined variables</li>
<li>Graphical display of all sensor data as well as all user defined variables</li>
<li>An event loop that responds to 20 user events to initiate processes such as sensor configuration, rule editing, pump calibration, and hardware selection.</li>
<li>Modbus director loop that manages reading and writing to modbus devices.</li>
</ol>
</div></blockquote>
<p>The parallel processes are asynchronous and share data through the use of code objects (LabVIEW SubVIs) that contain both data and methods.</p>
<p>A core feature of the ProCoDA software is the user programmable feature that facilitates customization of the control logic for specific tasks. The rule editor provides a programming environment for setting up states, control logic, set points, variables defined by links to external code, and selecting which user defined parameter controls each output in each state.</p>
<p>Sensor signal wires and power supply connections have been integrated in a single cable to make sensors easy to use in a student laboratory environment. The sensors use a standardized wiring scheme so that a variety of sensors can be used in a connect-calibrate-measure approach. The elimination of power supplies at each experiment location and all of the associated wiring has made sensor use easy for students. The process control software interface for sensors allows adding and configuring sensors while simultaneously collecting data.</p>
<p>The ProCoDA hardware/software can vary the state of on/off devices as well as control devices that require a 4-20 mA signal. The on/off outputs are 24 V with sufficient current to operate small solenoid valves or to switch relays for controlling the power to any number of devices. The 4-20 mA analog outputs are used to control peristaltic pumps. External code is already provided for communication with digital devices including HF scientific turbidimeters, HF scientific AccUView UV meter, and Chemtrac meters. We also have external code to control digital peristaltic pumps using Modbus. Other Modbus devices can easily be added.</p>
<p>ProCoDA software allows the user to automate data collection and to control many parts of the experimental apparatus. This enables researchers to focus on experimental design and data analysis. Process control software can control the speed of peristaltic pumps, regulate flow through solenoid valves, and measure (or control with feedback) water quality parameters such as temperature, pressure, and dissolved oxygen.</p>
<p>The ProCoDA software is designed to allow complete automation of experiments including running a series of tests where a parameter is adjusted to a different value for each test. ProCoDA is a state machine. That means that you can create a series of states. Each state has it’s own logic for which state to go to next and what to do while in that state. A simple example of a state machine is a washing machine. Washing machine states could include</p>
<span id="table-procoda-washing-machine-states"></span><table border="1" class="colwidths-given docutils align-center" id="id10">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Washing machine states</span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="40%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">State</th>
<th class="head">What it does</th>
<th class="head">Exit rule</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Fill</td>
<td>Fills tub with selected amount of water at the requested temperature</td>
<td>Switch to <em>Agitate</em> state when pressure sensor reaches target value</td>
</tr>
<tr class="row-odd"><td>Agitate</td>
<td>Agitate to clean clothing</td>
<td>Switch to <em>Spin to remove dirty water</em> after target time is reached</td>
</tr>
<tr class="row-even"><td>Spin to remove dirty water</td>
<td>open drain and spin</td>
<td>Switch to <em>Rinse</em> after target time is reached</td>
</tr>
<tr class="row-odd"><td>Rinse</td>
<td>Add water to target level while agitating</td>
<td>Switch to <em>Spin dry</em> when target time is reached.</td>
</tr>
<tr class="row-even"><td>Spin dry</td>
<td>Spin and drain water</td>
<td>Switch to <em>off</em> when target time is reached.</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Setpoints: There are two types of setpoints in ProCoDA, constants and variables. These are the numbers that ProCoDA uses to run any of its functions (These are things like warm or cold water temperatures)</li>
<li>States: States are the different ways ProCoDA can run (These are the steps of a laundry cycle like agitate, rinse, spin)</li>
<li>Rules: These control when ProCoDA changes between states (These are like going from rinse to spin)</li>
</ul>
<div class="section" id="general-notes">
<h3>General Notes<a class="headerlink" href="#general-notes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When you input a value that is a decimal it will convert it into a form without the decimal (i.e. 0.3 will become 300m)</li>
<li>The default unit of time is seconds and we recommend using seconds consistently.</li>
<li>ProCoDA doesn’t actually use units internally. The units are only used for documentation. It is the users responsibility to make sure that you are using a consistent set of units.</li>
<li>The required set points give the order of the set points and the set points must be in the same order when you input them. The set points do not need to be contiguous! They just need to be in the correct order.</li>
<li>All added set points must be added after ON and OFF,</li>
<li>As a general rule, add new set points and states at the bottom of the list. This is because ProCoDA only tracks set points and states as elements in an array and thus if the array elements are shifted ProCoDA will refer to the wrong element.</li>
</ul>
<p>The hardware consists of box with a National Instruments data acquisition board that connects to the computer via a USB port. The box has 12 ports.
<img alt="ProCoDA_ports" src="../_images/ProCoDA_ports.png" /></p>
<blockquote>
<div><ol class="arabic simple">
<li>pump 0 and 1: Ports that control on/off, direction, and speed of peristaltic pumps. The on/off and direction controls are based on digital outputs from the data acquisition board. The speed control uses an analog output from the data acquisition board that is converted into a 4-20 mA signal.</li>
<li>sensor 0 to 3 measure voltages from sensors. The ports also contain +5V, -5V, +10V, +15V, -15V power supplies that are used to power sensors (pressure, photometer) or is used to power signal conditioning circuits that are required by some sensors (pH, dissolved oxygen, temperature, photometer).</li>
<li>24V 2 to 7 provide 24 volt outputs that can be used to power solenoid valves or relays that can then power larger electrical loads.</li>
</ol>
</div></blockquote>
<p>The distinction between <strong>inputs and outputs</strong> is <strong>critical</strong>. The pump and 24V ports are all outputs. They <strong>control devices</strong>. The sensor ports are inputs that are used to <strong>measure</strong>. Don’t plug sensors into outputs! Don’t plug pumps into 24 volt ports or into sensors! Don’t plug solenoid valves into pump or sensor ports! Don’t confuse in and out!</p>
<p>In addition to the devices that connect to the ProCoDA hardware it is possible to connect devices on a Modbus network or devices that can connect to a serial or USB port. The Modbus devices (connect to a RS 485 adaptor connected to a serial or USB port). <img alt="RS485_adaptor" src="../_images/RS485_adaptor.png" /></p>
<p>The software combines 3 elements: sensors (inputs from the real world), set points (inputs from the plant operator and calculated values based on sensors and other set points), and logic (rules that govern how the plant should operate given the sensor data and set points). The software contains a graphical user interface where you can edit, save, and open files containing sensor information and files containing the set point and logic information.</p>
</div>
</div>
<div class="section" id="data-acquisition">
<h2>Data Acquisition<a class="headerlink" href="#data-acquisition" title="Permalink to this headline">¶</a></h2>
<p>The ProCoDA software is designed to receive data from two types of digital sources. Sensors or meters that have their own digital communication interface can transmit their data to the ProCoDA software through external code that is written specifically for each meter. For example this method is used to acquire data from HF Scientific turbidimeters. Sensors that can be configured to produce an analog voltage such as pressure, pH and dissolved oxygen are monitored with a National Instruments USB data acquisition board.</p>
</div>
<div class="section" id="configure">
<span id="heading-procoda-configure"></span><h2>Configure<a class="headerlink" href="#configure" title="Permalink to this headline">¶</a></h2>
<p>The configure tab of ProCoDA is used to select the ProCoDA box that will be controlled by the software. It is possible to connect more than one ProCoDA box to a single computer and have multiple instances of the ProCoDA software running at the same time. But that is a capability that we haven’t truly tested and most users want to control a single experiment with one ProCoDA box.</p>
<p>Select the <img alt="config_select_daq" src="../_images/config_select_daq.png" /> to select the ProCoDA box and to configure the data acquisition.  <img alt="config_DAQ" src="../_images/config_DAQ.png" /> The available analog input (AI) channels (for sensors) are displayed along with the maximum voltage that can be measured. Most of our sensors have an output voltage of less than 1 volt and thus the maximum voltage can be set to 1 volt. The exception is the photometer that has an output maximum voltage of 5 V.</p>
<p>ProCoDA keeps a small amount of data in memory at all time that can be used for making decisions. This is critical because sensors area always noisy and thus it is poor practice to make decisions based on instantaneous measurements. Instead we use an average of recent data and select the amount of averaging based on the requirements for the control system. The length (in seconds) of the data record that is available in the buffer is set by the size of the buffer and the rate of sampling. The highest rate of sampling is 2500 Hz. We recommend that sampling be as fast as possible and that data averaging be used to smooth the data.</p>
<p>Data averaging is implemented by pressing the spacebar and then editing the number of samples per read. In the example below we have set samples per read to 10. In this case the data is read at 250 Hz in 10 sample chunks. Each chunk of 10 samples is averaged on its way into the ProCoDA program. Thus the data is smoothed and results in less noisy signals.
<img alt="config_samples_per_read" src="../_images/config_samples_per_read.png" /></p>
<p>The ProCoDA circuitry that sets the peristaltic pump speed can be calibrated (in software) with <img alt="config_calibrate_pump" src="../_images/config_calibrate_pump.png" />. This calibration ensures that the pump actually rotates at the speed set by ProCoDA. This calibration only needs to be done once for each pump that is controlled.</p>
<p>ProCoDA has the ability to access data from other ProCoDA software on other computers if there is a shared server where the data can be shared. This data sharing <img alt="config_share_data" src="../_images/config_share_data.png" /> makes it possible for multiple users to have access to data that is being logged at one location. In the AguaClara laboratory researchers can access the laboratory water temperature using this system. In the Environmental Engineering teaching laboratory this feature is used to enable all of the workstations to access the pressure of the air supply that is used for the gas transfer experiments.</p>
<div class="section" id="methods">
<span id="heading-procoda-methods"></span><h3>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<p>ProCoDA is highly configurable (it is after all, a friendly programming environment for laboratory automation) and those configurations or methods are saved in files. ProCoDA automatically saves ALL changes in configuration as they happen in <code class="docutils literal notranslate"><span class="pre">C:\ProCoDA</span> <span class="pre">Data\ProCoDA</span> <span class="pre">0.pcm</span></code> where the integer refers to the instance of the ProCoDA software if multiple instances are being used. This method file is automatically loaded when ProCoDA is launched. Very occasionally ProCoDA crashes and creates a corrupted method file and thus refuses to launch properly. In that case simply delete this file.</p>
<p>Given that ProCoDA automatically saves the method file that means that any mistakes in editing are immediately saved as well. To safeguard against this ProCoDA also saves a copy of the method file in the folder location where the data is being logged. We recommend that copies of the ProCoDA method also be saved in a secure location by the researcher as a third level of safety. Use the <img alt="Config_open_save_export" src="../_images/Config_open_save_export1.png" /> buttons to save the current method, retrieve a method from file, or export the method in a tab delimited file in a human readable format.</p>
</div>
</div>
<div class="section" id="sensors-config-sensors">
<span id="heading-procoda-sensors"></span><h2>Sensors <img alt="config_sensors" src="../_images/config_sensors1.png" /><a class="headerlink" href="#sensors-config-sensors" title="Permalink to this headline">¶</a></h2>
<p>Monitoring sensors requires conversion of the measured voltage into a physically meaningful unit. The data acquisition module of the ProCoDA software uses conversion files to implement a variety of conversion algorithms including polynomials and correspondence tables as well as the calibration algorithms required for pH, dissolved oxygen, and photometers. The pressure sensor conversion files make it easy to use pressure sensors to measure pressures in various physical units, to measure reactor volumes (of known cross sectional area), and flow rates (through devices with known relationships between flow and pressure drop). In addition to the application of a conversion to a physical unit it is possible to calibrate the pressure sensor output to a specific value by changing an offset.</p>
<p>The sensor part of ProCoDA includes software that eliminates the need for pH meters, dissolved oxygen meters, temperature meters. A software interface for a single wavelength photometer is also included. Any sensor that has a voltage output can be monitored.</p>
<p>Add a sensor to the list of sensors by either inserting a new unconfigured sensor, <img alt="sensor_insert" src="../_images/sensor_insert.png" />, or by selecting a configured sensor that you want to duplicate, <img alt="sensor_copy" src="../_images/sensor_copy.png" />. The <img alt="sensor_copy" src="../_images/sensor_copy.png" /> will automatically increment the channel that the sensors are connected to. You can always <img alt="sensor_delete" src="../_images/sensor_delete.png" /> any channels that you don’t want.</p>
<p>Each sensor must be connected to a sensor port <img alt="ProCoDA_ports" src="../_images/ProCoDA_ports.png" /> using
<img alt="sensor_channels" src="../_images/sensor_channels.png" />. Note that it is possible to monitor the same port more than once using ProCoDA. This would be useful if you wanted to simultaneously log both the raw voltage and a calibrated physical unit from the same sensor. This would be particularly useful if you want the option to change the conversion from voltage to physical units.</p>
<p>Sensor that have simple linear relationships between voltage and calibrated output can be easily adjusted <img alt="sensor_linear_offsets" src="../_images/sensor_linear_offsets.png" />. For example, a pressure sensor can be calibrated by setting its output to an independently measured value <img alt="sensor_set_to_value" src="../_images/sensor_set_to_value.png" />. Or the pressure could be zeroed <img alt="sensor_set_to_zero" src="../_images/sensor_set_to_zero1.png" /> under conditions of no flow (if you are measuring head loss). The offsets can be cleared, <img alt="sensor_clear_offsets" src="../_images/sensor_clear_offsets.png" />, to return to the original uncalibrated sensor output.</p>
<p>The <img alt="sensor_edit_calibration" src="../_images/sensor_edit_calibration.png" /> can be used to view how the voltage is being converted to a physical unit. This makes it possible to edit the conversion values and can be used to create conversion files for new sensors. New conversion files can be saved <img alt="sensor_save_calibration_file" src="../_images/sensor_save_calibration_file1.png" /> for use later.</p>
<p>One of the failure modes with ProCoDA occurs when a sensor produces a voltage that is outside of the range <img alt="sensor_range_error" src="../_images/sensor_range_error.png" /> that was set when configuring the data acquisition board (see <a class="reference internal" href="#heading-procoda-configure"><span class="std std-ref">ProCoDA Configure</span></a>). It is critical that the sensor voltage not be out of range. Sensors that are out of range provide useless data! Your goal is to see <img alt="sensor_no_range_error" src="../_images/sensor_no_range_error.png" />.</p>
<div class="section" id="pressure-measurement">
<span id="heading-procoda-pressure-measurement"></span><h3>Pressure Measurement<a class="headerlink" href="#pressure-measurement" title="Permalink to this headline">¶</a></h3>
<p>We use 1 psi (7 kPa) and 30 psi (200 kPa) pressure sensors (Omega sensor models PX26-001DV, and PX26-030DV) in our laboratory to measure water depth, reactor volumes, flow rates, and head loss. These sensors have maximum output voltages of 16.7 mV and 100 mV respectively with a power supply of 10 V. We use the differential pressure model since the sensors can be used to measure gage pressure or differential pressure. The sensors can directly measure water pressure although the electrical connections <strong>must be kept dry</strong>.
The ProCoDA software converts the voltage output from the pressure sensors into the physical units of water column height or pressure using linear conversion algorithms. The sensors can also be zeroed or set to a measured value using a one point calibration.</p>
<div class="figure align-center" id="id11">
<span id="figure-pressure-sensor"></span><a class="reference internal image-reference" href="../_images/pressure_sensor.jpg"><img alt="Pressure sensor" src="../_images/pressure_sensor.jpg" style="width: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Differential pressure sensors are used to measure water depth, head loss, and air pressure.</span></p>
</div>
<p>Steps to set up a pressure sensor.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Navigate to the Configuration tab</li>
<li>Click the <img alt="config_sensors" src="../_images/config_sensors1.png" /> button to select and configure your sensor (thermistor).</li>
<li>Click <img alt="sensor_insert" src="../_images/sensor_insert.png" /> to add a sensor to your list.</li>
<li>Now you need to tell ProCoDA where he pressure sensor is plugged in.  In the <img alt="sensor_channels" src="../_images/sensor_channels.png" /> pull-down menu, select the address of the pressure sensor.</li>
<li>Finally, you need to tell the software to convert the signal into a pressure.  This is done with a calibration file.  Click <img alt="sensor_open_calibration_file" src="../_images/sensor_open_calibration_file.png" /> and select the folder named with the pressure range of the sensor you are using. Then select the pressure units you would like to use.</li>
<li>You should now be reading pressure. Verify that the pressure sensor is working by gently pushing on one of the pressure ports. The goal is shove some of your skin into the port to increase the pressure! One port should respond with a positive pressure and the other port should respond with a negative pressure.</li>
<li>Use what you learned about positive and negative ports to make sure that you connect the pressure sensor to your experimental apparatus correctly.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="temperature-measurement">
<span id="heading-procoda-temperature-measurement"></span><h3>Temperature Measurement<a class="headerlink" href="#temperature-measurement" title="Permalink to this headline">¶</a></h3>
<p>We use a linear temperature sensor coupled with a simple voltage dividing circuit such as the Omega sensor model OL703. The voltage output is converted to a temperature using a linear equation.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Navigate to the Configuration tab</li>
<li>Click the <img alt="config_sensors" src="../_images/config_sensors1.png" /> button to select and configure your sensor (thermistor).</li>
<li>Click <img alt="sensor_insert" src="../_images/sensor_insert.png" /> to add a sensor to your list.</li>
<li>Now you need to tell the software where your sensor is plugged in.  In the <img alt="sensor_channels" src="../_images/sensor_channels.png" /> pull-down menu, select the address of your sensor.  All addresses begin with a Dev/ai prefix. The number in the address refers to the number on thd</li>
<li>Finally, you need to tell the software to convert the signal into temperature units.  This is done with a calibration file.  Click <img alt="sensor_open_calibration_file" src="../_images/sensor_open_calibration_file.png" /> and select the calibration file named thermistor.smc.</li>
<li>You should now be reading temperature in units of degrees Celsius. Verify that you are monitoring the correct temperature probe by holding the temperature probe in your hand and warming it up.  Does the temperature reading respond?</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="ph-measurement-sensor-ph">
<span id="heading-procoda-ph-measurement"></span><h3>pH Measurement <img alt="sensor_pH" src="../_images/sensor_pH.png" /><a class="headerlink" href="#ph-measurement-sensor-ph" title="Permalink to this headline">¶</a></h3>
<p>pH sensors produce a voltage output in the range that would normally be easy to measure using standard data acquisition hardware. Unfortunately, the impedance requirement for a pH sensor is orders of magnitude higher than the inputs of standard data acquisition hardware and thus a signal conditioning circuit must be used to amplify the pH sensor output. The circuit consists of unity gain amplifiers that have less than 0.1 pA input leakage current.</p>
<div class="figure align-center" id="id12">
<span id="figure-ph-circuit-png"></span><a class="reference internal image-reference" href="../_images/pH_circuit.png"><img alt="pH circuit" src="../_images/pH_circuit.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text">Circuit diagram for the signal conditioning circuit that takes the output from a pH (or other ion selective) electrode and amplifies the signal so that it can be measured by the data acquisition system. This is required because pH probes have a very high impedance that is too high for standard data acquisition systems to measure.</span></p>
</div>
<p>pH measurements require calibration in known buffers.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Open the ProCoDA II software.</li>
<li>Navigate to the Configuration tab and select the <img alt="config_sensors" src="../_images/config_sensors1.png" /> button.</li>
<li>Insert a new sensor at the bottom of the sensor list using the <img alt="sensor_insert" src="../_images/sensor_insert.png" /> button.</li>
<li>Select the appropriate channel based on in which sensor port you plugged you pH probe.</li>
<li>Select <img alt="sensor_pH" src="../_images/sensor_pH.png" />.</li>
<li>The pH probe should never be dry and is therefore stored with a small vial of pH 4.0 buffer screwed onto the tip.  Unscrew the storage vial cap and place the vial in a place where it will not be tipped over (the cap can stay on the probe).</li>
<li>Rinse the pH probe with DI water (use a squeeze bottle) into a beaker.</li>
<li>To calibrate the pH probe, we will use three pH buffer solutions with known pH (red=4.0, yellow=7.0, and blue=10.0).  After rinsing the pH probe, place it into the pH=4.0 buffer.  Stir gently and wait for the pH reading on the software to stabilize.  Once stabilized, press the <img alt="pH_add_buffer" src="../_images/pH_add_buffer.png" /> button.  Rinse the pH probe with DI water and repeat for the pH=7.0 and pH=10.0 buffer solutions.</li>
<li>When you have tested all calibration buffers, click, OK to exit <img alt="sensor_pH" src="../_images/sensor_pH.png" />. Click OK again to exit <img alt="config_sensors" src="../_images/config_sensors1.png" />.</li>
</ol>
</div></blockquote>
<p>The <img alt="pH_add_buffer" src="../_images/pH_add_buffer.png" /> option is used if you have additional buffers that you want to use to calibrate a pH probe. The list of buffers can also be cleared, <img alt="pH_clear_buffers" src="../_images/pH_clear_buffers.png" />, and recreated by adding new buffers.</p>
</div>
<div class="section" id="gran-plot">
<span id="heading-procoda-gran-plot"></span><h3>Gran Plot<a class="headerlink" href="#gran-plot" title="Permalink to this headline">¶</a></h3>
<p>The Gran plot is used to measure the acid neutralizing capacity or the alkalinity of a water sample.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Open the ProCoDA II software.</li>
<li>navigate to configuration, select <img alt="config_sensors" src="../_images/config_sensors1.png" />, select <img alt="sensor_pH" src="../_images/sensor_pH.png" />, and click on <img alt="Gran_start" src="../_images/Gran_start.png" />.</li>
<li>You will be prompted for the normality of titrant and the volume of sample.  You can also choose to measure ANC (acid neutralizing capacity) or BNC (base neutralizing capacity). If you are measuring BNC you will need to titrate with a strong base. After entering the normality of acid (or base) and the sample volume the computer will suggest an incremental volume of titrant that will produce a good Gran plot. Smaller incremental titrant volumes can be used, but will require more time to titrate the sample. After entering the values, exit the dialog box by clicking on the OK button. It will look like this: <img alt="Gran_get_titration_values" src="../_images/Gran_get_titration_values.png" /></li>
<li>The Gran Plot analysis uses 3 controls: <img alt="Gran_incremental_titrant" src="../_images/Gran_incremental_titrant.png" />, <img alt="Gran_accept_pH" src="../_images/Gran_accept_pH.png" />, and <img alt="Gran_end_titration" src="../_images/Gran_end_titration.png" />. The “incremental titrant added” <img alt="Gran_incremental_titrant" src="../_images/Gran_incremental_titrant.png" /> is the amount of acid added since the previous time the <img alt="Gran_accept_pH" src="../_images/Gran_accept_pH.png" /> button was clicked. For the first data point if no titrant was added the “incremental titrant added” should be set to zero. For subsequent readings, change the incremental titrant added to the volume you are adding, add the titrant with a digital pipette, wait for the pH to stabilize and then click on <img alt="Gran_accept_pH" src="../_images/Gran_accept_pH.png" />. Any amount of titrant can be added at each step, but it is important that below pH 5 the titrant volumes be smaller than the recommended value so that sufficient data points are obtained in the linear region.</li>
<li>There is no way to delete unwanted data points after they are accepted. Therefore, make sure you only press the enter button once after each addition of titrant.</li>
<li>Continue adding titrant until a line is fit through the linear region of the data. When the line is drawn through the linear region press <img alt="Gran_end_titration" src="../_images/Gran_end_titration.png" />. Note that <img alt="Gran_end_titration" src="../_images/Gran_end_titration.png" /> accepts the last data point and ends the titration. <img alt="Gran_end_titration" src="../_images/Gran_end_titration.png" /> is pressed after the last addition of acid INSTEAD of pressing <img alt="Gran_accept_pH" src="../_images/Gran_accept_pH.png" />!</li>
<li>The equivalent volume (<span class="math notranslate nohighlight">\(V_e\)</span>) is given in the same units as were used for the titrant and sample volumes. The equivalent volume is the abscissa intercept of the line fit to the data in the region of constant slope. The ANC is given in equivalents per liter.</li>
<li>If desired the titration data can be saved in tab delimited format by selecting  <img alt="Gran_save" src="../_images/Gran_save1.png" />. You will be prompted for a file name and location.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="dissolved-oxygen-sensor-do">
<span id="heading-procoda-dissolved-oxygen"></span><h3>Dissolved Oxygen <img alt="sensor_DO" src="../_images/sensor_DO.png" /><a class="headerlink" href="#dissolved-oxygen-sensor-do" title="Permalink to this headline">¶</a></h3>
<p>Dissolved oxygen diffuses across a gas-permeable membrane into a solution where all oxygen is immediately converted to water by an electrolysis circuit.</p>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-0">
<span class="eqno">(129)<a class="headerlink" href="#equation-procoda-procoda-0" title="Permalink to this equation">¶</a></span>\[4e^- + 4H^+ + O_2 \to 2H_2O\]</div>
<p>The current required to reduce the oxygen that is diffusing across the membrane is measured by a circuit. Dissolved oxygen probes produce a current in the pA range that is proportional to the oxygen concentration in the bulk solution. The signal conditioning circuit is designed to convert this very small current into a measurable voltage and to isolate the probe from the effects of fluctuations in the voltage level of the solution containing the probe. This isolation is critical if the solution is monitored with additional probes or if the solution is electrically connected to a building plumbing system or to any other voltage source.</p>
<p>When using the DO probe make sure that there <em>aren’t any air bubbles</em> on the probe membrane. If you are aerating the sample place the probe as far from the air bubbles as possible. Air bubbles on the membrane will cause inaccurate readings.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The dissolved oxygen probe will read out voltages in the range of +/- 5V, so we will need to let the software know to expect that range. On the Configuration Tab in the ProCoDA II software, find the section for the NI Input/Output device and hit the <img alt="config_select_daq" src="../_images/config_select_daq.png" /> button. Set the maximum voltage for channel with the dissolved oxygen probe to 5V.</li>
<li>Connect a Gravity: Analog Dissolved Oxygen Sensor to one of the sensor ports on the ProCoDA box.</li>
<li>Navigate to the ProCoDA Configuration tab and select <img alt="config_sensors" src="../_images/config_sensors1.png" /> to configure the dissolved oxygen channel(s).</li>
<li><strong>Select the DO probe from the sensor list</strong> (This is important! Otherwise you will turn a different sensor into a DO probe!) and point the channel to the correct sensor port.</li>
<li>Click on <img alt="sensor_DO" src="../_images/sensor_DO.png" /> to calibrate the DO probe.</li>
<li>Enter the temperature of the sample. This can be measured by using a thermistor or a thermometer. A good estimate is <span class="math notranslate nohighlight">\(22^\circ C\)</span>. If you have a thermistor connected to ProCoDA you can configure the oxygen probe to incorporate continuous temperature readings into the calculation of the dissolved oxygen concentration.</li>
<li>Create a zero oxygen solution (50 mL is sufficient) by adding <span class="math notranslate nohighlight">\(10 \mu g/L\)</span> cobalt chloride as a catalyst and an excess of <a class="reference internal" href="../Gas_Transfer/Gas_Transfer.html#heading-gas-transfer-deoxygenation"><span class="std std-ref">sodium sulfite</span></a> to react with all of the dissolved oxygen.</li>
<li>Wait for the probe voltage readings to stabilize. They should reach approximately -1.3 V.  Then click on <img alt="DO_zero" src="../_images/DO_zero.png" />.</li>
<li>The current atmospheric pressure is required so that ProCoDA can calculate the equilibrium concentration in saturated water. The local air pressure can be obtained from the <a class="reference external" href="https://www.weather.gov">National Weather Service</a> Be careful with the units when you enter the value in <img alt="DO_set_barometric" src="../_images/DO_set_barometric.png" />. Atmospheric pressure is always close to 100 kPa.</li>
<li>Place the probe in oxygen saturated water (bubble air into water in a small container).  The voltage from the DO probe should be approximately <span class="math notranslate nohighlight">\(0 \pm 0.2 V\)</span> if the probe is working correctly. If the voltage is not in that range it may be time to replace the membrane or the solution may not be saturated with oxygen.</li>
<li>Select <img alt="DO_set_to_saturation" src="../_images/DO_set_to_saturation.png" /> to calibrate the DO sensor.</li>
<li>Select OK when you are satisfied with the calibration.</li>
<li>If desired you may save the calibration for later use <img alt="sensor_save_calibration_file" src="../_images/sensor_save_calibration_file1.png" />. However, it is not necessary to save the calibration to use the calibration because it is automatically saved as part of the ProCoDA method file..</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="photometer-sensor-photometer">
<span id="heading-procoda-photometer"></span><h3>Photometer <img alt="sensor_photometer" src="../_images/sensor_photometer.png" /><a class="headerlink" href="#photometer-sensor-photometer" title="Permalink to this headline">¶</a></h3>
<p>The photometer is a flow cell with an optical path length of 19 mm. The flow cell has 1/8 inch NPT threads for connections to experimental or sample streams from processes. The photometer uses a KingBright LED (Digikey part 754-1489-ND) with an emission peak at 465 nm as its light source. The spectral bandwidth defined by 50% of the dominant wavelength is 25 nm.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; importing &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">aguaclara.core.units</span> <span class="k">import</span> <span class="n">unit_registry</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">aguaclara</span> <span class="k">as</span> <span class="nn">ac</span>
<span class="n">b_cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b_cell</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id13">
<span id="figure-photometer-exploded"></span><a class="reference internal image-reference" href="../_images/Photometer_exploded1.jpg"><img alt="Photometer exploded" src="../_images/Photometer_exploded1.jpg" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 29 </span><span class="caption-text">The photometer flow cell is a sealed chamber with round glass plates on both sides. There is a 465 nm LED (blue light) on the right of this image. A photodetector on the left produces a voltage that varies linearly with the intensity of the light that passes through the sample cell.</span></p>
</div>
<div class="figure align-center" id="id14">
<span id="figure-photometer-w-signal-conditioning"></span><a class="reference internal image-reference" href="../_images/Photometer_w_signal_conditioning.jpg"><img alt="photometer with signal conditioning" src="../_images/Photometer_w_signal_conditioning.jpg" style="width: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">The photometer must always be held in a vertical orientation to ensure that air bubbles are carried out of the sample cell. The sensor output is conditioned for monitoring by ProCoDA in the black box.</span></p>
</div>
<p>To calibrate the photometer, you will need to connect the peristaltic pump, a 1 L bottle, and the photometer in a closed loop. Use enough tubing so that the flow path of the photometer is oriented in the vertical direction with flow <strong>up</strong> through the photometer (this ensures that air bubbles are carried up and out of the photometer). Add 1 L (or a known volume) of tap water to the bottle and turn the pump on at 380 mL/min. The high flow rate is to speed up the response time when the concentration is changed. The goal is to have a known volume of solution circulating through the calibration system.</p>
<div class="figure align-center" id="id15">
<span id="figure-sensor-photometer-cal-schematic-png"></span><a class="reference internal image-reference" href="../_images/sensor_photometer_cal_schematic.png"><img alt="internal figure" src="../_images/sensor_photometer_cal_schematic.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">Experimental setup for calibrating photometer. Flow must be <strong>up</strong> through the photometer to ensure that any air bubbles are removed. It may be necessary to lightly tap the photometer to help release any trapped air bubbles.</span></p>
</div>
<div class="section" id="calibration-steps">
<h4>Calibration steps<a class="headerlink" href="#calibration-steps" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ol class="arabic simple">
<li>Connect the photometer probe to one of the sensor ports of your ProCoDA box.</li>
<li>The photometer will read out voltages in the range of +/- 5V, so we will need to let the software know to expect that range. On the Configuration Tab in the ProCoDA II software, find the section for the NI Input/Output device and hit the <img alt="config_select_daq" src="../_images/config_select_daq.png" /> button. Set the maximum voltage for channel with the photometer to 5V.</li>
<li>Navigate to the ProCoDA configuration tab and then select <img alt="config_sensors" src="../_images/config_sensors1.png" />.</li>
<li>Select the sensor in the sensor list that you want to configure as a photometer.</li>
<li>Make sure that the sensor channel is set correctly.</li>
<li>Select <img alt="sensor_photometer" src="../_images/sensor_photometer.png" />. You will see a voltage reading in the top right corner. When the LED light in the photometer is off (toggle switch in the middle) the voltage should read approximately -1.3 V. When the LED is light in the photometer is on (toggle switch to the left or right) the voltage should read approximately +3.5 V. Verify that this range is being measured and is stable in the off and on configuration. If the voltage is -1 V or +1 V, check to make sure that the voltage range for the sensor was set correctly (set step 2). If the voltage is zero, check the ProCoDA power supply. If the voltage with the LED on is less than +3.5 V, then pump water up through the photometer and tap it gently to release the air bubble that is reflecting light in the sample cell.</li>
<li>Turn the LED off and when the voltage is stable and approximately -1.3 V click on <img alt="photometer_read_dark" src="../_images/photometer_read_dark.png" />.</li>
<li>Turn the LED on with the blank solution in the photometer and click on <img alt="photometer_read_blank" src="../_images/photometer_read_blank.png" />. Remember the voltage should be approximately +3.5 V.</li>
</ol>
</div></blockquote>
<p>An example continuous flow calibration routine is given below. We suggest preparing a 40 g/L stock solution of Red Dye #40 to make a calibration curve for the photometer. Calculate the volume of red dye that will be needed to generate a calibration with points at 0, 1, 2, 5, 10, 20, 30, 40, and 50 mg/L. Remember that you will be adding the dye cumulatively and thus you need to calculate the incremental volumes. The first calibration point is 0 mg/L. This is the same as the blank.</p>
</div>
<div class="section" id="sipper-cell-flow-calibration">
<h4>Sipper cell flow Calibration<a class="headerlink" href="#sipper-cell-flow-calibration" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Insert the sipper tube into the standard (x mg/L) and use the syringe to pull the standard through the photometer.</li>
<li>Make sure that any air bubbles have been dislodged from the photometer and the voltage reading is stable.</li>
<li>Click on read standard next to the x mg/L row.</li>
<li>Use the syringe to push the standard back into the bottle</li>
<li>Rinse the photometer with the same water that is used for the blank if sample carry-over is a concern</li>
<li>Repeat for the other standards. The R squared value should be greater than 0.99.</li>
<li>When you are done, click on the save icon in <img alt="photometer_open_save_export" src="../_images/photometer_open_save_export1.png" /> to save the calibration as a file. This calibration should be good for as long as the LED lasts, which should be a very long time!</li>
<li>Use the export icon to create a tab delimited file containing all of the calibration data.</li>
</ol>
</div>
<div class="section" id="continuous-flow-calibration">
<h4>Continuous flow Calibration<a class="headerlink" href="#continuous-flow-calibration" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ol class="arabic simple">
<li>Click on read standard next to the 0 mg/L row before adding any red dye.</li>
<li>Add red dye to make the concentration in the calibration system be 1 mg/L. If necessary, hit “Add Standard” and enter the concentration of the standard you are reading. This approach allows you to see how well the data is fitting to a straight line as you add the standards.</li>
<li>Continue to add dye, add standard, equilibrate, read standard until you have a full calibration and all of the standards have been read. The R squared value should be greater than 0.99.</li>
<li>When you are done, click on the save icon in <img alt="photometer_open_save_export" src="../_images/photometer_open_save_export1.png" /> to save the calibration as a file. This calibration should be good for as long as the LED lasts, which should be a very long time!</li>
<li>Use the export icon to create a tab delimited file containing all of the calibration data.</li>
</ol>
</div></blockquote>
<p>The photometer calibrator calculates the absorbance using the equation.</p>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-1">
<span class="eqno">(130)<a class="headerlink" href="#equation-procoda-procoda-1" title="Permalink to this equation">¶</a></span>\[A = -log \frac{V_{Sample} - V_{Dark}}{V_{Blank} - V_{Dark}}\]</div>
<p>This equation can be used to convert raw voltage data into absorbance readings. The absorbance is converted into a concentration by using Beer’s law.</p>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-2">
<span class="eqno">(131)<a class="headerlink" href="#equation-procoda-procoda-2" title="Permalink to this equation">¶</a></span>\[A = \varepsilon bC\]</div>
<dl class="docutils">
<dt>where</dt>
<dd><div class="first line-block">
<div class="line"><span class="math notranslate nohighlight">\(\varepsilon\)</span> is the extinction coefficient for that particular wavelength and that particular dissolved species</div>
<div class="line"><span class="math notranslate nohighlight">\(b\)</span> is the optical path length</div>
<div class="line"><span class="math notranslate nohighlight">\(C\)</span> is the concentration of the dissolved species</div>
</div>
<p class="last">Given that <span class="math notranslate nohighlight">\(A\)</span> is dimensionless the extinction coefficient takes on whatever units are required.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="logging-data">
<span id="heading-procoda-logging-data"></span><h2>Logging Data<a class="headerlink" href="#logging-data" title="Permalink to this headline">¶</a></h2>
<p>ProCoDA offers two distinct methods of logging data. The first method is accessed by selecting a folder (not a file!) where you would like to save data. <img alt="config_data_state_log" src="../_images/config_data_state_log.png" /> In that system ProCoDA automatically creates 3 different types of files (data log, state log, and method file) and saves them. This approach is ideal for long term experiments that span multiple days. Every day at midnight ProCoDA starts a new data log and state log file. The daily saving and closing of the files reduces the risk of data loss due to a power failure or file corruption. The “Datalog File Failure” indicator is the one (and only) red indicator light that can be safely ignored while use ProCoDA! The state logs are particularly useful when ProCoDA is used to cycle through a series of experiments or through a series of states and thus the data may only be of interest in one of those states.</p>
<p>The second method of saving data only creates a data log file. This can be most convenient for short duration experiments where the researcher is present during the experiment. Data is being logged when the data log icon is green. <img alt="config_Logging_data_short_exp" src="../_images/config_Logging_data_short_exp2.png" /></p>
<p>The data interval can be set for both data logging methods. The data from the data buffer is averaged according to the user selected data log interval. It is important to recognize that the logged data is <strong>not</strong> the same as the data that is used by ProCoDA to make decisions. The averaging interval used to make decisions and the averaging interval used to log data are both user selected values and are independent. This distinction becomes clear when ProCoDA logic appears to make decisions that are not in agreement with the logged data. This occurs when noisy data is used to make a decision (such as a state transition) and when smoothed data is recorded in the data file.</p>
</div>
<div class="section" id="logic-states-and-outputs-config-edit-rules">
<span id="heading-procoda-logic"></span><h2>Logic, States, and Outputs <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" /><a class="headerlink" href="#logic-states-and-outputs-config-edit-rules" title="Permalink to this headline">¶</a></h2>
<p>ProCoDA’s ability to quickly set up a state machine is all contained inside the rule editor.</p>
<p>The programming environment for creating rules that determine exit conditions for states and which state to go to readily facilitates setting up the algorithms for controlling simple repetitive processes such as a sequencing batch reactors or rapid sand filters. For experimental purposes it is desirable to have the capability to systematically vary a parameter to test the performance of the process over a range of input values. This is accomplished via an external code that compares the number of specified replicates to a parameter that increments when the ProCoDA enters a specified state. The output parameter can be used to control pump speeds, times, or can be an input to subsequent calculations.</p>
<p>A word of caution. The sensors, set points, and states are used within the rule editor. If new sensors, set points or states are added in the middle of their respective lists or deleted from their lists any rules that were created previously may be incorrect. The software does not attempt to correct for changes in the lists of set points and states. It is your responsibility to verify that all rules are correct when making changes to the configuration. You can minimize this problem by adding states, set points, and sensors at the end of their respective lists.</p>
<div class="section" id="set-points">
<span id="heading-procoda-set-points"></span><h3>Set Points<a class="headerlink" href="#set-points" title="Permalink to this headline">¶</a></h3>
<p>The rule editor provides a graphical user interface where the operator can completely configure the control logic for the plant. Begin by creating the set points for the process. Set points can include time, parameters that can be compared with sensor values, parameters that are required inputs for external code, and parameters that are outputs of external code. Set points that are outputs of external code are designated as variables. The only constraint on developing the list of set points is that set points that are inputs to external code must be in the same order (although they don’t have to be adjacent) in the list of set points as they are expected by the external code.</p>
<p>When adding a new set point the name, value and unit of the set point can be edited in the Set Points control. The list of the Current set points functions as the index to the array of Set Points, thus allowing the operator to select and edit any of the set points. The unit field is not used by the process controller, but is a reminder for the operator. It is imperative that the units of the set points be the same as the units of the sensor data that they will be compared with.</p>
<p><img alt="SetPoints_filter_example" src="../_images/SetPoints_filter_example.png" /></p>
<p>When configuring a set point as a variable calculated by external code first load the code by clicking on the folder icon. If the code fails to load it is either because the external code doesn’t have the correct connector pane or because the external code has sub VIs that aren’t in the same folder as the external code. If the code loads correctly it will display the list of needed inputs at the bottom of the dialog box.</p>
</div>
<div class="section" id="external-code">
<span id="heading-procoda-external-code"></span><h3>External code<a class="headerlink" href="#external-code" title="Permalink to this headline">¶</a></h3>
<p>LabVIEW executables can be enabled to connect to external code. This capability makes it possible to easily extend the capabilities of the ProCoDA software. The external code must be designed to meet specific requirements for the data types of inputs and outputs. An external code interface has been created to take a variable number of numeric inputs and produce a single numeric output. The external code can be used for a wide variety of functions including simple math functions, a specialized function (such as one which sets a coagulant dose based on raw water turbidity) proportional-integral-derivative control that can be used to force a controlled parameter to a desired set point, data acquisition functions that acquire digital data from instruments, and control functions that set the speed of peristaltic pumps that are connected to a USB port and a Modbus network.</p>
</div>
<div class="section" id="meters-and-modbus">
<span id="heading-procoda-meters"></span><h3>Meters and Modbus<a class="headerlink" href="#meters-and-modbus" title="Permalink to this headline">¶</a></h3>
<p>Turbidimeters, particle counters, peristaltic pumps, and many industrial devices, can communicate with ProCoDA through a Modbus network. These devices are treated like functions and their data is accessed with an external function call in the set point list (Accessed through <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" />).</p>
<p>ProCoDA connects to a Modbus network through either a serial port or a USB port with an adaptor that converts to RS485 (a serial communication standard that is widely used in industry). The Modbus system uses digital communication and enables ProCoDA to precisely control pumps and to acquire data from various meters.</p>
<div class="section" id="tips-for-modbus-success">
<h4>Tips for Modbus success!<a class="headerlink" href="#tips-for-modbus-success" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Make sure all devices that are connected to the Modbus network are turned on (have power)! Otherwise the entire network will fail.</li>
<li>When changing the unit ID on a device it is necessary to turn the device off and back on again to ensure that it has switched to the new unit ID.</li>
<li>Make sure that all devices have unique unit IDs. (Double check this!!!)</li>
<li>Make sure that the communication protocol for all devices is
* Even Parity (default on Golander pumps, not default on HF turbidimeters - in the extended configuration)
* 9600 Baud
* Modbus RTU (not ASCII)</li>
<li>Use a data interval greater than 1 s for meters because the Modbus read takes a significant fraction of a second <strong>per device</strong>.</li>
<li>Go to the Configuration tab and select <img alt="Pick_visa_modbus" src="../_images/Pick_visa_modbus.png" /> to connect to the serial port that is used for modbus communication before configuring individual devices. This port will be used by all modbus devices. If no ports are available it means that no USB to serial converter is connected to your computer. If multiple ports are available you may need to use trial and error to figure out which port is the correct one. Select Exit to close the dialog.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="connect-an-hf-scientific-microtol-turbidimeter">
<h4>Connect an HF Scientific MicroTol turbidimeter<a class="headerlink" href="#connect-an-hf-scientific-microtol-turbidimeter" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ol class="arabic simple">
<li>Go to <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" /> on the Configuration tab.</li>
<li>Add a set point for the data rate (the time interval that ProCoDA will request a turbidity update from the meter). 1 second would be very fast, 60 s would be slow.|SetPoints_turbidimeter_datarate|</li>
<li>Add a second set point for the Turbidimeter address <img alt="SetPoints_turbidimeter_address" src="../_images/SetPoints_turbidimeter_address.png" /></li>
<li>Check the unit ID on the turbidimeter (press <img alt="HF_mode_exit" src="../_images/HF_mode_exit.png" /> twice to select the config option. Then press <img alt="HF_return" src="../_images/HF_return.png" /> twice to select ADDR. You can adjust the unit ID using the up or down arrows. Press <img alt="HF_mode_exit" src="../_images/HF_mode_exit.png" /> once more to exit and return to the turbidity view screen.)</li>
<li>Add a third setpoint that will be the measured turbidity.</li>
<li>Change the setpoint from a constant to a variable</li>
<li>Now more options will appear click on the folder icon which will open a dialog box</li>
<li>Select <em>Modbus devices</em> and then select <em>HF turbidimeter</em></li>
<li>Select the required set points. <img alt="SetPoints_code_inputs" src="../_images/SetPoints_code_inputs.png" /> If successful the turbidity displayed on the meter should show up as the value. If there is a communication error you will get a -999.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="connect-a-golander-peristaltic-pump">
<span id="heading-procoda-golander-peristaltic-pump"></span><h4>Connect a Golander Peristaltic Pump<a class="headerlink" href="#connect-a-golander-peristaltic-pump" title="Permalink to this headline">¶</a></h4>
<p>The first step in setting up a pump is to calculate the required flow rate and then select the type of pump head (Easy-Load or 6 roller Ismatec) and the tubing size. For Easy-Load L/S Masterflex pump heads the recommended tubing sizes and corresponding range of flow rates are given below. Note that the #13 tubing is NOT recommended because the Easy-Load pump heads don’t create a seal with this small tubing. There are usually many viable solutions for tubing size. The Golander pumps have a minimum of 0.1 rpm and the maximum rpm is a function of the pump model.
The Ismatec pump heads are useful for dosing coagulant, clay, fluoride, acid, base, etc. that are used to amend the properties of a primary flow that is pumped with an Easy-Load pump head.</p>
<span id="table-procoda-pump-tubing"></span><table border="1" class="docutils align-center" id="id16">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">Pump tubing selection.</span><a class="headerlink" href="#id16" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Tubing Size</th>
<th class="head">14</th>
<th class="head">16</th>
<th class="head">17</th>
<th class="head">18</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tubing diameter</td>
<td>1.6 (mm)</td>
<td>3 (mm)</td>
<td>6.3 (mm)</td>
<td>8 (mm)</td>
</tr>
<tr class="row-odd"><td>Flow per revolution</td>
<td>0.21 (mL/rev)</td>
<td>0.80 (mL/rev)</td>
<td>2.8 (mL/rev)</td>
<td>3.8 (mL/rev)</td>
</tr>
<tr class="row-even"><td>1 (rpm)</td>
<td>0.0035 (mL/s)</td>
<td>0.0133 (mL/s)</td>
<td>0.0467 (mL/s)</td>
<td>0.0633 (mL/s)</td>
</tr>
<tr class="row-odd"><td>50 (rpm)</td>
<td>0.1750 (mL/s)</td>
<td>0.6667 (mL/s)</td>
<td>2.3333 (mL/s)</td>
<td>3.1667 (mL/s)</td>
</tr>
<tr class="row-even"><td>100 (rpm)</td>
<td>0.3500 (mL/s)</td>
<td>1.3333 (mL/s)</td>
<td>4.6667 (mL/s)</td>
<td>6.3333 (mL/s)</td>
</tr>
</tbody>
</table>
<p>A similar table is available for 3-stop tubing used on <a class="reference external" href="http://www.ismatec.com/int_e/pumps/t_mini_s_ms_ca/tubing_msca2.htm">Ismatec 6 roller pump heads</a>.
The volume per revolution can also be obtained using the following python code.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aguaclara.core.units</span> <span class="k">import</span> <span class="n">unit_registry</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">aguaclara</span> <span class="k">as</span> <span class="nn">ac</span>
<span class="c1"># to find the volume per rev for Masterflex L/S pump heads</span>
<span class="n">ac</span><span class="o">.</span><span class="n">vol_per_rev_LS</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># to find the volume per rev for Ismatec 6 roller pump heads with 3 stop Tubing</span>
<span class="n">ac</span><span class="o">.</span><span class="n">vol_per_rev_3_stop</span><span class="p">(</span><span class="s1">&#39;purple-white&#39;</span><span class="p">)</span>
<span class="c1"># or using the ID of the Tubing</span>
<span class="n">ac</span><span class="o">.</span><span class="n">vol_per_rev_3_stop</span><span class="p">(</span><span class="n">inner_diameter</span><span class="o">=</span><span class="mf">0.12</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mm</span><span class="p">)</span>
</pre></div>
</div>
<p>After selecting the pump head and tubing it is time to set up ProCoDA control of the pump.</p>
</div>
<div class="section" id="change-the-unit-id-of-a-golander-pump">
<h4>Change the Unit ID of a Golander pump<a class="headerlink" href="#change-the-unit-id-of-a-golander-pump" title="Permalink to this headline">¶</a></h4>
<p>The model BT50S Golander pumps do not have the ability to change the unit ID using the controls on the pump. The unit ID is set instead using ProCoDA. Changing the unit ID is a little complicated because we start with the assumption that we don’t know the unit ID of the device that we want to set. The method that Modbus provides for this case is to broadcast a command to ALL DEVICES telling them to change their unit ID. But, of course, this would be a bad idea if there are multiple devices listening because we don’t want all of the devices to have the same unit ID! The solution is to disconnect all of the other Modbus devices by unplugging their cables. After the cables are disconnected</p>
<blockquote>
<div><ol class="arabic simple">
<li>Disconnect all other Modbus devices (unplug their cables) so that ProCoDA is only communicating with ONE DEVICE! This is important because the command to change the address is broadcast to all devices on the Modbus network.</li>
<li>Open <img alt="config_set_modbus_ID" src="../_images/config_set_modbus_ID.png" /> on the Configuration tab.</li>
<li>Select the serial port that is connected to the Modbus network</li>
<li>Select the Unit ID that you would like for the one device that is connected to the Modbus network</li>
<li>Hit Set device ID and Exit!</li>
<li>Turn off the device and turn it back on again!!!!!!! This is REQUIRED because otherwise the change you made won’t be implemented by the device and communication will fail!</li>
<li>Golander 50S pumps display the unit ID on startup.</li>
</ol>
</div></blockquote>
<p>Now you can configure a Golander pump using the Rule Editor. The external code for Golander pumps require 4 inputs: pump address, on state, pump (ml/rev), and flow (mL/s).</p>
<blockquote>
<div><ol class="arabic simple">
<li>Go to <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" /> on the Configuration tab.</li>
<li>Add a set point for the pump ID (or pump address) <img alt="SetPoints_pump_address" src="../_images/SetPoints_pump_address.png" /></li>
<li>Add a set point for the states that you want the pump to run <img alt="SetPoints_on_state" src="../_images/SetPoints_on_state.png" />. The states are identified as integers with the OFF state having a value of 0. To have the pump run in more than one state simple enter the digits. The assumption here is that ProCoDA won’t have more than 10 states. Thus the on state 134 means that the pump should run in states 1, 3, and 4.</li>
<li>Add a set point for the volume of water pumped per revolution with unis of mL/rev.</li>
<li>Add a set point for the desired flow rate with units of mL/s.</li>
<li>Add a set point for the pump control</li>
<li>Change the setpoint from a constant to a variable</li>
<li>Now more options will appear click on the folder icon which will open a dialog box</li>
<li>Select <em>Modbus devices</em> and then select <em>Golander pump(mL per s, mL per rev)</em></li>
<li>Select the required set points</li>
</ol>
</div></blockquote>
<p>Note that the pump control is the pump rpm. The pump control will only display the correct rpm if ProCoDA is in one of the states that you have defined as an on state. Otherwise the pump control will be 0. If you want the pump to turn in a counterclockwise direction, simple set the flow rate to have a negative value.</p>
<p>Below is an example of a ProCoDA method that has 2 pumps. The set points are defined in an order that makes it easy to select them in the right order for each pump and keeps the list neatly organized.
<img alt="SetPoints_Golander" src="../_images/SetPoints_Golander.png" /></p>
</div>
</div>
<div class="section" id="increment-functions">
<h3>Increment functions<a class="headerlink" href="#increment-functions" title="Permalink to this headline">¶</a></h3>
<p>A common experimental task is to systematically vary a parameter (for example, coagulant dose) over a wide range to measure the response (for example, settled water turbidity) of a system. ProCoDA external functions provide linear and power law options for incrementing over a range of values.</p>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-3">
<span class="eqno">(132)<a class="headerlink" href="#equation-procoda-procoda-3" title="Permalink to this equation">¶</a></span>\[y_{linear} = slope \cdot x + intercept\]</div>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-4">
<span class="eqno">(133)<a class="headerlink" href="#equation-procoda-procoda-4" title="Permalink to this equation">¶</a></span>\[y_{power} = coefficient \cdot base^x\]</div>
<p>The two increment functions are dependent on the state cycles. In the example shown in <a class="reference internal" href="#figure-increment-functions"><span class="std std-numref">Fig. 32</span></a> the state was set to cycle between states 1, 2, and 3 with the exception of a manual reset to state 0 and then to state 1 to illustrate how the increment function is reset. The power law function is useful when it is desirable to explore a larger parameter space. However, care must be taken to ensure that the controlled processes have the ability to deliver the desired range of the varied parameter.</p>
<p>ProCoDA can be configured to stop an experiment after the reaching the maximum value of the parameter by using the external code called “count states”. Count states counts the number of times a “state to count” has been entered. This can be used to set an exit condition on a state. If no exit condition is created to end an experiment the increment function will reset the parameter to its initial value and begin the increment process again.</p>
<p>It is possible to systematically vary more than one parameter. To do this it is essential that different copies of the increment function code be used for each parameter. This is because increment function code includes a memory to track its own state and if it is used by ProCoDA to do multiple things it will give unexpected results!</p>
<div class="figure align-center" id="id17">
<span id="figure-increment-functions"></span><a class="reference internal image-reference" href="../_images/increment_functions.png"><img alt="Increment functions" src="../_images/increment_functions.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">Increment functions showing how the output varies as a function of the state. In this example the state cycled between states 1, 2, and 3. The increment state was 2, the number of replicates was 2, the reset state was 0, the y intercept was 200, the slope was 50, and the maximum value of x was 4. The power law relationship used a coefficient of 100 and a base of 1.5.</span></p>
</div>
</div>
<div class="section" id="feedback-control">
<span id="id4"></span><h3>Feedback Control<a class="headerlink" href="#feedback-control" title="Permalink to this headline">¶</a></h3>
<p>Feedback control uses a measured value to make a decision in real time and change an output to achieve a desired effect. ProCoDA offers two types of feedback control. ALl of the feedback controller code has a memory and thus if multiple feedback controllers are used at the same time to control different outputs it is necessary to use external code with different names so that each process has its own memory. Different versions of these control codes are already available in the feedback control folder for this purpose.</p>
<div class="section" id="on-off-controller">
<span id="id5"></span><h4>On-Off Controller<a class="headerlink" href="#on-off-controller" title="Permalink to this headline">¶</a></h4>
<p>The on-off controller turns an output on when a measured value is below a threshold and turns the output off when a measured value is above a threshold.
The “off value” is the output value of the controller when the controller is off and the “on value” is the output value when the controller is on. The minimum and maximum targets can be the same value. The controller turns on when the measured process value drops below the maximum target and then turns off again when the measured process value rises above the maximum target. Under ideal conditions the measured process value will oscillate between the minimum and maximum targets. Depending on the process the measured process value may oscillate far beyond the minimum and maximum targets.</p>
</div>
<div class="section" id="proportional-integral-derivative-control">
<span id="id6"></span><h4>Proportional Integral Derivative Control<a class="headerlink" href="#proportional-integral-derivative-control" title="Permalink to this headline">¶</a></h4>
<p>Proportional Integral Derivative (PID) Control is a commonly used control strategy that provides an algorithm to adjust an output to produce the desired response in a process. A simple example is cruise control that uses the measured speed of the vehicle and a target setpoint speed to adjust the voltage to an electric motor to minimize the error between the target speed and the measured speed.</p>
<p>The equation for PID control is given below (<a class="reference external" href="https://en.wikipedia.org/wiki/PID_controller#PID_controller_theory">see the wikipedia article</a>).</p>
<div class="math notranslate nohighlight" id="equation-procoda-procoda-5">
<span class="eqno">(134)<a class="headerlink" href="#equation-procoda-procoda-5" title="Permalink to this equation">¶</a></span>\[u(t) = K_{\mathrm{p}} e(t) + K_{\mathrm{i}} \int_{0}^{t} e(\tau) d \tau + K_{\mathrm{d}} \frac{d e(t)}{d t}\]</div>
<p>where <span class="math notranslate nohighlight">\(u(t)\)</span> is the controller output, <span class="math notranslate nohighlight">\(t\)</span> is the current time, <span class="math notranslate nohighlight">\(e(t)\)</span> is the current error (target value - measured value) <span class="math notranslate nohighlight">\(K_{\mathrm{i}}\)</span> and <span class="math notranslate nohighlight">\(K_{\mathrm{d}}\)</span> have units of minutes as implemented in ProCoDA.</p>
<p>To establish constants for PID control in ProCoDA, follow the <a class="reference external" href="https://en.wikipedia.org/wiki/PID_controller#Manual_tuning">manual tuning procedure</a>. The steps will be summarized below.</p>
<p>Select a PID controller that uses either a sensor or a setpoint as the measured process value. For example if a pressure sensor is used as the measured process value then use <em>PID sensor no reset.vi</em> because pressure sensors are handled as sensors by ProCoDA. If a turbidity meter is used as the measured process value then use <em>PID setpoint no reset.vi</em> because the turbidity is handled as a setpoint by ProCoDA. The next step is to create all of the required inputs (target value, P Kc, I Ti (s), D Td (s), Measured process value). Note that the “no reset” designation on this code means that the PID control does NOT reset when ProCoDA changes states. That is normally the preferred behavior. The exception would be if there are some states where PID is not being used to control the process. AguaClara researchers typically use PI control (the value of D is set to zero).</p>
<ol class="arabic simple">
<li>Set the I and D set points to zero.</li>
<li>Set P to a small value and change the target value to provoke a response from the PID control.</li>
<li>Observe the graph of the variable being controlled for this value of P. If the result is an oscillation that becomes damped (decreasing amplitude), increase the value of P (perhaps by a factor of 5) and repeat the process. If the result is an oscillation that becomes amplified or that generates a control output that is out of range for the device, lower the value of P by a factor of 10 and repeat the process. Note that if you are controlling a pump and the pump cycles between off and full speed, then decrease P by a factor of 10 and try again! The objective is to find a value of P for which there is a periodic oscillation of the value with a constant amplitude.</li>
<li>Record the critical P value, (:math:` K_{mathrm{u}}`), and also record the period of the wave (time between two consecutive crests of the oscillation , (:math:` P_{mathrm{u}}`), in seconds).</li>
<li>To find the value of P required, use the equation: <span class="math notranslate nohighlight">\(P = \frac{K_{\mathrm{u}}}{2.2}\)</span>.</li>
<li>To find the value of I required, use the equation: <span class="math notranslate nohighlight">\(I = \frac{P_{\mathrm{u}}}{1.2}\)</span>. This should result in a value in minutes, which is the correct unit for I.</li>
</ol>
<p>Change your set points (P and I) to the new values. This calibration method may result in oscillatory behavior. To reduce variability in the output, consider reducing P to damp the oscillations. This will reduce the responsiveness of the algorithm and will increase the stability.</p>
</div>
</div>
<div class="section" id="states">
<span id="heading-procoda-states"></span><h3>States<a class="headerlink" href="#states" title="Permalink to this headline">¶</a></h3>
<p>The list of states is created by adding new states and then naming the states in the Rules control. The states don’t necessarily have to be listed in the order of the cycle. The first state should be the default off state. This state is used by the software as the default when the process is first turned on. The off state is also used as an emergency shutdown in case of a data acquisition failure.</p>
<p>The control output settings for each state indicate which set point is used to control that state. All set points used for control should be in the range of 0 to 1. Fractional values for the outputs 0 to 5 will cause the output to cycle and thus control the duty cycle. Fractional values for the pump speed will control the pump speed.</p>
</div>
<div class="section" id="rules-config-edit-rules">
<span id="heading-procoda-rules"></span><h3>Rules <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" /><a class="headerlink" href="#rules-config-edit-rules" title="Permalink to this headline">¶</a></h3>
<p>The list of rules is created by adding new rules and then naming each rule in the Rules control. The rules are the logical comparisons that determine if the process should change to a new state. The logic for changing process state can include a requirement of meeting several conditions simultaneously (conditions that are “anded”). There may also be more than one rule that can cause the process to change state. These two options are incorporated into the rule editor. The “anded” rules have multiple conditions and multiple rules can be created that are essentially “ored”.
<img alt="Rules_filter" src="../_images/Rules_filter.png" /></p>
<p>Rules that have multiple conditions that must be fulfilled simultaneously are created by increasing the number of conditions. Each conditional test will have its own logical comparison. An example of a completed rule containing two conditions is if the effluent turbidity exceeds regulations AND the time in the filtration state is greater than a minimum amount of time, then switch to backwash. Each logical comparison consists of a measured value (either a sensor value or the elapsed time in the current state) that can be selected from the drop down menu. The measured value is compared with a set point that can also be selected from a drop down menu. The type of comparison can either be less than or greater than.</p>
<p>Each rule can select which state the process should go to next. Thus it is possible that within the same state different rules would cause the process to change to different states. In the example here the “shut down” rule will end filtration if the clearwell is full.</p>
<p>The rules are implemented in the order indicated by the Current Rule control. If two rules would cause a state change at the same time, the first rule is used.</p>
</div>
<div class="section" id="outputs">
<span id="heading-procoda-outputs"></span><h3>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h3>
<p>The ProCoDA hardware is designed and fabricated around an NI USB data acquisition board is used for on/off control of up to six devices and for variable control of up to two peristaltic pumps. The on/off devices are controlled with 24 V outputs that can be used to control solenoid valves, pinch valves, relays, or other low current devices.</p>
<div class="section" id="analog-control-of-pumps">
<h4>Analog control of pumps<a class="headerlink" href="#analog-control-of-pumps" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>The older style of analog-controlled Masterflex pumps can be controlled through pump 0 or pump 1 ports using a 4-20 mA control system. There are many ways to connect a pump, I am going to stick to one pump head because it is easier and adding more is fairly straight-forward. I will also be doing it with the code that uses mL/s and tubing ID, but you can use the other external code as long as you ensure that you have the required set points.</dt>
<dd><ol class="first last arabic simple">
<li>Add a constant set point with the flow in mL/s <img alt="SetPoints_pump_flow_rate" src="../_images/SetPoints_pump_flow_rate.png" /></li>
<li>Add a constant set point with the tubing size that you will be using <img alt="SetPoints_pump_tubing_ID" src="../_images/SetPoints_pump_tubing_ID.png" /></li>
<li>Add a variable set point and call it something like “pump speed control” <img alt="SetPoints_pump_code_inputs" src="../_images/SetPoints_pump_code_inputs.png" /></li>
<li>Click on the folder and open the peristaltic folder and choose the right code you want to use for this tutorial it is single head pump control (mL per second, Tubing Size)</li>
<li>Select the set points</li>
<li>It should display the speed of the pump as a fraction of maximum speed</li>
<li>Navigate to the Rules &amp; Outputs tab and select Outputs <img alt="Outputs_filter_waste" src="../_images/Outputs_filter_waste.png" /></li>
<li>Select (or create) a state where you want the pump to be running</li>
<li>Select “On” for the pump off/on value</li>
<li>Select either “Off” for clockwise rotation or “On” for counterclockwise rotation</li>
<li>Select the variable that you created (pump speed control) for the pump speed.</li>
<li>To test the pump go to process operation and change the state to the state that has the pump running</li>
<li>If your pump is not running at the speed ProCoDA displays you can calibrate it using the <img alt="config_calibrate_pump" src="../_images/config_calibrate_pump.png" /> button</li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="calibrate-peristaltic-pump-flow-rates">
<h4>Calibrate peristaltic pump flow rates<a class="headerlink" href="#calibrate-peristaltic-pump-flow-rates" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ol class="arabic simple">
<li>If you are using an anolog controlled peristaltic pump and it is not running at full speed when ProCoDA sends it a “1” you can calibrate it using the <img alt="config_calibrate_pump" src="../_images/config_calibrate_pump.png" /> button.</li>
<li>To make flow calibration easy for both analog and digital pumps, use the external code&nbsp;that has mL per rev as an input. For analog pumps use the <strong>pump control (mL per s, mL per rev).vi</strong> in the <strong>peristaltic</strong> folder and for Modbus pumps use <strong>Golander pump(mL per s, mL per rev).vi</strong> in the <strong>Modbus devices</strong> folder.</li>
<li>Run the pump at a known and constant rpm and measure the flow obtained. Turn that flow into mL per revolution of the pump based on the pump rpm.</li>
<li>Enter the measured value of mL/rev as a setpoint input to the external code so that the pump delivers the target flow.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="on-off-devices">
<span id="heading-procoda-on-off-devices"></span><h4>On-off devices<a class="headerlink" href="#on-off-devices" title="Permalink to this headline">¶</a></h4>
<p>Devices that are controlled with a 24 volt signal can be cycled on and off using ProCoDA. These devices are connected to ports labeled 24V 2 to 24V 7. These ports can directly control small 24V solenoid valves or they can be used with a 24V relay to provide 110V power to any device that can be safely cycled on and off. The 24V relay is connected to one of the ports and then the AC electrical power for the device is routed through the relay. A common example of this would be to turn the stirrer on and off automatically so that it doesn’t continue to run after an experiment ends. These devices are typically controlled using the setpoints ON and OFF with different values selected for each state to achieve the desired operation. It is also possible to have a device cycle on and off within a state by using feedback control (for example the on-off controller in the feedback control folder). Here is an example of a stirrer that is set to be OFF in the OFF state and is set to be ON in the warmup and run states. Note that the output settings are drop down menus showing all of the setpoint you have defined.
<img alt="Control_stirrer" src="../_images/Control_stirrer.png" /></p>
</div>
</div>
</div>
<div class="section" id="process-operation">
<span id="heading-procoda-process-operation"></span><h2>Process Operation<a class="headerlink" href="#process-operation" title="Permalink to this headline">¶</a></h2>
<p>ProCoDA can operate in either a manual or an automated mode. In “Manual Locked in State” mode the user sets the state and ProCoDA stays in that state forever. In “Automatic Operation” the user sets the starting state and then ProCoDA uses the rule logic to move from state to state.
<img alt="Mode_of_operation" src="../_images/Mode_of_operation1.png" /></p>
<div class="section" id="how-to-set-up-a-timed-test">
<h3>How to set up a timed test<a class="headerlink" href="#how-to-set-up-a-timed-test" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li>Edit Rules</li>
<li>Create a constant set point with the value as the number of SECONDS you want to test to go on for</li>
<li>Go to Rules &amp; Outputs</li>
<li>Click on the state that runs the test then click on rules</li>
<li>Create a rule: If elapsed time in current state &gt; run time of test then go to next state (the next state could be OFF if you want a simple timed test)</li>
<li>You can also do many other conditional statements with this function like have states change based on any sensor data or other variable.</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="troubleshooting">
<span id="heading-procoda-troubleshooting"></span><h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>This is complex software with lots of capabilities and thus there are many opportunities for failure. The goal is to recognize failure quickly and then fix it!</p>
<blockquote>
<div><ol class="arabic simple">
<li>States change unexpectedly. Use data averaging on sensor and meter data to prevent noisy data signals from causing state changes.|data_average|</li>
<li>Sensor out of range (change the voltage range on the <a class="reference internal" href="#heading-procoda-configure"><span class="std std-ref">data acquisition system</span></a>)</li>
<li>Red LED indicators indicate failures. Make sure there are no red LEDs on the configuration tab. The only allowable red LED is the Datalog File Failure if you don’t want to log data using that method.</li>
<li>A red LED next to the <img alt="config_select_daq" src="../_images/config_select_daq.png" /> on the configure tab indicates that the computer is not connected to a ProCoDA box. Check the USB connections. If this is the first time using ProCoDA on this computer, then make sure you have followed all of the <a class="reference external" href="https://github.com/monroews/LabVIEW/wiki/ProCoDA">installation steps</a> because data acquisition won’t work without the data acquisition drivers.</li>
<li>Sensors give zero or close to zero response. Check the 24 volt power supply for the ProCoDA box. Check to ensure that the power supply LED lights on the back end of the ProCoDA box are lit. ProCoDA boxes built in 2014 didn’t have automatic overload protection and thus it is possible for an internal fuse to blow.</li>
<li>Software is slow and data acquisition is slow. External code that uses serial or USB port communication (turbidimeters, balances, etc.) may be incorrectly configured. If serial communication fails to these devices ProCoDA software waits until a serial port timeout occurs and during that wait everything slows down. Always switch external code that accesses meters back to constant from variable when the meter is no longer accessible by ProCoDA.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="tutorial">
<span id="heading-procoda-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>Your goal is to set up an experiment that has one pump for the flow of water into a floc/sed apparatus and a 2nd pump that sets the coagulant dose. The target upflow velocity for the sedimentation tank is 1 mm/s and the sed tank diameter is 1 inch. Below is the code to design the experimental setup.</p>
<div class="section" id="experimental-design">
<h3>Experimental design<a class="headerlink" href="#experimental-design" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aguaclara.core.units</span> <span class="k">import</span> <span class="n">unit_registry</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">aguaclara</span> <span class="k">as</span> <span class="nn">ac</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">inch</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">area_circle</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="n">v_up</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">Q_water</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">v_up</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mL</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The water flow rate is&#39;</span><span class="p">,</span><span class="n">Q_water</span><span class="p">)</span>

<span class="c1"># Use an easy-load pump head with tubing codes 14, 16, 17, or 18.</span>
<span class="c1"># Tubing 14 won&#39;t work because the 50 rpm pump can&#39;t deliver the required flow</span>
<span class="c1"># The choice of which tubing to use is somewhat arbitrary. High rpm wears out the tubing faster</span>
<span class="c1">#. Low rpm likely has bigger pulsations. Your choice! Here I compromise...</span>
<span class="n">Water_tubingcode</span> <span class="o">=</span> <span class="mi">17</span>
<span class="c1"># find the volume per rev for Masterflex L/S pump heads</span>
<span class="n">Pump_water_per_rev</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">vol_per_rev_LS</span><span class="p">(</span><span class="n">id_number</span> <span class="o">=</span> <span class="n">Water_tubingcode</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The volume of water per revolution is&#39;</span><span class="p">,</span><span class="n">Pump_water_per_rev</span><span class="p">)</span>
<span class="n">Pump_water_rpm</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q_water</span><span class="o">/</span><span class="n">Pump_water_per_rev</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rpm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The water pump rpm is&#39;</span><span class="p">,</span><span class="n">Pump_water_rpm</span><span class="p">,</span> <span class="s1">&#39;for tubing size&#39;</span><span class="p">,</span> <span class="n">Water_tubingcode</span><span class="p">)</span>

<span class="c1"># The coagulant dose range is 0.5 to 8 mg/L of aluminum.</span>
<span class="c1"># We need the peristaltic pump pulses to be very fast compared with the residence time of the flocculator</span>
<span class="c1"># Let&#39;s assume flocculator residence time 5 minutes (300 seconds)</span>
<span class="c1"># Set max pulse time to be 10% of flocculator residence time (3 seconds)</span>
<span class="c1"># Ismatec pump heads have 6 rollers, thus 6 pulses per rev</span>
<span class="c1"># minimum time for a pump revolution is 18 s</span>
<span class="n">Pump_dosing_min_rpm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">min</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mi">6</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">turn</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rpm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The minimum dosing pump rpm is&#39;</span><span class="p">,</span><span class="n">Pump_dosing_min_rpm</span><span class="p">)</span>
<span class="c1"># The coagulant stock has 70 grams/L of aluminum</span>
<span class="n">C_PACl_super_stock</span> <span class="o">=</span> <span class="mi">70</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">L</span>
<span class="c1"># Define a set of coagulant dosages over the target range with a logarithmic scaling</span>
<span class="c1"># the number of coagulant dosages to test. This doesn&#39;t include an extra &quot;free&quot; starting value of 0 to create a control that ProCoDA adds automatically</span>
<span class="n">Max_x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">dose_min</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">L</span>
<span class="n">dose_max</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">L</span>
<span class="n">C_PACl_dose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dose_max</span><span class="o">/</span><span class="n">dose_min</span><span class="p">),</span><span class="n">Max_x</span><span class="p">)</span><span class="o">*</span> <span class="n">dose_min</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The coagulant dosages in the geometric series are&#39;</span><span class="p">,</span><span class="n">C_PACl_dose</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">C_PACl_dose</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<span class="c1"># Find the multiplication factor (the base) between each dose</span>
<span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="n">dose_max</span><span class="o">/</span><span class="n">dose_min</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Max_x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The base of the geometric series is&#39;</span><span class="p">,</span><span class="n">base</span><span class="p">)</span>
<span class="c1"># The coefficient for our increment function is the minimum dose.</span>

<span class="c1"># Use the smallest tubing possible so we can use as high a concentration of PACl as possible.</span>
<span class="c1"># The smallest diameter tubing that we like to work with is 1.52 mm yellow-blue.</span>
<span class="n">Pump_coag_per_rev</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">vol_per_rev_3_stop</span><span class="p">(</span><span class="s1">&#39;yellow-blue&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The coagulant tubing volume per turn is&#39;</span><span class="p">,</span><span class="n">Pump_coag_per_rev</span><span class="p">)</span>
<span class="n">Coag_min_Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pump_coag_per_rev</span><span class="o">*</span><span class="n">Pump_dosing_min_rpm</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mL</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The minimum coagulant flow is&#39;</span><span class="p">,</span><span class="n">Coag_min_Q</span><span class="p">)</span>

<span class="c1"># now we can find the maximum coagulant stock concentration using the min dose and min flow rate</span>
<span class="n">C_PACl_stock</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">floor_step</span><span class="p">(</span><span class="n">dose_min</span><span class="o">*</span><span class="n">Q_water</span><span class="o">/</span><span class="n">Coag_min_Q</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The PACl stock concentration is&#39;</span><span class="p">,</span><span class="n">C_PACl_stock</span><span class="p">)</span>

<span class="c1"># Now find the flow of the PACl stock for these target dosages</span>
<span class="n">Q_PACl_stock</span> <span class="o">=</span> <span class="n">Q_water</span><span class="o">*</span><span class="n">C_PACl_dose</span><span class="o">/</span><span class="n">C_PACl_stock</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The coagulant flow rate is&#39;</span><span class="p">,</span><span class="n">Q_PACl_stock</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s1">&#39;mL/s&#39;</span><span class="p">)</span>

<span class="n">Pump_coag_rpm</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q_PACl_stock</span><span class="o">/</span><span class="n">Pump_coag_per_rev</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rpm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The pump rpm for the different flow rates are&#39;</span><span class="p">,</span><span class="n">Pump_coag_rpm</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">Pump_coag_rpm</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Below are the results from the calculations above.</dt>
<dd><ul class="first last simple">
<li>The water flow rate is 0.5067 milliliter / second</li>
<li>The volume of water per revolution is 2.8 milliliter / turn</li>
<li>The water pump rpm is 10.86 revolutions_per_minute for tubing size 17</li>
<li>The minimum dosing pump rpm is 0.3333 revolutions_per_minute</li>
<li>The coagulant dosages in the geometric series are [0.5 1.  2.  4.  8. ] milligram / liter</li>
<li>The base of the geometric series is 2 dimensionless</li>
<li>The coagulant tubing volume per turn is 0.1488 milliliter / rev</li>
<li>The minimum coagulant flow is 0.0008269 milliliter / second</li>
<li>The PACl stock concentration is 300 milligram / liter</li>
<li>The coagulant flow rate is [0.00084451 0.00168902 0.00337805 0.0067561  0.0135122 ] mL/s</li>
<li>The pump rpm for the different flow rates are [0.34042406 0.68084811 1.36169622 2.72339245 5.4467849 ] revolutions_per_minute</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="set-up-a-timed-cycle-of-two-states-run-and-warmup">
<h3>Set up a timed cycle of two states (run and warmup)<a class="headerlink" href="#set-up-a-timed-cycle-of-two-states-run-and-warmup" title="Permalink to this headline">¶</a></h3>
<p>We will use the rule editor to set up the <a class="reference internal" href="#heading-procoda-logic"><span class="std std-ref">ProCoDA logic</span></a> for the experiment.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Go to <img alt="config_edit_rules" src="../_images/config_edit_rules1.png" /> on the Configuration tab.</li>
<li>Go to the Set Points tab</li>
<li>Delete All Set Points to create a new clean method</li>
<li>Create a new set point that is the total plant flow (water + coag) with a value of 0.5067 mL/s</li>
<li>Create a new set point that is the duration of run in seconds with a value of 5</li>
<li>Create a new set point that is the duration of warmup in seconds with a value of 1 <img alt="Tutorial_timers" src="../_images/Tutorial_timers.png" /></li>
<li>Select the Rules and Outputs tab</li>
<li>Select the Rules tab</li>
<li>Add State After and call it Run (this is in the state 1 position)</li>
<li>Add State After and call it Warmup (this is in the state 2 position)</li>
<li>Edit the exit rule for the Warmup as shown <img alt="Tutorial_rule_reset" src="../_images/Tutorial_rule_reset.png" /></li>
<li>Edit the exit rule for the Run state so that the two states cycle</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="set-up-two-pumps">
<h3>Set up two pumps<a class="headerlink" href="#set-up-two-pumps" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#heading-procoda-golander-peristaltic-pump"><span class="std std-ref">Connect a Golander Peristaltic Pump</span></a> provides an explanation of how the pumps are controlled. Use the table below as a guide. Go through the table below and add all of these set points. Note that when you load external code it always lists what the required inputs are at the bottom of the dialog box.</p>
<span id="table-procoda-tutorial-method"></span><table border="1" class="docutils align-center" id="id18">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">ProCoDA tutorial method to vary coagulant dose for a series of 6 experiments</span><a class="headerlink" href="#id18" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Set Point</th>
<th class="head">unit</th>
<th class="head">type</th>
<th class="head">value</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Plant flow</td>
<td>mL/s</td>
<td>constant</td>
<td>0.5067</td>
<td>total flow of water</td>
</tr>
<tr class="row-odd"><td>Duration of run</td>
<td>s</td>
<td>constant</td>
<td>5</td>
<td>perhaps steady state operation for data collection</td>
</tr>
<tr class="row-even"><td>Duration of warmup</td>
<td>s</td>
<td>constant</td>
<td>1</td>
<td>time required for startup (start with a small value for testing!)</td>
</tr>
<tr class="row-odd"><td>data interval</td>
<td>s</td>
<td>constant</td>
<td>5</td>
<td>used to set data interval for turbidimeters</td>
</tr>
<tr class="row-even"><td>water pump ID</td>
<td>none</td>
<td>constant</td>
<td>2</td>
<td>change this to match your pumps</td>
</tr>
<tr class="row-odd"><td>coag pump ID</td>
<td>none</td>
<td>constant</td>
<td>1</td>
<td>change this to match your pumps</td>
</tr>
<tr class="row-even"><td>on state</td>
<td>none</td>
<td>constant</td>
<td>12</td>
<td>on for both states 1 and 2 (run and warmup)</td>
</tr>
<tr class="row-odd"><td>water volume per rev</td>
<td>mL/rev</td>
<td>constant</td>
<td>2.8</td>
<td>based on #17 tubing</td>
</tr>
<tr class="row-even"><td>coag volume per rev</td>
<td>mL/rev</td>
<td>constant</td>
<td>0.1488</td>
<td>based on yellow-blue 3 stop tubing</td>
</tr>
<tr class="row-odd"><td>water flow</td>
<td>mL/s</td>
<td>variable</td>
<td>subtract function</td>
<td>Plant flow - coag flow</td>
</tr>
<tr class="row-even"><td>coag flow</td>
<td>mL/s</td>
<td>variable</td>
<td>increment by factor rep</td>
<td>will systematically vary coag flow!</td>
</tr>
<tr class="row-odd"><td>water pump control</td>
<td>rpm</td>
<td>variable</td>
<td>Golander pump</td>
<td>controls the water pump</td>
</tr>
<tr class="row-even"><td>coag pump control</td>
<td>rpm</td>
<td>variable</td>
<td>Golander pump</td>
<td>controls the coagulant pump</td>
</tr>
<tr class="row-odd"><td>state to increment</td>
<td>none</td>
<td>constant</td>
<td>2 (reset state)</td>
<td>increment x whenever it enters the run state</td>
</tr>
<tr class="row-even"><td>coefficient</td>
<td>mL/s</td>
<td>constant</td>
<td>0.0008269 (min coag flow)</td>
<td>sets the first nonzero value of the series</td>
</tr>
<tr class="row-odd"><td>base</td>
<td>none</td>
<td>constant</td>
<td>2</td>
<td>base that is raised to the power of x</td>
</tr>
<tr class="row-even"><td>max x</td>
<td>none</td>
<td>constant</td>
<td>5</td>
<td>number of nonzero coagulant dosages</td>
</tr>
<tr class="row-odd"><td>reps</td>
<td>none</td>
<td>constant</td>
<td>2</td>
<td>number of times to repeat each test</td>
</tr>
<tr class="row-even"><td>max x + 1</td>
<td>none</td>
<td>variable</td>
<td>add</td>
<td>add max x + ON</td>
</tr>
<tr class="row-odd"><td>max cycles</td>
<td>none</td>
<td>variable</td>
<td>multiply</td>
<td>max x +1 times reps</td>
</tr>
<tr class="row-even"><td>cycles</td>
<td>none</td>
<td>variable</td>
<td>count states</td>
<td>counts number of times the run state is called</td>
</tr>
</tbody>
</table>
<p>The ProCoDA method file for this setup is available for you to try. Use the <img alt="Open_method" src="../_images/Config_open_save_export2.png" /> on the ProCoDA configuration tab (select the left open folder icon) to load the <a class="reference external" href="https://github.com/monroews/EnvEngLabTextbook/raw/master/ProCoDA/methods/Tutorial_method.pcm">method file for the tutorial</a>. Remember to check the pump ID addresses to make sure they match your setup!</p>
</div>
<div class="section" id="set-the-end-condition-for-the-experiment">
<h3>Set the end condition for the experiment<a class="headerlink" href="#set-the-end-condition-for-the-experiment" title="Permalink to this headline">¶</a></h3>
<p>We want ProCoDA to turn everything off after each of the coagulant dosages is tested twice. We can do that by adding a second exit condition for the Warmup state that exits to the OFF state when the total number of times that the Warmup state should execute has been reached.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Open the Rules and Outputs tab</li>
<li>Select the Warmup state</li>
<li>Add a new rule to exit to OFF <img alt="Tutorial_rule_end" src="../_images/Tutorial_rule_end.png" /></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="test-your-automation-sequence">
<h3>Test your automation sequence<a class="headerlink" href="#test-your-automation-sequence" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li>Close the rule editor</li>
<li>go to the Process Operation tab</li>
<li>Change the mode of operation to Automatic</li>
<li>Select the Warmup state</li>
<li>Go to the Graphs tab</li>
<li>Select <em>water pump control (rpm)</em>, <em>water pump control (rpm)</em>, and <em>cycles</em> (use the control key as you select multiple entries)</li>
<li>Set which axis (left or right) each plot is graphed on by right clicking on the legend where the color of the plot is shown and select y-scale and then select left or right. Use the left axis for the pump rpm and the right axis for the cycles.</li>
<li>Change the left y axis to log scale <img alt="Tutorial_log_axis" src="../_images/Tutorial_log_axis.png" /> because we are using a geometric series of flow rates</li>
<li>Return to the Process Operation tab</li>
<li>Right click on Warmup in the operator selected state to tell ProCoDA to return to that state. (Note that the operator selected state is NOT necessarily the state that ProCoDA is in! It is the state that the operator told ProCoDA to start in!)</li>
<li>Return to the Graphs tab</li>
<li>Select Clear graphs</li>
<li>See if you can create this graph <img alt="Tutorial_graph" src="../_images/Tutorial_graph.png" /></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="play">
<h3>Play<a class="headerlink" href="#play" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li>Set up <a class="reference internal" href="#heading-procoda-logging-data"><span class="std std-ref">data logging</span></a> using the method that also creates a state log</li>
<li>Run your experiment again</li>
<li>Open the data file and the state file to see what ProCoDA is recording</li>
<li>Add a  <a class="reference internal" href="#heading-procoda-pressure-measurement"><span class="std std-ref">pressure sensor</span></a> or a <a class="reference internal" href="#heading-procoda-temperature-measurement"><span class="std std-ref">temperature sensor</span></a></li>
<li>Change the <a class="reference internal" href="#heading-procoda-configure"><span class="std std-ref">sensor data rate</span></a> to be super fast or super slow and then change the graph update interval to see if you can detect the big difference in the sensor data noise.</li>
<li>Add a device (perhaps a stirrer) that turns <a class="reference internal" href="#heading-procoda-on-off-devices"><span class="std std-ref">on and off depending on the state</span></a>.</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="wiring">
<h2>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sensors">
<h3>Sensors<a class="headerlink" href="#sensors" title="Permalink to this headline">¶</a></h3>
<p>Sensors are wired using Category 5 or 6 Ethernet cable using our own <a class="reference internal" href="#table-procoda-sensor-wiring"><span class="std std-ref">analog</span></a> wiring standard. Two wires are used to carry the sensor output voltage designated as S- and S+. Five wires are used for different voltage power supplies, and one wire is used for the power supply ground. Sensors are wired to connect to the power supply that they require. Thus, the sensor is powered and monitored through a single port. This scheme is used for a variety of sensors including pressure, strain gage, pH, dissolved oxygen, photometer, and temperature. For several of the sensors the power supplies are also used to power a signal conditioning circuit to transform the sensor output into a voltage that can easily be monitored with a data acquisition system.</p>
<div class="figure align-center" id="id19">
<span id="figure-ethernet"></span><a class="reference internal image-reference" href="../_images/Ethernet.png"><img alt="Increment functions" src="../_images/Ethernet.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Two Ethernet wiring schemes.</span></p>
</div>
<span id="table-procoda-sensor-wiring"></span><table border="1" class="docutils align-center" id="id20">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Sensor wiring scheme using Ethernet cable</span><a class="headerlink" href="#id20" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Pin</th>
<th class="head">Ethernet A</th>
<th class="head">Ethernet B</th>
<th class="head">voltage</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>white/green</td>
<td>white/orange</td>
<td>S-</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>green</td>
<td>orange</td>
<td>S+</td>
</tr>
<tr class="row-even"><td>3</td>
<td>white/orange</td>
<td>white/green</td>
<td>ground</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>blue</td>
<td>blue</td>
<td>-5 V</td>
</tr>
<tr class="row-even"><td>5</td>
<td>white/blue</td>
<td>white/blue</td>
<td>+5 V</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>orange</td>
<td>green</td>
<td>+10V</td>
</tr>
<tr class="row-even"><td>7</td>
<td>white/brown</td>
<td>white/brown</td>
<td>-15 V</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>brown</td>
<td>brown</td>
<td>+15 V</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="modbus">
<h3>Modbus<a class="headerlink" href="#modbus" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils align-center" id="id21">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Parts for connecting modbus devices together and to USB port</span><a class="headerlink" href="#id21" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Description</th>
<th class="head">part number</th>
<th class="head">supplier</th>
<th class="head">image</th>
<th class="head">purpose</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="../_static/references/USBto485techsheet.pdf">USB to RS 485 two wire converter with 9 pin output</a></td>
<td>1165-1024-ND</td>
<td>Digikey</td>
<td><img alt="USB-485" src="../_images/USB-485.png" /></td>
<td>convert USB to RS 485</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="../_static/references/9pinmaletoEthernet.pdf">9 pin male to Ethernet</a></td>
<td>RJADK09P7080831</td>
<td>Digikey</td>
<td><img alt="D-Sub9toEthernet" src="../_images/D-Sub9toEthernet.png" /></td>
<td>convert to Ethernet cable</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="../_static/references/15pinfemaletoEthernet.pdf">15 Pin Female to Ethernet</a></td>
<td>RJADK15S7080831</td>
<td>Digikey</td>
<td><img alt="15pintoEthernet" src="../_images/15pintoEthernet.png" /></td>
<td>Golander pump to Ethernet</td>
</tr>
<tr class="row-odd"><td>D-Sub Contact Female Socket Gold 20-24 AWG Crimp Stamped</td>
<td>609-4423-1-ND</td>
<td>Digikey</td>
<td><img alt="femalesocket" src="../_images/femalesocket.png" /></td>
<td>jumper wires for Golander pump</td>
</tr>
<tr class="row-even"><td>Ethernet splitter</td>
<td>B00OPE3MH0</td>
<td>Amazon</td>
<td><img alt="Ethernetsplitter" src="../_images/Ethernetsplitter.png" /></td>
<td>daisy chain devices</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils align-center" id="id22">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">Modbus Ethernet cable standard for either A or B Ethernet cables.</span><a class="headerlink" href="#id22" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RS485 signal</th>
<th class="head">RJ45 pin</th>
<th class="head">Ethernet color</th>
<th class="head">DB 9 and 15 wires</th>
<th class="head">DB pins</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>A</td>
<td>4</td>
<td>Blue</td>
<td>Red</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>B</td>
<td>5</td>
<td>White with blue stripe</td>
<td>Green</td>
<td>3</td>
</tr>
<tr class="row-even"><td>ground</td>
<td>8</td>
<td>Brown</td>
<td>white</td>
<td>4</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils align-center" id="id23">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Meter and Pump Manuals.</span><a class="headerlink" href="#id23" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Device Manual</th>
<th class="head">Modbus Manual</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="../_static/references/Golander_BT-SV2_manual.pdf">Golander Pump</a></td>
<td><a class="reference external" href="../_static/references/Golander_MODBUS.pdf">modbus manual</a></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="../_static/references/HF_MicroTol_Turbidimeter_manual.pdf">HF turbidimeter</a></td>
<td><a class="reference external" href="../_static/references/HF_MicroTOL_MODBUS_Manual.PDF">Modbus</a></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="../_static/references/HFAccUViewManual.PDF">HF UV meter</a></td>
<td><a class="reference external" href="../_static/references/HFAccUView_MODBUS_Manual.PDF">Modbus</a></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="../_static/references/ChemTrac_HydroACT_Manual.pdf">ChemTrac HydroACT</a></td>
<td><a class="reference external" href="../_static/references/ChemTrac_HydroACT_Modbus.pdf">Modbus</a></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils align-center" id="id24">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">Golander pump pinout.</span><a class="headerlink" href="#id24" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">DB15 pin</th>
<th class="head">description</th>
<th class="head">connect to</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2</td>
<td>B</td>
<td>red wire</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>A</td>
<td>green wire</td>
</tr>
<tr class="row-even"><td>4</td>
<td>Power input</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>Ground of external power</td>
<td>11, white wire</td>
</tr>
<tr class="row-even"><td>10</td>
<td><ul class="first last simple">
<li>12V power supply</li>
</ul>
</td>
<td>4</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>ground of power supply</td>
<td>8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>anonymous (1993) MAXIM 1.2 mA Max, Single/Dual/Quad, Single-Supply Op Amps. Accessed 4/16 2007. <a class="reference external" href="http://www.ortodoxism.ro/datasheets/maxim/MAX406-MAX419.pdf">http://www.ortodoxism.ro/datasheets/maxim/MAX406-MAX419.pdf</a></p>
<p>Braatz, R. D. and Johnson, M. R. (1998) Process control laboratory education using a graphical operator interface. Computer Applications in Engineering Education 6(3), 151.</p>
<p>Choi, C. H. (2004) Undergraduate controls laboratory experience. In: ASEE Annual Conference Proceedings, 14425.</p>
<p>Rehg, J. A., Swain, W. H., Yangula, B. P., Wheatman, S. (1999) Fieldbus in the process control laboratory - its time has come. In: Proceedings - Frontiers in Education Conference, 13b4-12.</p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../Nutrient_Removal/Nutrient_Removal.html" class="btn btn-neutral" title="Nutrient Removal with Sequencing Batch Reactors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Monroe Weber-Shirk.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/mathjax_config.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>