%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Title and Preface}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{0}


        \usepackage{cancel}
    

\title{Environmental Laboratory Documentation}
\date{Mar 04, 2020}
\release{v.0.0.45}
\author{Monroe Weber-Shirk}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}


This textbook is written and maintained in \sphinxhref{https://github.com/monroews/EnvEngLabTextbook}{Github} via \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx}. It uses and refers to AguaClara code and functions in \sphinxhref{https://github.com/AguaClara/aide\_design}{aide\_design}. Listed below are the versions of the programs we use:


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{These are the software versions used to compile this textbook}\label{\detokenize{index:id2}}\label{\detokenize{index:software-versions}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{10}{20}|\X{10}{20}|}
\hline
\sphinxstyletheadfamily 
Software
&\sphinxstyletheadfamily 
version
\\
\hline
Sphinx
&
1.7.5
\\
\hline
aguaclara
&
0.0.23
\\
\hline
Anaconda
&
4.5.4
\\
\hline
Python
&
3.6.5
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\chapter{Laboratory Research in Environmental Engineering}
\label{\detokenize{Title_and_Preface/Title_and_Preface:laboratory-research-in-environmental-engineering}}\label{\detokenize{Title_and_Preface/Title_and_Preface::doc}}

\chapter{Laboratory Manual}
\label{\detokenize{Title_and_Preface/Title_and_Preface:laboratory-manual}}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=800\sphinxpxdimen]{{aeration}.png}
\label{\detokenize{Title_and_Preface/Title_and_Preface:figure-apparatus-schematic}}\end{figure}

\begin{DUlineblock}{0em}
\item[] Monroe L. Weber-Shirk
\item[] Senior Lecturer
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Leonard W. Lion
\item[] Professor Emeritus
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] James J. Bisogni, Jr.
\item[] Professor Emeritus
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Damian E Helbling
\item[] Assistant Professor
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] School of Civil and Environmental Engineering
\item[] Cornell University
\item[] Ithaca, NY 14853
\end{DUlineblock}

© Cornell University 2019

Educational institutions may use this text freely if the title/author page is included. We request that instructors who use this text notify one of the authors so that the dissemination of the manual can be documented and to ensure receipt of future editions of this manual.


\section{Preface}
\label{\detokenize{Title_and_Preface/Title_and_Preface:preface}}
Continued leadership in environmental protection requires efficient transfer of innovative environmental technologies to the next generation of engineers. Responding to this challenge, the Cornell Environmental Engineering faculty redesigned the undergraduate environmental engineering curriculum and created a new senior-level laboratory course. This laboratory manual is one of the products of the course development. Our goal is to disseminate this information to help expose undergraduates at Cornell and at other institutions to current environmental engineering problems and innovative solutions.

A major goal of the undergraduate laboratory course is to develop an atmosphere where student understanding will emerge for the physical, chemical, and biological processes that control material fate and transport in environmental and engineered systems. Student interest is piqued by laboratory exercises that present modern environmental problems to investigate and solve.

The experiments were designed to encourage the process of “learning around the edges.” The manifest purpose of an experiment may be a current environmental problem, but it is expected that students will become familiar with analytical methods in the course of the laboratory experiment (without transforming the laboratory into an exercise in analytical techniques). It is our goal that students employ the theoretical principles that underpin the environmental field in analysis of their observations without transforming the laboratories into exercises in process theory. As a result, students can experience the excitement of addressing a current problem while coincidentally becoming cognizant of relevant physical, chemical, and biological principles.

At Cornell, student teams of two or three carry out the exercises, maximizing the opportunity for a hands-on experience. Each team is equipped with modern instrumentation as well as experimental reactor apparatus designed to facilitate the study of each topic.
Computerized data acquisition, instrument control, and process control are used extensively to make it easier for students to learn how to use new instruments and to eliminate the drudgery of manual data acquisition. Software was developed at Cornell to use computers as virtual instruments that interface with gas chromatographs (HP 5890A), UV-Vis Spectrophotometers (HP 8452) as well as a variety of sensors.

The development of this manual and the accompanying course would not have been possible without funds from the National Science Foundation, the DeFrees Family Foundation, the Procter and Gamble Fund, the School of Civil and Environmental Engineering and the College of Engineering at Cornell University.

Monroe L. Weber-Shirk

Ithaca, NY


\chapter{Laboratory Safety}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:laboratory-safety}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:title-laboratory-safety}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety::doc}}

\section{Introduction}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:introduction}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-introduction}}
Safety is a collective responsibility that requires the full cooperation of everyone in the laboratory. However, the ultimate responsibility for safety rests with the person carrying out a given procedure. In the case of an academic laboratory, that person is usually the student. Accidents often result from an indifferent attitude, failure to use common sense, or failure to follow instructions. Each student should be aware of what the other students are doing because all can be victims of one individual’s mistake. Do not hesitate to point out to other students that they are engaging in unsafe practices or operations. If necessary, report it to the instructor. In the final assessment, students have the greatest responsibility to ensure their own personal safety.

This guide provides a list of do’s and don’ts to minimize safety and health problems associated with experimental laboratory work. It also provides, where possible, the ideas and concepts that underlie the practical suggestions. However, the reader is expected to become involved and to contribute to the overall solutions. The following are general guidelines for all laboratory workers:
\begin{enumerate}
\item {} 
Follow all safety instructions carefully.

\item {} 
Become thoroughly acquainted with the location and use of safety facilities such as safety showers, exits, and eyewash fountains.

\item {} 
Become familiar with the hazards of the chemicals being used, and know the safety precautions and emergency procedures before undertaking any work.

\item {} 
Become familiar with the chemical operations and the hazards involved before beginning an operation.

\end{enumerate}


\section{Personal Protection}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:personal-protection}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-personal-protection}}

\subsection{Eye Protection}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:eye-protection}}
All people in the laboratory including visitors must wear eye protection at all times, even when not performing a chemical operation. Wearing of contact lenses in the laboratory is normally forbidden because contact lenses can hold foreign materials against the cornea. Furthermore, they may be difficult to remove in the case of a splash. Soft contact lenses present a particular hazard because they can absorb and retain chemical vapors. If the use of contact lenses is required for therapeutic reasons fitted goggles must also be worn. In addition, approved standing shields and face shields that protect the neck and ears as well as the face should be used when appropriate for work at reduced pressure or where there is a potential for explosions, implosions, or splashing. Normal prescription eyeglasses, though meeting the Food and Drug Administration’s standards for shatter resistance, do not provide appropriate laboratory eye protection.


\subsection{Clothing}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:clothing}}
Clothing worn in the laboratory should offer protection from splashes and spills, should be easily removable in case of accident, and should be at least fire resistant. Nonflammable, nonporous aprons offer the most satisfactory and the least expensive protection. Lab jackets or coats should have snap fasteners rather than buttons so that they can be readily removed.

High-heeled or open-toed shoes, sandals, or shoes made of woven material should not be worn in the laboratory. Shorts, cutoffs, and miniskirts are also inappropriate. Long hair and loose clothing should be constrained. Jewelry such as rings, bracelets, and watches should not be worn in order to prevent chemical seepage under the jewelry, contact with electrical sources, catching on equipment, and damage to the jewelry.


\subsection{Gloves}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:gloves}}
Gloves can serve as an important part of personal protection when they are used correctly. Check to ensure the absence of cracks or small holes in the gloves before each use. In order to prevent the unintentional spread of chemicals, gloves should be removed before leaving the work area and before handling such things as telephones, doorknobs, writing instruments, computers, and laboratory notebooks. Gloves may be reused, cleaned, or discarded, consistent with their use and contamination.

A wide variety of gloves is available to protect against chemical exposure. Because the permeability of gloves of the same or similar material varies from manufacturer to manufacturer, no specific recommendations are given here. Be aware that if a chemical diffuses through a glove, that chemical is held against the worker’s hand and the individual may then be more exposed to the chemical than if the glove had not been worn.


\section{Personal Hygiene}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:personal-hygiene}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-personal-hygiene}}
Everyone working in a chemistry laboratory should be aware of the dangers of ingesting chemicals. These common sense precautions will minimize the possibility of such exposure:
\begin{enumerate}
\item {} 
Do not prepare, store (even temporarily), or consume food or beverages in any chemical laboratory.

\item {} 
Do not smoke in any chemical laboratory. Additionally, be aware that tobacco products in opened packages can absorb chemical vapors.

\item {} 
Do not apply cosmetics in a laboratory.

\item {} 
Wash hands and arms thoroughly before leaving the laboratory, even if gloves have been worn.

\item {} 
Wash separately from personal laundry, lab coats or jackets on which chemicals have been spilled.

\item {} 
Never wear or bring lab coats or jackets into areas where food is consumed.

\item {} 
Never pipette by mouth. Always use a pipette aid or suction bulb.

\end{enumerate}


\section{Laboratory Protocol}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:laboratory-protocol}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-laboratory-protocol}}
The chemistry laboratory is a place for serious learning and working. Horseplay cannot be tolerated. Variations in procedures including changes in quantities or reagents may be dangerous. Such alterations may only be made with the knowledge and approval of the instructor.


\subsection{Housekeeping}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:housekeeping}}
In the laboratory and elsewhere, keeping things clean and neat generally leads to a safer environment. Avoid unnecessary hazards by keeping drawers and cabinets closed while working. Never store materials, especially chemicals, on the floor, even temporarily. Work spaces and storage areas should be kept clear of broken glassware, leftover chemicals and scraps of paper. Keep aisles free of obstructions such as chairs, boxes, and waste receptacles. Avoid slipping hazards by keeping the floor clear of ice, stoppers, glass beads or rods, other small items, and spilled liquids. Use the required procedure for the proper disposal of chemical wastes and solvents.


\subsection{Cleaning Containers}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:cleaning-containers}}
Clean containers at the laboratory sink or in laboratory dishwashers. Use hot water, if available, and soap or other detergent. If necessary, use a mild scouring powder. Wear appropriate gloves that have been checked to ensure that no holes are present. Use brushes of suitable stiffness and size. Avoid accumulating too many articles in the cleanup area. Usually work space around a sink is limited and piling up dirty or cleaned glassware leads to breakage. Remember that the turbid water in a sink may hide a jagged edge on a piece of broken glassware that was intact when put into the water. A pair of heavy gloves may be useful for removing broken glass, but care must be exercised to prevent glove contamination. To minimize breakage of glassware, sink bottoms should have rubber or plastic mats that do not block the drains.

Avoid the use of strong cleaning agents such as nitric acid, chromic acid, sulfuric acid, strong oxidizers, or any chemical with a “per” in its name (such as perchloric acid, ammonium persulfate, etc.) unless specifically instructed to use them, and then only when wearing proper protective equipment. A number of explosions involving strong oxidizing cleaning solutions, such as chromic sulfuric acid mixtures, have been reported. The use of flammable solvents should be minimized and, when they are used, appropriate precautions must be observed.


\subsection{Unattended Operation of Equipment}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:unattended-operation-of-equipment}}
Reactions that are left to run unattended overnight or at other times are prime sources for fires, floods, and explosions. Do not let equipment such as power stirrers, hot plates, heating mantles, and water condensers run overnight without fail-safe provisions and the instructor’s consent. Check unattended reactions periodically. Always leave a note plainly posted with a phone number where you and the instructor can be reached in case of emergency. Remember that in the middle of the night, emergency personnel are entirely dependent on accurate instructions and information.


\subsection{Fume Hoods and Ventilation}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:fume-hoods-and-ventilation}}
A large number of common substances present acute respiratory hazards and should not be used in a confined area in large amounts. They should be dispensed and handled only where there is adequate ventilation, such as in a hood. Adequate ventilation is defined as ventilation that is sufficient to keep the concentration of a chemical below the threshold limit value or permissible exposure limit.

If you smell a chemical, it is obvious that you are inhaling it. However, odor does not necessarily indicate that a dangerous concentration has been reached. By contrast, many chemicals can be present at hazardous concentrations without any noticeable odor.


\subsection{Refrigerators}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:refrigerators}}
Chemicals stored in refrigerators should be sealed, double packaged if possible, and labeled with the name of the material, the date placed in the refrigerator, and the name of the person who stored the material. A current inventory should be maintained. Old chemicals should be disposed of after a specified storage period. Household refrigerators should not be used for chemical storage.

If used for storage of radioactive materials, a refrigerator should be plainly marked with the standard radioactivity symbol and lettering, and routine surveys should be made to ensure that the radioactive material has not contaminated the refrigerator.

Food should never be stored in a refrigerator used for chemical storage. These refrigerators should be clearly labeled “No Food”. Conversely food refrigerators, which must be always outside of, and away from, the chemical work area, should be labeled “Food Only—No Chemicals”.


\subsection{Working Alone}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:working-alone}}
Avoid working alone in a building or in a laboratory.


\section{Use of Chemicals}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:use-of-chemicals}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-use-of-chemicals}}
Before using any chemical you need to know how to safely handle it. The safety precautions taken are dependent on the exposure routes and the potential harmful effects.


\subsection{Routes of Exposure}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:routes-of-exposure}}\begin{enumerate}
\item {} 
ingestion

\item {} 
inhalation

\item {} 
absorbed through skin

\item {} 
eye contact

\end{enumerate}

Each potential exposure route requires different precautions. Chemical exposure may have acute (immediate, short term) or chronic (long term potentially cumulative) effects. Information on health hazards can be found on chemical labels and in Safety Data Sheets.


\subsection{Safety Data Sheets (SDSs)}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:safety-data-sheets-sdss}}
SDS can be found online with simple search queries.  SDS provide extensive information on safe handling, first aid, toxicity, etc. The following is a list of terms commonly used in SDS:
\begin{quote}

TLV—Threshold Limit Value—are values for airborne toxic materials that are to be used as guides in control of health hazards. They represent concentrations to which nearly all workers (workers without special sensitivities) can be exposed to for long periods of time without harmful effect. TLV’s are usually expressed as parts per million (ppm). TLV’s are also expressed as mg of dust or vapor/m3 of air.

TDLo—Toxic Dose Low—the lowest dose of a substance introduced by any route, other than inhalation, over any given period of time and reported to produce any toxic effect in humans or to produce carcinogenic, neoplastigenic, or teratogenic effects in animals or humans.

TCLo—Toxic Concentration Low—the lowest concentration of a substance in air to which humans or animals have been exposed for any given period of time and reported to produce any toxic effect in humans or to produce carcinogenic, neoplastigenic, or teratogenic effects in animals or humans.

TDLo—Lethal Dose Low—the lowest dose (other than LD50) of a substance introduced by any route, other than inhalation, over any given period of time in one or more divided portions and reported to have caused death in humans or animals.

LD50—Lethal Dose Fifty—a calculated dose of a substance that is expected to cause the death of 50\% of an entire defined experimental animal population. It is determined from the exposure to the substance by any route other than inhalation of a significant number from that population.

LCLo—Lethal Concentration Low—the lowest concentration of a substance in air, other than LC50, that has been reported to have caused death in humans or animals. The reported concentrations may be entered for periods of exposure that are less than 24 hours (acute) or greater than 24 hours (subacute and chronic).

LC50—Lethal Concentration Fifty—a calculated concentration of a substance in air, exposure to which for a specified length of time is expected to cause the death of 50\% of an entire defined experimental animal population. It is determined from the exposure to the substance of a significant number from that population.
\end{quote}


\subsection{Chemical Labels}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:chemical-labels}}
All chemicals must be labeled. Unlabeled containers of mystery chemicals or chemical solutions are a nightmare for disposal as well as a potential safety hazard. The OSHA Hazard Communication Standard and the OSHA Lab Standard have specific requirements for the labeling of chemicals. In a laboratory covered under the Lab Standard, if a chemical is designated as a hazardous material, that is having the characteristics of corrosivity, ignitability, toxicity (generally meaning a highly toxic material with an LD50 of 50 mg/kg or less), reactivity, etc., and if it is made into a solution or repackaged as a solid or liquid in a concentration greater than 1\% (0.1\% for a carcinogen) it needs to have a so called Right-To-Know (RTK) label that duplicates the hazard warnings, precautions, and first aid steps found on the original label. All other chemicals must have at minimum a label with the full chemical name (not just the chemical formula), concentration, and date prepared. Right-To-Know labels will be made available for your use when necessary.

\sphinxhref{https://www.acs.org/content/acs/en/chemical-safety/guidelines-for-chemical-laboratory-safety/resources-supporting-guidelines-for-chemical-laboratory-safety/national-fire-protection-association-hazard-identification.html}{National Fire Protection Association (NFPA) ratings} indicate the types and severity of the hazards. The NFPA ratings are on a scale of 0-4 with 0 being nonhazardous and 4 being most hazardous. The ratings are described in


\subsection{Chemical Storage}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:chemical-storage}}
There has been much concern, and some confusion, about the proper storage of laboratory chemicals. Here ‘proper’ means the storage of chemicals in such a manner as to prevent incompatible materials from being accidentally mixed together in the event of the breakage of one or more containers in the storage area or to prevent the formation of reactive vapors that may require vented chemical storage areas. Below is a concise guide to the storage of common laboratory chemicals.
\begin{enumerate}
\item {} 
Perchloric acid is separated from all other materials.

\item {} 
Hydrofluoric acid is separated from all other materials.

\item {} 
Concentrated nitric acid is separated from all other materials.

\item {} 
Highly toxic materials (LD50 of 50 mg/kg or less) are stored separately.

\item {} 
Carcinogenic chemicals are stored separately.

\item {} 
Inorganic acids (except for 1, 2, 3 above) are stored separately.

\item {} 
Bases are stored separately.

\item {} 
Strong oxidizing agents are stored separately.

\item {} 
Strong reducing agents are stored separately.

\item {} 
Water reactive, pyrophoric and explosive materials are stored separately.

\item {} 
Flammable organic materials (solvents, organic acids, organic reagents) are stored separately.

\end{enumerate}


\subsection{Guidelines for separating incompatible chemicals}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:guidelines-for-separating-incompatible-chemicals}}\begin{enumerate}
\item {} 
Place the chemicals to be stored separately in a heavy gauge Nalgene (or similar plastic) tub. Plastic secondary containers must be compatible with the material being stored.

\item {} 
Strong acids, especially perchloric, nitric, and hydrofluoric are best stored in plastic containers designed to store strong mineral acids. These are available from lab equipment supply houses.

\item {} 
Bottle-in-a-can type of containers are also acceptable as secondary containment. Small containers of compatible chemicals may be stored in a dessicator or other secure container. Secondary containment is especially useful for highly toxic materials and carcinogens.

\item {} 
Dry chemicals stored in approved cabinets with doors may be grouped together by compatibility type on separate shelves or areas of shelves separated by taping off sections of shelving to designate where chemicals of one type are stored. Physically separated cabinets may be used to provide a barrier between groups of stored incompatible chemicals. Strong mineral acids may be stored in one cabinet and strong bases stored in a second cabinet, for example. Flammable solvents should be stored in a rated flammable storage cabinet if available.

\end{enumerate}

If you are uncertain of the hazardous characteristics of a particular chemical refer to the SDS for that material. A good SDS will not only describe the hazardous characteristics of the chemical, it will also list incompatible materials.


\subsection{Transporting Chemicals}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:transporting-chemicals}}
Transport all chemicals using the container-within-a-container concept to shield chemicals from shock during any sudden change of movement. Large containers of corrosives should be transported from central storage in a chemically resistant bucket or other container designed for this purpose. Stairs must be negotiated carefully. Elevators, unless specifically indicated and so designated, should not be used for carrying chemicals. Smoking is never allowed around chemicals and apparatus in transit or in the work area itself.

When moving in the laboratory, anticipate sudden backing up or changes in direction from others. If you stumble or fall while carrying glassware or chemicals, try to project them away from yourself and others.

When a flammable liquid is withdrawn from a drum, or when a drum is filled, both the drum and the other equipment must be electrically wired to each other and to the ground in order to avoid the possible buildup of a static charge. Only small quantities should be transferred to glass containers. If transferring from a metal container to glass, the metal container should be grounded.


\subsection{Chemical Disposal}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:chemical-disposal}}
The Environmental Protection Agency (EPA) classifies wastes by their reaction characteristics. A summary of the major classifications and some general treatment guidelines are listed below. Specific information may be found in the book, Prudent Practices in the Laboratory: Handling and Management of Chemical Hazards (National Academies Press, 2011), as well as other reference materials.

\sphinxstyleemphasis{Ignitability}: These substances generally include flammable solvents and certain solids. Flammable solvents must never be poured down the drain. They should be collected for disposal in approved flammable solvent containers. In some cases it may be feasible to recover and reuse solvents by distillation. Such solvent recovery must include appropriate safety precautions and attention to potentially dangerous contamination such as that due to peroxide formation.

\sphinxstyleemphasis{Corrosivity}: This classification includes common acids and bases. They must be collected in waste containers that will not ultimately corrode and leak, such as plastic containers. It often may be appropriate to neutralize waste acids with waste bases and where allowed by local regulations, dispose of the neutral materials via the sanitary sewer system. Again, the nature of the neutralized material must be considered to ensure that it does not involve an environmental hazard such as chromium salts from chromic acid neutralization.

\sphinxstyleemphasis{Reactivity}: These substances include reactive metals such as sodium and various water reactive reagents. Compounds such as cyanides or sulfides are included in this class if they can readily evolve toxic gases such as hydrogen cyanide. Their collection for disposal must be carried out with particular care. When present in small quantities, it is advisable to deactivate reactive metals by careful reaction with appropriate alcohols and to deactivate certain oxygen or sulfur containing compounds through oxidation. Specific procedures should be consulted.

\sphinxstyleemphasis{Toxicity}: Although the EPA has specific procedures for determining toxicity, all chemicals may be toxic in certain concentrations. Appropriate procedures should be established in each laboratory for collection and disposal of these materials.

The handling of reaction byproducts, surplus and waste chemicals, and contaminated materials is an important part of laboratory safety procedures. Each laboratory worker is responsible for ensuring that wastes are handled in a manner that minimizes personal hazard and recognizes the potential for environmental contamination.

Most instructional laboratories will have clear procedures for students to follow in order to minimize the generation of waste materials. Typically reaction byproducts and surplus chemicals will be neutralized or deactivated as part of the experimental procedure. Waste materials must be handled in specific ways as designated by federal and local regulations. University guidelines for waste disposal can be found in Chapter 7 of the Cornell University \sphinxhref{https://sp.ehs.cornell.edu/lab-research-safety/laboratory-safety-manual/Pages/index.aspx}{Chemical Hygiene Plan}.

Some general guidelines are:
\begin{enumerate}
\item {} 
Dispose of pipette tips in the glass deposal container to prevent puncture of trash bags.

\item {} 
Dispose of waste materials promptly. When disposing of chemicals one basic principle applies: Keep each different class of chemical in a separate clearly labeled disposal container.

\item {} 
Never put chemicals into a sink or down the drain unless they are deactivated or neutralized and they are allowed by local regulation in the sanitary sewer system. {[}See Chemical Hygiene Plan for list of chemicals that can be safely disposed of in the sanitary sewer.{]}

\item {} 
Put ordinary waste paper in a wastepaper basket separate from the chemical wastes. If a piece of paper is contaminated, such as paper toweling used to clean up a spill, put the contaminated paper in the special container that is marked for this use. It must be treated as a chemical waste.

\item {} 
Broken glass belongs in its own marked waste container. Broken thermometers may contain mercury in the fragments and these belong in their own special sealed “broken thermometer” container.

\item {} 
Peroxides, because of their reactivity, and the unpredictable nature of their formation in laboratory chemicals, have attracted considerable attention. The disposal of large quantities (25 g or more) of peroxides requires expert assistance. Consider each case individually for handling and disposal.

\end{enumerate}

A complete list of compounds considered safe for drain disposal can be found in Chapter 7 of the Cornell University \sphinxhref{https://sp.ehs.cornell.edu/lab-research-safety/laboratory-safety-manual/Pages/index.aspx}{Chemical Hygiene Plan}.  Disposal techniques for chemicals not found in this list must be disposed of using techniques approved of by Cornell Environmental Health and Safety. When possible, hazardous chemicals can be neutralized and then disposed. When chemicals are produced that cannot be disposed of using the sanitary sewer, techniques to decrease the volume of the waste should be considered.


\section{References}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:references}}\label{\detokenize{Laboratory_Safety/Laboratory_Safety:heading-laboratory-safety-references}}\begin{quote}

Safety in Academic Chemistry Laboratories. A publication of the American Chemical Society Committee on Chemical Safety. Fifth edition. 1990
\end{quote}


\section{Prelab Questions}
\label{\detokenize{Laboratory_Safety/Laboratory_Safety:prelab-questions}}\begin{enumerate}
\item {} 
Why are contact lenses hazardous in the laboratory?

\item {} 
What is the minimum information needed on the label for each chemical? When are Right-To-Know labels required?

\item {} 
Why is it important to label a bottle even if it only contains reverse osmosis water?

\item {} 
Find an SDS for sodium nitrate.  a) Who created the SDS? b) What is the solubility of sodium nitrate in water? c) Is sodium nitrate carcinogenic? d) What is the LD50 oral rat? e) How much sodium nitrate would you have to ingest to give a 50\% chance of death (estimate from available LD50 data). f) How much of a 1 M solution would you have to ingest to give a 50\% chance of death? g) Are there any chronic effects of exposure to sodium nitrate?

\item {} 
You are in the laboratory preparing chemical solutions for an experiment and it is lunchtime. You decide to go to CTB to eat. What must you do before leaving the laboratory?

\end{enumerate}


\chapter{Laboratory Measurements and Procedures}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:laboratory-measurements-and-procedures}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:title-laboratory-measurements-and-procedures}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements::doc}}

\section{Introduction}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:introduction}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-introduction}}
Measurements of masses, volumes, and preparation of chemical solutions of known composition are essential laboratory skills. The goal of this exercise is to gain familiarity with these laboratory procedures. You will use these skills repeatedly throughout the semester.


\section{Theory}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:theory}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-theory}}
Many laboratory procedures require preparation of chemical solutions. Most chemical solutions are prepared on the basis of mass of solute per volume of solution (grams per liter or moles per liter). Preparation of these chemical solutions requires the ability to accurately measure both mass and volume.

Preparation of dilutions is also frequently required. Many analytical techniques require the preparation of known standards. Standards are generally prepared with concentrations similar to that of the samples being analyzed. In environmental work many of the analyses are for hazardous substances at very low concentrations (mg/L or \(\mu g/L\) levels). It is difficult to accurately weigh a few milligrams of a chemical with an analytical balance. Often dry chemicals are in crystalline or granular form with each crystal weighing several milligrams making it difficult to get close to the desired weight. Thus it is often easier to prepare a low concentration standard by diluting a higher concentration stock solution. For example, 100 mL of a 10 mg/L solution of NaCl could be obtained by first preparing a 1 g/L NaCl solution (100 mg in 100 mL). One mL of the 1 g/L stock solution would then be diluted to 100 mL to obtain a 10 mg/L solution.

Absorption spectroscopy is one analytical technique that can be used to measure the concentration of a compound. Solutions that are colored absorb light in the visible range. The resulting color of the solution is from the light that is transmitted. According to Beer’s law the attenuation of light in a chemical solution is related to the concentration and the length of the path that the light passes through.
\begin{equation}\label{equation:Laboratory_Measurements/Laboratory_Measurements:eq_Fund_attenuation}
\begin{split} \log \left(\frac{P_o }{P} \right)=\varepsilon bc\end{split}
\end{equation}
where c is the concentration of the chemical species, b is the distance the light travels through the solution, \(\varepsilon\) is a constant, \(P_o\) is the intensity of the incident light, and \(P\) is the intensity of the transmitted light. Absorption, A, is defined as:
\begin{equation}\label{equation:Laboratory_Measurements/Laboratory_Measurements:eq_Fund_Abs_of_attenuation}
\begin{split} A=\log \left(\frac{P_{o} }{P} \right)\end{split}
\end{equation}
In practice \(P_0\) is the intensity of light through a reference sample (such as deionized water) and thus accounts for any losses in the walls of the sample chamber. From equation \eqref{equation:Laboratory_Measurements/Laboratory_Measurements:eq_Fund_attenuation} and \eqref{equation:Laboratory_Measurements/Laboratory_Measurements:eq_Fund_Abs_of_attenuation} it may be seen that absorption is directly proportional to the concentration of the chemical species.
\begin{equation}\label{equation:Laboratory_Measurements/Laboratory_Measurements:eq_Fund_Beer}
\begin{split} A=\varepsilon bc\end{split}
\end{equation}
In this lab we will use a simple photometer with a 465 nm LED (blue light) and a detector that is used in smart phones to measure ambient light.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Photometer_exploded}.jpg}
\caption{Exploded view of the photometer. The LED is on the right and the sensor is on the red square printed circuit board. The flow path is through the gray PVC. Glass ports allow optical access to the sample.}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:id4}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-spectrophotometer}}\end{figure}


\section{Experimental Objectives}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:experimental-objectives}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-experimental-objectives}}
To gain proficiency in:
\begin{enumerate}
\item {} 
Calibrating and using electronic balances

\item {} 
Using signal conditioning boxes and data acquisition software

\item {} 
Digital pipetting

\item {} 
Preparing a solution of known concentration

\item {} 
Preparing dilutions

\item {} 
Measuring concentrations using a photometer

\end{enumerate}


\section{Experimental Methods}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:experimental-methods}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-experimental-methods}}

\subsection{Mass Measurements}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:mass-measurements}}
Mass can be accurately measured with an electronic analytical balance. Perhaps because balances are so easy to use it is easy to forget that they should be calibrated on a regular basis. It is recommended that balances be calibrated once a week, after the balance has been moved, or if excessive temperature variations have occurred. In order for balances to operate correctly they also need to be level. Most balances come with a bubble level and adjustable feet. Before calibrating a balance verify that the balance is level.

The environmental laboratory is equipped with 200 g balances.  As part of this exercise, we will calibrate the 200 g as follows:
\begin{enumerate}
\item {} 
Make sure the balance is stable and level using the bubble indicator

\item {} 
Press and hold the cal button until the screen shows ‘cal’ briefly

\item {} 
Wait until the screen flashes continually 100.000 g.

\item {} 
Place the 100 g calibration mass on the pan (handle the calibration mass using a cotton glove or tissue paper)

\item {} 
The scale is calibrated when it reads 100.000 g.

\end{enumerate}

Dry chemicals can be weighed in disposable plastic “weighing boats” or other suitable containers. It is often desirable to subtract the weight of the container in which the chemical is being weighed. The weight of the chemical can be obtained either by weighing the container first and then subtracting, or by “zeroing” the balance with the container on the balance.


\subsection{Temperature Measurement and ProCoDA}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:temperature-measurement-and-procoda}}
We will use a data acquisition system designed and fabricated in CEE at Cornell University. Each group has their own ProCoDA box and associated power supply and USB cable. The power supply and USB cable must be plugged into the ProCoDA box and then into the AC power on your lab bench and a USB port on your lab bench computer, respectively.

Use a thermistor to measure the temperature of reverse osmosis water. The thermistors are usually hanging on the rack to the right of the fume hoods (you should have one on your bench today). The thermistor has a 4-mm diameter metallic probe. Plug the thermistor into the red signal-conditioning box. The conditioned signal is connected to the ProCoDA box using a red cable. Connect the red cable to one of the sensor ports on the top row of the ProCoDA box.
\begin{enumerate}
\item {} 
Open ProCoDA II and {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-temperature-measurement}]{\sphinxcrossref{\DUrole{std,std-ref}{configure temperature monitoring}}}}

\item {} 
Place the temperature probe in a 100-mL plastic beaker full of reverse osmosis water. Wait at least 15 seconds to allow the probe to equilibrate with the solution.

\item {} 
Record this temperature in the attached \sphinxhref{../\_static/Datasheet.xlsx}{spreadsheet}.

\end{enumerate}


\subsection{Pipette Technique}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:pipette-technique}}\begin{enumerate}
\item {} 
Use \hyperref[\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-density-vs-t}]{Fig.\@ \ref{\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-density-vs-t}}} or \sphinxcode{\sphinxupquote{density = pc.density\_water(Temp)}} to estimate the mass of 990 \(\mu L\) of reverse osmosis water (at the measured temperature).

\item {} 
Use a 100-1000 \(\mu L\) digital pipette to transfer 990 \(\mu L\) of reverse osmosis water to a tared weighing boat on a balance with mg resolution. Record the mass of the water and compare with the expected value (see \hyperref[\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-density-vs-t}]{Fig.\@ \ref{\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-density-vs-t}}}). Repeat this step if necessary until your pipetting error is less than 2\%, then measure the mass of 5 replicate 990 \(\mu L\) pipette samples. Calculate the mean (\(\bar{x}\)), standard deviation (s), and coefficient of variation, \(\frac{s}{\bar{x}}\), for your measurements. The coefficient of variation (c.v.) is a good measure of the precision of your technique. For this test a c.v. \(\mathrm{<}\) 1\% should be achievable.

\end{enumerate}


\subsection{Measure Density}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:measure-density}}\begin{enumerate}
\item {} 
Weigh a 100 mL volumetric flask with its cap (use 200 g balance with resolution of 0.001 g\}.

\item {} 
Prepare 100 mL of a 1 M solution of sodium chloride in the weighed flask. You can also dissolve the NaCl in a clean beaker and transfer to the volumetric flask.  Make sure to mix the solution and then verify that you have \sphinxstylestrong{exactly 100 mL} of solution. Note that the combined \sphinxstylestrong{volume of NaCl and water decreases} as the salt dissolves.

\item {} 
Weigh the flask (with its cap) plus the sodium chloride solution and calculate the density of the 1 M NaCl solution.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{Temp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{density} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{density}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (degrees Celsius)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Density of water (kg/\PYGZdl{}m\PYGZca{}3\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}fig.savefig(\PYGZsq{}Laboratory\PYGZus{}Measurements/Images/Density\PYGZus{}vs\PYGZus{}T\PYGZsq{})}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Density_vs_T}.png}
\caption{Density of water vs. temperature.}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:id5}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:figure-density-vs-t}}\end{figure}


\subsection{Prepare red dye standards of several concentrations}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:prepare-red-dye-standards-of-several-concentrations}}
A red dye stock solution of 10 g/L has been prepared.
\begin{enumerate}
\item {} 
Use the red dye stock solution to prepare 100 mL of each of the following concentrations: 1 mg/L, 2 mg/L, 5 mg/L, 10 mg/L, 20 mg/L, 50 mg/L, and 100 mg/L.  Record your calculations in the attached \sphinxhref{../\_static/Datasheet.xlsx}{spreadsheet}. Use pipettes and volumetric flasks to create accurate dilutions.

\item {} 
Check all of the push to connect fittings in the photometer sample system. To obtain a water tight connection it is necessary to twist and push so that the o’ring slides over the outside of the tube to create a seal.

\item {} 
Note any errors in transfer of mass as you prepare these dilutions (the color will make it easy to see). Make sure to transfer every drop!

\end{enumerate}


\subsection{Create a standard curve and measure an unknown}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:create-a-standard-curve-and-measure-an-unknown}}\begin{enumerate}
\item {} 
Create a calibration curve using the standards created above and the {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-photometer}]{\sphinxcrossref{\DUrole{std,std-ref}{photometer calibration method}}}}. Use the Sipper Cell Flow Calibration method. \sphinxstylestrong{Tips}: Use black opaque tubing on both ends of the photometer and remember to hold the photometer straight up. If you are getting odd readings on the photometer push the fluid back and forth the photometer using the syringe until the readings stablize. Tap the photometer lightly to remove any air bubbles.

\item {} 
Make sure to both save \sphinxstylestrong{AND} export the calibration data from ProCoDA (\sphinxincludegraphics{{photometer_open_save_export}.png})

\item {} 
Was the calibration linear? If not, which standards caused it to depart from linearity?
\#. The high concentration standards may be beyond the linear range for the sensor. This can occur if the amount of light reaching the sensor is too low to create an output voltage that is proportional to the light. Remember that an absorbance of 2 means that 99\% of the light is adsorbed by the dye! If the absorbance for the highest standard isn’t in the line of the lower concentration samples, then delete the highest standards sequentially until you get a high correlation coefficient (R) as calculated by the ProCoDA photometer software.
\#. If the correlation coefficient is less than 0.99 then it suggests that your standards weren’t accurately prepared. See if you can identify what you did incorrectly with your pipette or dilution technique and consider (talk with a TA) preparing new standards.

\item {} 
Save \sphinxstylestrong{AND} export the calibration data from ProCoDA (\sphinxincludegraphics{{photometer_open_save_export}.png}). These calibration curves will be useful later in this course!

\item {} 
Measure the concentration of the unknown concentration of red dye. Note that you can do this directly in ProCoDA in the Graphs tab.

\end{enumerate}


\section{Clean Up}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:clean-up}}\begin{enumerate}
\item {} 
Empty and rinse red dye bottles and place them on the drying racks

\item {} 
Empty and rinse volumetric flasks and place them on the drying racks

\item {} 
Place pipette tips in the pipette disposal mini cans

\item {} 
Discard any used weighing boats

\item {} 
Pull DI water through the photometer to rinse it and then place it in your drawer

\item {} 
Rinse temperature probe and place it in your drawer

\item {} 
Empty and rinse unknown red dye solutions

\item {} 
Place concentrated red dye in your drawer

\end{enumerate}


\section{Prelab Questions}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:prelab-questions}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-pre-laboratory-questions}}\begin{enumerate}
\item {} 
You need 100 mL of a 1 \(\mu M\) solution of zinc that you will use as a standard to calibrate an atomic adsorption spectrophotometer. Find a source of zinc ions combined either with chloride or nitrate (you can use the internet or any other source of information). What is the molecular formula of the compound that you found? Zinc disposal down the sanitary sewer is restricted at Cornell and the solutions you prepare may need to be disposed of as hazardous waste. As an environmental engineering student you strive to minimize waste production. How would you prepare this standard using techniques readily available in the environmental laboratory so that you minimize the production of solutions that you don’t need? Note that we have pipettes that can dispense volumes between 10 \(\mu L\) and 1 mL and that we have 100 mL and 1 L volumetric flasks. Include enough information so that you could prepare the standard without doing any additional calculations. Consider your ability to accurately weigh small masses. Explain your procedure for any dilutions. Note that the stock solution concentration should be an easy multiple of your desired solution concentration so you don’t have to attempt to pipette a volume that the digital pipettes can’t be set for such as 13.6 \(\mu L\).

\item {} 
The density of sodium chloride solutions as a function of concentration is approximately \(0.6985C + \rho_{water}\). What is the density of a 1 M solution of sodium chloride?

\end{enumerate}


\section{Data Analysis and Questions}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:data-analysis-and-questions}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-data-analysis-and-questions}}
Submit the \sphinxhref{../\_static/Datasheet.xlsx}{spreadsheet} containing the data sheet, and a markdown file containing graphs and answers to the questions.
\begin{enumerate}
\item {} 
Fill out the attached \sphinxhref{../\_static/Datasheet.xlsx}{spreadsheet}. Make sure that all calculated values are entered in the spreadsheet as equations. All remaining analysis for the course will be done in Atom using Python!

\item {} 
Create a graph of absorbance vs. concentration of red dye \sphinxcode{\sphinxupquote{\textbackslash{}\#40}} in Atom/Markdown using the exported data file. Does absorbance increase linearly with concentration of the red dye? Remove data points from the graph that are outside of the linear region (absorbance too high for the detector to measure accurately).

\item {} 
What is the value of the extinction coefficient, \(\varepsilon\)? Use the slope of the absorbance vs concentration to calculate the absorbance. The pathlength for the sample cell is given in the  {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-photometer}]{\sphinxcrossref{\DUrole{std,std-ref}{photometer section}}}}.

\item {} 
Did you use interpolation or extrapolation to get the concentration of the unknown?

\item {} 
What measurement controls the accuracy of the density measurement for the NaCl solution?

\item {} 
What density did you expect (see prelab 2)?

\item {} 
Approximately what should the accuracy be for the density measurement?

\item {} 
Don’t forget to write a brief paragraph on conclusions and on suggestions using Markdown.

\item {} 
Verify that your report and graphs meet the requirements as outlined on the \sphinxhref{https://github.com/monroews/CEE4530/wiki/Lab-Reports}{course website}.

\end{enumerate}


\section{Lab Prep Notes}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:lab-prep-notes}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-lab-prep-notes}}

\section{Setup}
\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:setup}}\label{\detokenize{Laboratory_Measurements/Laboratory_Measurements:heading-laboratory-measurements-and-procedures-setup}}\begin{enumerate}
\item {} 
Prepare stock red dye \#40 solution (10 g/L) and distribute to student workstations in 20 mL vials.

\item {} 
Prepare 1 L of unknown in concentration range of standards. Divide into six 150 mL bottles (one for each student bench (teams/2)).

\item {} 
Verify that balances calibrate easily.

\item {} 
Disassemble, clean, and lubricate all pipettes.

\item {} 
Distribute all supplies needed for the lab.

\end{enumerate}


\chapter{Acid Precipitation and Remediation of Acid Lakes}
\label{\detokenize{Acid_Rain/Acid_Rain:acid-precipitation-and-remediation-of-acid-lakes}}\label{\detokenize{Acid_Rain/Acid_Rain:title-acid-rain}}\label{\detokenize{Acid_Rain/Acid_Rain::doc}}

\section{Introduction}
\label{\detokenize{Acid_Rain/Acid_Rain:introduction}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-introduction}}
Acid precipitation has been a serious environmental problem in many areas of the world for the last few decades. Acid precipitation results from the combustion of fossil fuels which produce oxides of sulfur and nitrogen that react in the earth’s atmosphere to form sulfuric and nitric acid. One of the most significant impacts of acid rain is the acidification of lakes and streams. In some watersheds the soil doesn’t provide ample acid neutralizing capacity to mitigate the effect of incident acid precipitation. These susceptible regions are usually high elevation lakes with small watersheds and shallow non-calcareous soils. The underlying bedrock of acid-sensitive lakes tends to be granite or quartz. These minerals are slow to weather and therefore have little capacity to neutralize acids. The relatively short contact time between the acid precipitation and the watershed soil system exacerbates the problem. Lakes most susceptible to acidification: 1) are located downwind, sometimes hundreds of miles downwind, from major pollution sources\textendash{}electricity generation, metal refining operations, heavy industry, large population centers, etc.; 2) are surrounded by hard, insoluble bedrock with thin, sandy, infertile soil; 3) have a high runoff to infiltration ratio; 4) have a low watershed to lake surface area. Isopleths of precipitation pH are depicted in \hyperref[\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-us}]{Fig.\@ \ref{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-us}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Acid_rain_US}.png}
\caption{The pH of precipitation in 2009.}\label{\detokenize{Acid_Rain/Acid_Rain:id1}}\label{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-us}}\end{figure}

In acid-sensitive lakes the major parameter of concern is pH (\(pH = -log{\{H^+\}}\), where \(\{H^+\}\) is the hydrogen ion activity, and activity is approximately equal to concentration in moles/L). In a healthy lake, ecosystem pH should be in the range of 6.5 to 8.5. In most natural freshwater systems, the dominant pH buffering (controlling) system is the carbonate system. The carbonate buffering system is composed of four components: dissolved carbon dioxide (\({CO}_{{2\; aq}}\)), carbonic acid (\({H}_{{2}} {CO}_{{3}}\)), bicarbonate (\({HCO}_{{3}}^{{-}}\)), and carbonate (\({CO}_{{3}}^{{-2}}\)). Carbonic acid exists only at very low levels in aqueous systems and for purposes of acid neutralization is indistinguishable from dissolved carbon dioxide. Thus to simplify things we define
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_total_carbonic}
\begin{split} \left[{H}_{{2}} {CO}_{{3}}^{{*}} \right]=\left[{CO}_{{2\; aq}} \right]+\left[{H}_{{2}} {CO}_{{3}} \right]\end{split}
\end{equation}
The \(\left[{CO}_{{2\; aq}} \right] \mathrm{>} \mathrm{>} \left[{H}_{{2}} {CO}_{{3}} \right]\) and thus \(\left[{H}_{{2}} {CO}_{{3}}^{{*}} \right]\cong \left[{CO}_{{2\; aq}} \right]\) (all terms enclosed in {[}{]} are in units of moles/L).

The sum of the molar concentrations of all the components of the carbonate system is designated as \(C_T\) as shown in the equation below.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:0}
\begin{split}C_T = \left[H_2{CO}_3^* \right] + \left[{HCO}_3^- \right]+\left[{CO}_3^{-2} \right]\end{split}
\end{equation}
The carbonate system can be considered to be a “volatile” system or a “non-volatile” system depending on whether or not aqueous carbon dioxide is allowed to exchange and equilibrate with atmospheric carbon dioxide. Mixing conditions and hydraulic residence time determine whether an aquatic system is volatile or non-volatile relative to atmospheric carbon dioxide equilibrium. First, consider the relationship that are valid regardless of the rate of exchange with the atmosphere.


\subsection{Carbonate System}
\label{\detokenize{Acid_Rain/Acid_Rain:carbonate-system}}
For a fixed \(C_T\), the molar concentration of each species of the carbonate system is determined by pH. Equations \eqref{equation:Acid_Rain/Acid_Rain:eq_carbonic_acid}-\eqref{equation:Acid_Rain/Acid_Rain:eq_alpha2} show these functional relationships.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_carbonic_acid}
\begin{split} \left[H_2 {CO}_3^* \right] = \frac{C_T}{1+\frac{K_1}{[H^+]} +\frac{K_1 K_2}{[H^+]^2} } = \alpha_0 C_T\end{split}
\end{equation}
where
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_alpha0}
\begin{split} \alpha_0 =\frac{1}{1+\frac{K_1 }{[H^+]} +\frac{K_1 K_2}{[H^+]^2} }\end{split}
\end{equation}\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_bicarbonate}
\begin{split} \left[{HCO}_3^- \right]=\frac{C_T}{\frac{[H^+ ]}{K_1 } +1+ \frac{K_2}{[H^+]}} =\alpha_1 C_T\end{split}
\end{equation}
where
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_alpha1}
\begin{split} \alpha_1 = \frac{1}{\frac{[H^+]}{K_1} + 1 + \frac{K_2}{[H^+]}}\end{split}
\end{equation}\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_carbonate}
\begin{split} \left[{CO}_3^{-2} \right] = \frac{C_T}{\frac{[H^+]^2}{K_1 K_2} +\frac{[H^+]}{K_2} +1 } =\alpha_2 C_T\end{split}
\end{equation}
where
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_alpha2}
\begin{split} \alpha_2 = \frac{1}{\frac{[H^+]^2 }{K_1 K_2} +\frac{[H^+]}{K_2} + 1}\end{split}
\end{equation}
\(K_1\) and \(K_2\) are the first and second dissociation constants for carbonic acid and \(\alpha_0\), \(\alpha_1\), and \(\alpha_2\) are the fraction of \(C_T\) in the form \(H_2CO_3^\star\), \(HCO_3^-\), and \(CO_3^{-2}\) respectively. Because \(K_1\) and \(K_2\) are constants (\(K_1 = 10^{-6.3}\) and \(K_2 = 10^{-10.3}\)), \(\alpha_0\), \(\alpha_1\), and \(\alpha_2\) are only functions of pH.

A measure of the susceptibility of lakes to acidification is the acid neutralizing capacity (ANC) of the lake water. In the case of the carbonate system, the ANC is exhausted when enough acid has been added to convert the carbonate species \({HCO}_{{3}}^{{-}}\)  and \({CO}_{{3}}^{{-2}}\) to \({H}_{{2}} {CO}_{{3}}^\star\). A formal definition of total acid neutralizing capacity is given by equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_definition1}
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC_definition1}
\begin{split} {ANC\; }={\; }\left[{HCO}_{{3}}^{{-}} \right]+{\; 2}\left[{CO}_{{3}}^{{-2}} \right]+\left[{OH}^{{-}} \right]{\; -}\left[{H}^{+} \right]\end{split}
\end{equation}
ANC has units of equivalents per liter. The hydroxide ion concentration can be obtained from the hydrogen ion concentration and the dissociation constant for water, \(K_w\).
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_OH_dissociation}
\begin{split} \left[{OH}^{{-}} \right] = \frac{K_w}{\left[H^+\right]}\end{split}
\end{equation}
Substituting equations \eqref{equation:Acid_Rain/Acid_Rain:eq_bicarbonate}, \eqref{equation:Acid_Rain/Acid_Rain:eq_carbonate}, and \eqref{equation:Acid_Rain/Acid_Rain:eq_OH_dissociation} into equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_definition1}, we obtain
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile}
\begin{split} ANC=C_T \left(\alpha_1 +2\alpha_2 \right)+\frac{K_w}{\left[H^+ \right]} - \left[H^+ \right]\end{split}
\end{equation}
For the carbonate system, ANC is usually referred to as alkalinity. Alkalinity can be expressed as equivalents/L or as mg/L (ppm) of \(CaCO_3\). 50,000 mg/L \(CaCO_3\) = 1 equivalent/L.


\subsection{Volatile Carbonate Systems}
\label{\detokenize{Acid_Rain/Acid_Rain:volatile-carbonate-systems}}
Now consider the case where aqueous \({CO}_{2\; aq}\) is volatile and in equilibrium with atmospheric carbon dioxide. Henry’s Law can be used to describe the equilibrium relationship between atmospheric and dissolved carbon dioxide.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:1}
\begin{split}\left[{CO}_{{2\; aq}} \right]={\; P}_{{CO}_{{2}} {\; }} {K}_{{H}}\end{split}
\end{equation}
where \(K_H\) is Henry’s constant for \(CO_2\) in moles/L-atm and \(P_{CO_2}\) is partial pressure of \(CO_2\) in the atmosphere \(K_H = 10^{-1.5}\)  and \(P_{CO_2} = 10^{-3.5}\)). Because \(\left[{CO}_{{2\; aq}} \right]\) is approximately equal to \(\left[H_2CO_3^{\star} \right]\) and from equations \eqref{equation:Acid_Rain/Acid_Rain:eq_total_carbonic} and \eqref{equation:Acid_Rain/Acid_Rain:eq_carbonic_acid}
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:2}
\begin{split}P_{CO_2} K_H =\alpha_0 C_T\end{split}
\end{equation}\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_CT_volatile}
\begin{split} C_T = \frac{P_{CO_2} K_H}{\alpha_0}\end{split}
\end{equation}
Equation \eqref{equation:Acid_Rain/Acid_Rain:eq_CT_volatile} gives the equilibrium concentration of carbonate species as a function of pH and the partial pressure of carbon dioxide.

The acid neutralizing capacity expression for a volatile system can be obtained by combining equations \eqref{equation:Acid_Rain/Acid_Rain:eq_CT_volatile} and \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile}.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile}
\begin{split} ANC=\frac{P_{CO_2} K_H }{\alpha_0 } (\alpha_1 +2\alpha_2 ) + \frac{K_w }{\left[H^+ \right]} - \left[H^+ \right]\end{split}
\end{equation}
In both non-volatile and volatile systems, equilibrium pH is controlled by system ANC. Addition or depletion of any ANC component in equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile} or \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile} will result in a pH change. Natural bodies of water are most likely to approach equilibrium with the atmosphere (volatile system) if the hydraulic residence time is long and the body of water is shallow.

Lake ANC is a direct reflection of the mineral composition of the watershed. Lake watersheds with hard, insoluble minerals yield lakes with low ANC. Typically watersheds with soluble, calcareous minerals yield lakes with high ANC. ANC of freshwater lakes is generally composed of bicarbonate, carbonate, and sometimes organic matter (\({A}_{{org}}^{{-}}\)). Organic matter derives from decaying plant matter in the watershed. When organic matter is significant, the ANC becomes (from equations \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile} and \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile}):
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile_org}
\begin{split} ANC=C_{T} (\alpha _{1} +2\alpha _{2} )+{\; }\frac{K_{w} }{\left[{H}^{+} \right]} \; -\left[{H}^{+} \right]+\left[{A}_{{org}}^{{-}} \right]\end{split}
\end{equation}\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile_org}
\begin{split} ANC=\frac{P_{CO_{2} } K_{H} }{a_{0} } (\alpha _{1} +2\alpha _{2} )+\frac{K_{w} }{\left[{H}^{+} \right]} \; -\left[{H}^{+} \right]+\left[{A}_{{org}}^{{-}} \right]\end{split}
\end{equation}
where equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile_org} is for a non-volatile system and equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile_org} is for a volatile system.

During chemical neutralization of acid, the components of ANC associate with added acid to form protonated molecules. For example:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:3}
\begin{split}\left[{H}^{+} \right]{\; }+{\; }\left[{HCO}_{{3}}^{{-}} \right]{\; }\to \; \left[{H}_{{2}} {CO}_{{3}}^{{\star}} \right]\end{split}
\end{equation}
or
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:4}
\begin{split}\left[{H}^{+} \right]{\; }+{\; }\left[{A}_{{org}}^{{-}} \right]{\; }\to \; \left[{HA}_{{org}} \right]\end{split}
\end{equation}
In essence, the ANC of a system is a result of the reaction of acid inputs to form associated acids from basic anions that were dissolved in the lake water. The ANC (equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_definition1}) is consumed as the basic anions are converted to associated acids. This conversion is near completion at low pH (approximately pH 4.5 for the bicarbonate and carbonate components of ANC). Neutralizing capacity to another (probably higher) pH may be more useful for natural aquatic systems. Determination of ANC to a particular pH is fundamentally easy — simply add and measure the amount of acid required to lower the sample pH from its initial value to the pH of interest. Techniques to measure ANC are described under the procedures section of this lab.

Neutralization of acid precipitation can occur in the watershed or directly in the lake. How much neutralization occurs in the watershed versus the lake is a function of the watershed to lake surface area. Generally, watershed neutralization is dominant. Engineered remediation of acid lakes has been accomplished by adding bases such as limestone, lime, or sodium bicarbonate to the watershed or directly to the lakes.


\section{Reactor Theory Applied to Acid Lake Remediation}
\label{\detokenize{Acid_Rain/Acid_Rain:reactor-theory-applied-to-acid-lake-remediation}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-reactor-theory-applied-to-acid-lake-remediation}}
In this experiment sodium bicarbonate will be added to a lake to mitigate the deleterious effect of acid rain. Usually sodium bicarbonate is added in batch doses (as opposed to metering in). The quantity of sodium bicarbonate added depends on how long a treatment is desired, the acceptable pH range and the quantity and pH of the incident rainfall. For purposes of this experiment, a 15-minute design period will be used. That is, we would like to add enough sodium bicarbonate to keep the lake at or above its original pH and alkalinity for a period of 15 minutes (i.e., for one hydraulic residence time).

By dealing with ANC instead of pH as a design parameter, we avoid the issue of whether the system is at equilibrium with atmospheric carbon dioxide. Keep in mind that eventually the lake will come to equilibrium with the atmosphere. In practice, neutralizing agent dosages may have to be adjusted to take into account non-equilibrium conditions.

We must add enough sodium bicarbonate to equal the negative ANC from the acid precipitation input plus the amount of ANC lost by outflow from the lake during the 15-minute design period. Initially (following the dosing of sodium bicarbonate) the pH and ANC will rise, but over the course of 15 minutes, both parameters will drop. Calculation of required sodium bicarbonate dosage requires performing a mass balance on ANC around the lake. This mass balance will assume a completely mixed lake and conservation of ANC. Chemical equilibrium can also be assumed so that the sodium bicarbonate is assumed to react immediately with the incoming acid precipitation. Mass balance on the reactor yields:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:5}
\begin{split}Q\left(ANC_{in}  - ANC_{out} \right)  \rlap{-} V \frac{d(ANC)}{dt}\end{split}
\end{equation}
where:
\begin{quote}

\begin{DUlineblock}{0em}
\item[] \(ANC_{out}\) = ANC in lake outflow at any time t (for a completely mixed lake the effluent ANC is the same as the ANC in the lake)
\item[] \(ANC_{in}\) = ANC of acid rain input
\item[] \(\rlap{-} V\) = volume of reactor
\item[] \(Q\) = acid rain input flow rate.
\end{DUlineblock}
\end{quote}

If the initial ANC in the lake is designated as ANC0, then the solution to the mass balance differential equation is:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:6}
\begin{split}ANC_{out} \; =\; ANC_{in} \; \cdot \; \left(1\; -\; {\mathop{e}\nolimits^{-t/\theta \; \; }} \right)+\; ANC_{0} \; \cdot \; {\mathop{e}\nolimits^{-t/\theta \; }}\end{split}
\end{equation}
where:

\(\theta = \rlap{-} V/Q\)

We want to find ANC0 such that ANCout = 50 \(\mu eq/L\) when t is equal to \(\theta\). Solving for \(ANC_{0}\) we get:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:eq_ANC0_CMFR}
\begin{split} {ANC}_{{0}} {\; }=\left[{ANC}_{out} - ANC_{in} \cdot \left(1 - {\mathop{e}\nolimits^{-t/\theta}} \right)\right]{\mathop{e}\nolimits^{t/\theta}}\end{split}
\end{equation}
The ANC of the acid rain (\(ANC_{in}\)) can be estimated from its pH. Below pH 6.3 most of the carbonates will be in the form \(H_2CO_3^{\star}\)  and thus for pH below about 4.3 equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_definition1} simplifies to
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:7}
\begin{split}{ANC}\cong -\left[{H}^{+} \right]\end{split}
\end{equation}
An influent pH of 3.0 implies the \(ANC_{in} = -\left[H^+ \right] = -0.001 eq/L\)

Substituting into equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC0_CMFR}:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:8}
\begin{split}{ANC}_{{0}} {\; }=\left[{0.000050}+{0.001\; }\cdot \left(1\; -\; {\mathop{e}\nolimits^{-1}} \right)\right]{\mathop{e}\nolimits^{1}} = 1.854 meq/L\end{split}
\end{equation}
The quantity of sodium bicarbonate required can be calculated from:
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:9}
\begin{split}[NaHCO_3]_0 =ANC_0\end{split}
\end{equation}
where \([NaHCO_3]_0\) = moles of sodium bicarbonate required per liter of lake water
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:10}
\begin{split}\frac{{1.854\; mmole\; NaHCO}_3 }{liter} {\times }\frac{{84\; mg\; NaHCO}_3 }{{mmole\; NaHCO}_3 } {\times \; 4\; Liters\; =\; 623\; mg\; NaHCO}_3\end{split}
\end{equation}

\section{Experimental Objectives}
\label{\detokenize{Acid_Rain/Acid_Rain:experimental-objectives}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-experimental-objectives}}
Remediation of acid lakes involves addition of ANC so that the pH is raised to an acceptable level and maintained at or above this level for some design period. In this experiment sodium bicarbonate (\(NaHCO_3\)) will be used as the ANC supplement. Since ANC addition usually occurs as a batch addition, the design pH is initially exceeded. ANC dosage is selected so that at the end of the design period pH is at the acceptable level. Care must be taken to avoid excessive initial pH — high pH can be as deleterious as low pH.

The most common remediation procedure is to apply the neutralizing agent directly to the lake surface, instead of on the watershed. We will follow that practice in this lab experiment. Sodium bicarbonate will be added directly to the surface of the lake that has an initial ANC of \(0 \mu eq/L\) and is receiving acid rain with a pH of 3. After the sodium bicarbonate is applied, the lake pH and ANC will be monitored for over two approximately 20 minute periods.


\section{Experimental Apparatus}
\label{\detokenize{Acid_Rain/Acid_Rain:experimental-apparatus}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-experimental-apparatus}}
The experimental apparatus consists of an acid rain storage reservoir, peristaltic pump, and lake (\hyperref[\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-apparatus}]{Fig.\@ \ref{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-apparatus}}}). The pH of the lake will be monitored using a pH probe connected to a signal-conditioning box that is connected to ProCoDA.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{Acid_rain_apparatus}.png}
\caption{Schematic drawing of the experimental setup.}\label{\detokenize{Acid_Rain/Acid_Rain:id2}}\label{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-apparatus}}\end{figure}


\section{procedures}
\label{\detokenize{Acid_Rain/Acid_Rain:procedures}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-procedures}}
The following directions are written for the use of ProCoDA II hardware and software for pH data collection and manual control of the peristaltic pump. It would also be possible to automate the experiment and control the pump using the ProCoDA II hardware and software.

We will use a pH probe to measure pH in this experiment. Each bench has one pH probe. Plug the pH probe into the blue signal-conditioning box (it takes a push and a twist). Connect the blue signal conditioning box to one of the sensor ports on your ProCoDA box.

Noisy pH measurements are a serious problem due to the static electricity generated by the peristaltic pump as it rotates and compresses the pump tubing. This can be solved by grounding the acidic solution as it is being pumped into the lake.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{acid_rain_grounding}.png}
\caption{Photo of the experimental setup showing how the incoming flow of acid is grounded to the metal rod that is connected to the stir plate that is electrically grounded.  This prevents pH fluctuations caused by static electricity generated by the peristaltic pump.}\label{\detokenize{Acid_Rain/Acid_Rain:id3}}\label{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-grounding}}\end{figure}

It is important that the electrical connection be solid all the way from the inverted U tube to the ground wire that is connected to the building electrical system. If the pH probe is noisy it may be necessary to tighten one or more of the connections in that path.
\begin{enumerate}
\item {} 
{\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-ph-measurement}]{\sphinxcrossref{\DUrole{std,std-ref}{Setup and calibrate the pH probe}}}}

\item {} 
Save the Calibration you have just created as a backup. You can do this by clicking on the \sphinxincludegraphics{{sensor_save_calibration_file}.png} button on the main menu.

\item {} 
Verify that the experimental setup is plumbed so that the acid rain is pumped directly into the lake.  The lake outflow should discharge into the small drain on the side of your work bench.

\item {} 
Organize the bench setup so that the metal tube discharging the acid rain into the lake is solidly touching the metal stand that is connected to the stirrer. This will ground the solution that is in the lake and reduce voltage fluctuations that are easily measured by the pH probe.

\item {} 
Check all of the push to connect fittings. To obtain a water tight connection it is necessary to twist and push so that the o’ring slides over the outside of the tube to create a seal. You can test run your system with just reverse osmosis water to check for leaks.

\item {} 
Preset pump to give desired flow rate of 267 mL/min (4 L/15 minutes) based on the size of pump tubing selected. Do not turn the pump on yet! For each tubing size, different pump speeds will correspond to different flow rates being output by the pump. The peristaltic tubing sizes are rather arbitrary and are labeled by numbers: 13, 14, 16, 17, and 18 in increasing order of size. If you have \#18 tubing, you will want an RPM setting of (267 mL/min) / (3.8 mL/rev) = 70.3 RPM (see \hyperref[\detokenize{ProCoDA/ProCoDA:table-procoda-pump-tubing}]{Table \ref{\detokenize{ProCoDA/ProCoDA:table-procoda-pump-tubing}}}).

\item {} 
Fill lake with reverse osmosis water and verify that the outflow is set so the lake volume is approximately 4 L.  Place the lake on top of a magnetic stirrer and add a stir bar.

\item {} 
Set stirrer speed to 8.

\item {} 
Add 1 mL of bromocresol green indicator solution to the lake.

\item {} 
Weigh out 623 mg (not grams!) \(NaHCO_3\).

\item {} 
Add \(NaHCO_3\) to the lake.

\item {} 
After the lake is well stirred take a 100 mL sample from the lake in the plastic sample bottle on your bench (this does not have to be exactly 100 mL; you just need enough for a pH reading). Don’t forget to label the sample bottle (include the time of the sample ex. Minute 0).

\item {} 
Clip the pH probe to the side of your lake in a more quiescent zone, away from the influent and effluent. You can do this with a clamp or you can simply tape the pH probe cable to the side of your lake.

\item {} 
We will continuously measure the pH of the effluent and log the data into a tab delimited file. Set the data interval to 1 second. Begin logging data to file by clicking on the \sphinxincludegraphics{{config_Logging_data_short_exp}.png} button. Create a new file in \sphinxcode{\sphinxupquote{S:\textbackslash{}Courses\textbackslash{}4530\textbackslash{}Group \#\textbackslash{}Lab 2 \textendash{} Acid Rain}}.

\item {} 
Prepare to write a comment in the file to mark the time when the pump starts by clicking on the \sphinxincludegraphics{{config_log_text_comment}.png} button. Type in a comment and then wait (the comment will not show up on the data sheet until you click enter).

\item {} 
At time equal zero (t=0) start the peristaltic pump and click on the enter button in the comment dialog box. \sphinxstylestrong{Tips}: You can observe the pH readings on the Graph Tab of ProCoDA. If your pH readings are being odd there is probably an air bubble trapped on the tip of the probe which can be removed by gently shaking the probe.

\item {} 
Take 100-mL grab samples from the lake effluent at 5, 10, 15, and 20 minutes in the plastic sample bottle on your bench. Don’t forget to label the sample bottle (include the time of the sample ex. Minute 5).

\item {} 
After the 20-minute sample, measure the flow rate by collecting effluent in a beaker for 30 seconds and measuring the volume collected (in a graduated cylinder for more accurate measurement).

\item {} 
Turn off the pump and stop measuring pH.

\item {} 
Measure the lake volume.  This can be done in a large graduated cylinder OR by taking the mass of the water in the lake.  Which would be more accurate?

\item {} 
Repeat the experiment and change one of the following parameters: stirring, initial ANC, ANC source (use \(CaCO_3\) instead of \(NaHCO_3\)), or amount of ANC added.

\end{enumerate}


\section{Clean Up}
\label{\detokenize{Acid_Rain/Acid_Rain:clean-up}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-clean-up}}\begin{enumerate}
\item {} 
Empty lake into sink, rinse with DI water, store on shelf at your workstation

\item {} 
Rinse all plastic tubing and place in a drawer at your workstation

\item {} 
Rinse metal tubes and place in the top drawer

\item {} 
Place peristaltic pump (and pump tubing) on the shelf at your workstation

\item {} 
Keep stirrer on your benchtop for use next week

\item {} 
Keep samples on your benchtop for analysis next week (make sure they are labeled!)

\item {} 
Rinse pH probe, insert into bottle cap (add buffer 4 if empty) and keep on your benchtop

\item {} 
Empty and rinse Jerrican and store on your workbench

\item {} 
Rinse gray PVC pipe and place in Jerrican

\item {} 
Put your data files somewhere accessible such as on your github repository.

\end{enumerate}


\section{pH Measurement}
\label{\detokenize{Acid_Rain/Acid_Rain:ph-measurement}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-ph-measurement}}
\sphinxstyleemphasis{pH}. pH \(\left(-log \left\{ H^+ \right\} \right)\) is usually measured electrometrically with a pH meter. The pH meter is a null-point potentiometer that measures the potential difference between an indicator electrode and a reference electrode. The two electrodes commonly used for pH measurement are the glass electrode and a reference electrode. The glass electrode is an indicator electrode that develops a potential across a glass membrane as a function of the activity (\(\mathrm{\sim}\) molarity) of \(H^+\). Combination pH electrodes, in which the \(H^+\)-sensitive and reference electrodes are combined within a single electrode body will be used in this lab. The reference electrode portion of a combination pH electrode is a {[}Ag/AgCl/4M KCl{]} reference. The response (output voltage) of the electrode follows a “Nernstian” behavior with respect to \(H^+\) ion activity.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:11}
\begin{split}E=E^{0} +\frac{RT}{nF} \ln \left(\frac{\left[H^{+} \right]}{\left[H^{+^{0} } \right]} \right)\end{split}
\end{equation}
where
\begin{quote}

\begin{DUlineblock}{0em}
\item[] \(R\) is the universal gas constant
\item[] \(T\) is temperature in Kelvin
\item[] \(n\) is the charge of the hydrogen ion,
\item[] \(F\) is the Faraday constant.
\item[] \(E^0\) is the calibration potential (Volts),
\item[] \(E\) is the potential (Volts) measured by the pH meter between glass and reference electrode. The slope of the response curve is dependent on the temperature of the sample and this effect is normally accounted for with simultaneous temperature measurements.
\end{DUlineblock}
\end{quote}

The electrical potential that is developed between the glass electrode and the reference electrode needs to be correlated with the actual pH of the sample. The pH meter is calibrated with a series of buffer solutions whose pH values encompass the range of intended use. The pH meter is used to adjust the response of the electrode system to ensure a Nernstian response is achieved over the range of the calibration standards.

To measure pH the electrode(s) are submersed in at least 50 mL of a sample. Samples are generally stirred during pH reading to establish homogeneity, to prevent local accumulation of reference electrode filling solution at the interface near the electrode, and to ensure the diffusive boundary layer thickness at the electrode surface is uniform and small.

\sphinxstyleemphasis{ANC}. The most common method to determine ANC for aqueous samples is titration with a strong acid to an endpoint pH. A pH meter is usually used to determine the endpoint or “equivalence point” of an ANC titration. Determination of the endpoint pH is difficult because it is dependent on the magnitude of the sample ANC. Theoretically this endpoint pH should be the pH where all of the ANC of the system is consumed, but since the ANC is not known \sphinxstyleemphasis{a priori}, a true endpoint cannot be predetermined. However, if most of the ANC is composed of carbonate and bicarbonate this endpoint is approximately pH = 4.5 for a wide range of ANC values.

A 50 to 100-mL sample is usually titrated while slowly stirred by a magnetic stirrer. pH electrodes are ordinarily used to record pH as a function of the volume of strong acid titrant added. The volume of strong acid required to reach the ANC endpoint (pH 4.5) is called the “equivalent volume” and is used in the following equation to compute ANC.
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:12}
\begin{split}ANC = \frac{{(equivalent\; vol.)(normality\; of\; titrant)}}{{(vol.\; of\; sample)}}\end{split}
\end{equation}
A more accurate technique to measure ANC is the Gran plot analysis. This is the subject of next week’s analysis. We will directly measure the ANC of the samples that were taken at t=0, 5, 10, 15, and 20 minutes in both of your experiments by means of a Gran plot analysis.


\section{Prelab Questions}
\label{\detokenize{Acid_Rain/Acid_Rain:prelab-questions}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-prelab}}\begin{enumerate}
\item {} 
How many grams of \(NaHCO_3\) would be required to keep the ANC levels in a lake above 50 \(\mu eq/L\) for 3 hydraulic residence times given an influent pH of 3.0 and a lake volume of 4 L, if the current lake ANC is 0 \(\mu eq/L\)?

\end{enumerate}


\section{Data Analysis}
\label{\detokenize{Acid_Rain/Acid_Rain:data-analysis}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-data-analysis}}
\(K_1 = 10^{-6.3}\), \(K_2 = 10^{-10.3}\), \(K_H = 10^{-1.5} \frac{mol}{L atm}\), \(P_{CO_2}=10^{-3.5} atm\), and \(K_w = 10^{-14}\).
\begin{enumerate}
\item {} 
Plot measured pH of the lake versus dimensionless hydraulic residence time (t/\(\theta\)).

\item {} 
Assuming that the lake can be modeled as a completely mixed flow reactor and that ANC is a conservative parameter, equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC0_CMFR} can be used to calculate the expected ANC in the lake effluent as the experiment proceeds. Graph the expected ANC in the lake effluent versus the hydraulic residence time (\(t/ \theta\)) based on the completely mixed flow reactor equation with the plot labeled (in the legend) as conservative ANC.

\item {} 
If we assume that there are no carbonates exchanged with the atmosphere during the experiment, then we can calculate ANC in the lake effluent by using equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_nonvolatile} describing the ANC of a closed system. Calculate the ANC under the assumption of a closed system and plot it on the same graph produced in answering question \#3 with the plot labeled (in the legend) as closed ANC.

\item {} 
If we assume that there is exchange with the atmosphere and that carbonates are at equilibrium with the atmosphere, then we can calculate ANC in the lake effluent by using equation \eqref{equation:Acid_Rain/Acid_Rain:eq_ANC_volatile} describing the ANC of an open system. Calculate the ANC under the assumption of an open system and plot it on the same graph produced in answering question \#3 with the plot labeled (in the legend) as open ANC.

\item {} 
Analyze the data from the second experiment and graph the data appropriately. What did you learn from the second experiment?

\end{enumerate}


\section{Questions}
\label{\detokenize{Acid_Rain/Acid_Rain:questions}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-questions}}\begin{enumerate}
\item {} \begin{description}
\item[{What do you think would happen if enough \(NaHCO_3\) were added to the lake to maintain an ANC greater than \(50 \mu eq/L\) for 3 residence times with the stirrer turned off? Here are a few things to consider.}] \leavevmode\begin{enumerate}
\item {} 
How much \(NaHCO_3\) would need to be added?

\item {} 
What is the density of sodium bicarbonate?

\item {} 
Given the density of sodium bicarbonate, what will happen to the sodium bicarbonate when it is added to the lake?

\end{enumerate}

\end{description}

\item {} \begin{description}
\item[{What are some of the complicating factors you might find in attempting to remediate a lake using \(CaCO_3\)? Below is a list of issues to consider.}] \leavevmode\begin{enumerate}
\item {} 
extent of mixing

\item {} 
solubility of \(CaCO_3\) (find the solubility and compare with \(NaHCO_3\))

\item {} 
density of \(CaCO_3\) slurry (find the density of \(CaCO_3\))

\end{enumerate}

\end{description}

\end{enumerate}


\section{References}
\label{\detokenize{Acid_Rain/Acid_Rain:references}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-references}}\begin{quote}

Driscoll, C.T., Jr. and Bisogni, J.J., Jr., “Weak Acid/Base Systems in Dilute Acidified Lakes and Streams of the Adirondack Region of New York State,” in \sphinxstyleemphasis{Modeling of Total Acid Precipitation Impacts} J.L. Schnoor (ed.), Butterworth, Stoneham, MA., 53-72 (1983).

Driscoll, C.T., Baker, J.P., Bisogni, J.J., And Schofield, C.L., “Aluminum Speciation and Equilibria in Dilute Surface Waters of the Adirondack Region of New York State,” in \sphinxstyleemphasis{Geological Aspects of Acid Deposition} O.P. Bricker (ed.), Butterworth, Stoneham, MA., 55-75 (1984).

Barnard. T.E., And Bisogni, J.J., Jr., “Errors in Gran Function Analysis of Titration Data for Dilute Acidified Water,” \sphinxstyleemphasis{Water Research}, 19, No. 3 393-399 (1985).

Bisogni, J.J., Jr. and Barnard, T.E., “Numerical Technique to Correct for Weak Acid Errors in Gran Function Analysis of Titration Data,” \sphinxstyleemphasis{Water Research}, 21, No. 10, 1207-1216 (1987).

Bisogni, J.J., Jr., “Fate of Added Alkalinity During Neutralization of an Acid Lake,” \sphinxstyleemphasis{Journal Environmental Engineering}, ASCE, 114, No. 5, 1219-1224 (1988).

Bisogni, J.J., Jr., and Kishbaugh, S.A., “Alkalinity Destruction by Sediment Organic Matter Dissolution During Neutralization of Acidified Lakes,” \sphinxstyleemphasis{Water, Air and Soil Pollution}, 39, 85-95 (1988).

Bisogni, J.J., Jr. and Arroyo, S.L., “The Effect of Carbon Dioxide Equilibrium on pH in PlaceNameplaceDilute PlaceTypeLakes,” \sphinxstyleemphasis{Water Research}, 25, No. 2, 185-190 (1991).

Olem, H. \sphinxstyleemphasis{Liming Acidic Surface Waters}. Lewis Publishers, Chelsea, MI. (1991).

Stumm, W. and Morgan, J.J., \sphinxstyleemphasis{Aquatic Chemistry}, John Wiley \& Sons, Inc. NY, NY 1981.
\end{quote}


\section{Lab Prep Notes}
\label{\detokenize{Acid_Rain/Acid_Rain:lab-prep-notes}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-lab-prep-notes}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Reagent list.}\label{\detokenize{Acid_Rain/Acid_Rain:id4}}\label{\detokenize{Acid_Rain/Acid_Rain:table-acid-reagent-list}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{50}|\X{20}{50}|\X{10}{50}|}
\hline
\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Supplier
&\sphinxstyletheadfamily 
Catalog number
\\
\hline
HCL 5.0 N
&
Fisher Scientific
&
LC15360-2
\\
\hline
H2SO4 5N
&
Fisher Scientific
&
LC25840-2
\\
\hline
CaCO3
&
Fisher Scientific
&
C63-3
\\
\hline
Na2CO3
&
Fisher Scientific
&
S263-500
\\
\hline
Buffer-Pac
&
Fisher Scientific
&
SB105
\\
\hline
NaHCO3
&
Fisher Scientific
&
S233-500
\\
\hline
Bromocresol Green
&
Fisher Scientific
&
B383-5
\\
\hline
ethanol
&
Fisher Scientific
&
A962P-4
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Bromocresol Green Indicating Solution}
\label{\detokenize{Acid_Rain/Acid_Rain:bromocresol-green-indicating-solution}}
Prepare solution of 400 mg Bromocresol green/100 mL ethanol. Add 0.2 mL of indicator solution per liter of acid rain or lake.


\subsection{Acid rain}
\label{\detokenize{Acid_Rain/Acid_Rain:acid-rain}}
Acid rain is at pH 3.0. Prepare from reverse osmosis water. Add 1 meq \(H_2SO_4\)/L (\([H^+]\) = 1 meq at pH 3.0) to obtain a pH of 3.0. To acidify 20 liters of reverse osmosis water using 10 N \(H_2SO_4\):
\begin{equation}\label{equation:Acid_Rain/Acid_Rain:Acid_Rain/Acid_Rain:13}
\begin{split}20~L\bullet \frac{1~meq~H_2SO_4}{L}\bullet \frac{1}{10~N~H_2SO_4}\bullet \frac{1~N}{1000~meq}=2~mL~of~10~N~H_2SO_4\end{split}
\end{equation}

\subsection{Flow Rate}
\label{\detokenize{Acid_Rain/Acid_Rain:flow-rate}}
The residence time of the lake should be 15 minutes. The lake volume is 4 L. thus the flow rate is 267 mL/min. Use \# 18 PharMed tubing.


\section{Setup}
\label{\detokenize{Acid_Rain/Acid_Rain:setup}}\label{\detokenize{Acid_Rain/Acid_Rain:heading-acid-rain-setup}}\begin{enumerate}
\item {} 
Prepare 20-L acid rain for each group.

\item {} 
Prepare bromocresol green solution if necessary.

\item {} 
Attach one Easy-Load pump head to the pump drives and plumb with \#18 tubing.

\item {} 
Plumb Jerrican to pump to lake using quick connectors (see \hyperref[\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-apparatus}]{Fig.\@ \ref{\detokenize{Acid_Rain/Acid_Rain:figure-acid-rain-apparatus}}}).

\item {} 
Verify that pH probes are operational, stable, and can be calibrated.

\item {} 
Verify that buffers (pH = 4, 7, 10) are distributed to each student group.

\item {} 
Provide a effluent beaker with an overflow in which pH can be measured.

\end{enumerate}


\chapter{Acid Neutralizing Capacity}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:acid-neutralizing-capacity}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:title-acid-neutralizing-capacity}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity::doc}}

\section{Introduction}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:introduction}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-introduction}}
Acid neutralizing capacity (ANC) is a measure of the ability of water to neutralize acid inputs. Lakes with high ANC (such as Cayuga Lake) can maintain a neutral pH even with some acid rain input whereas lakes with an ANC less than the acid input will not maintain a neutral pH. In the Adirondack region of New York State, lakes typically receive large inputs of acids during the spring thaw when the accumulated winter snow melts and runs off into the lakes. The ANC of Adirondack lakes is not always sufficient to neutralize these inputs.


\section{Theory}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:theory}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-theory}}
The ANC for a typical carbonate-containing sample is defined as:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_ANC_definition}
\begin{split} ANC = [HCO_3^-]+2[CO_3^{-2} ]+{[OH}^- ] - [H^+]\end{split}
\end{equation}
Equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_ANC_definition} can be derived from a charge balance if ANC is considered to be the cation contributed by a strong base titrant and if other ions present do not contribute significantly.

Determination of ANC or alkalinity involves determination of an equivalence point by titration with a strong acid. The equivalence point is defined as the point in the titration where titrant volume that has been added equals the “equivalent” volume (\(V_e\)). The equivalent volume is defined as:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:0}
\begin{split}V_{e} {\; =}\frac{V_{s} \cdot N_{s} }{N_{t} }\end{split}
\end{equation}
where:
\begin{quote}

\begin{DUlineblock}{0em}
\item[] Ns = normality (in this case alkalinity or ANC) of sample, equivalents/L
\item[] Vs = volume of sample, liters
\item[] Nt = normality of titrant, equivalents/L.
\end{DUlineblock}
\end{quote}

The titration procedure involves incrementally adding known volumes of standardized normality strong acid (or base) to a known volume of unknown normality base (or acid). When enough acid (or base) has been added to equal the amount of base (or acid) in the unknown solution we are at the “equivalence” point. The point at which we add exactly an equivalent or stoichiometric amount of titrant is the equivalence point. Experimentally, the point at which we estimate to be the equivalence point is called the titration endpoint.

There are several methods for determining \(V_e\) (or the equivalence point pH) from titration data (titrant volume versus pH). The shape of the titration curve (\(V_t\) versus pH) can reveal \(V_e\). It can be shown that one inflection point occurs at \(V_t= V_e\). In the case of monoprotic acids, there is only one inflection in the pH range of interest. Therefore, an effective method to find the equivalence volume is to plot the titration curve and find the inflection point. Alternately, plot the first derivative of the titration plot and look for a maximum.


\subsection{Gran Plot}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:gran-plot}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-gran-plot}}
Another method to find the ANC of an unknown solution is the Gran plot technique. When an ANC determination is being made, titration with a strong acid is used to “cancel” the initial ANC so that at the equivalence point the sample ANC is zero. The Gran plot technique is based on the fact that further titration will result in an increase in the number of moles of \(H^+\) equal to the number of moles of \(H^+\) added. Thus after the equivalence point has been attained, the number of moles of \(H^+\) added equals the number of moles of \(H^+\) in solution. An equation describing this mass balance is provided as:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_H_balance}
\begin{split} N_{t} \left(V_{t} -V_{e} \right)=\left(V_{s} +V_{t} \right)\left[H^{+} \right]\end{split}
\end{equation}
Solving for the hydrogen ion concentration:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_hydrogen_ion}
\begin{split} \left[H^{+} \right]=\frac{N_{t} \left(V_{t} -V_{e} \right)}{\left(V_{s} +V_{t} \right)}\end{split}
\end{equation}
Equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_hydrogen_ion} can also be solved directly for the equivalent volume.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_ve}
\begin{split} V_{e} =V_{t} -\frac{\left[H^{+} \right]\left(V_{s} +V_{t} \right)}{N_{t} }\end{split}
\end{equation}
Equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_ve} is valid if enough titrant has been added to neutralize the ANC. A better measure of the equivalent volume can be obtained by rearranging equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_ve} so that linear regression on multiple titrant volume - pH data pairs can be used.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:1}
\begin{split}\frac{\left(V_{s} +V_{t} \right)}{V_{s} } \left[H^{+} \right]=\frac{N_{t} V_{t} }{V_{s} } -\frac{N_{t} V_{e} }{V_{s} }\end{split}
\end{equation}
We define \(F_1\) (First Gran function) as:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_F1}
\begin{split} F_1 = \frac{V_s +V_t }{V_s } {[H}^+ {]}\end{split}
\end{equation}
If \(F_1\) is plotted as a function of \(V_t\) the result is a straight line with slope = \(\frac{N_{t} }{V_{s} }\) and abscissa intercept of \(V_e\) (\hyperref[\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:figure-gran-plot}]{Fig.\@ \ref{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:figure-gran-plot}}}).

The ANC is readily obtained given the equivalent volume. At the equivalence point:
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_equivalence}
\begin{split} V_s ANC= V_e N_t\end{split}
\end{equation}
Equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_equivalence} can be rearranged to obtain ANC as a function of the equivalent volume.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_ANC}
\begin{split} ANC=\frac{V_e N_t }{V_s }\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Gran_plot}.png}
\caption{Gran plot from titration of a weak base with 0.05 N acid. \(C_T\) = 0.001 moles of carbonate and sample volume is 48 mL. The equivalent volume was 4.8 mL. From equation  \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_ANC} the ANC was 5 meq/L.}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:id1}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:figure-gran-plot}}\end{figure}


\subsection{pH Measurements}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:ph-measurements}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-ph-measurements}}
The pH can be measured either as activity \(\mathrm{\{}H^+\mathrm{\}}\) as measured approximately by pH meter) or molar concentration ({[}H\textasciicircum{}+{]}). The choice only affects the slope of F1 since \([H^+] = \mathrm{\{}H^+\mathrm{\}/\gamma}\).
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:2}
\begin{split}F_1 =\frac{V_s +V_t }{V_s}  [H^+] = \frac{V_s + V_t}{V_s} \frac{\{ H^+ \} }{\gamma} = N _t \frac{V_t - V_e}{V_s}\end{split}
\end{equation}
where \(\gamma\) is the activity correction factor and the slope is \(N_t/V_0\). If \([H^+]\) concentration is used then
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:3}
\begin{split}F_1 = \frac{V_s +V_t }{V_s } { \{ H}^+ {\}} = \gamma N_t \frac{V_t - V_e}{V_s}\end{split}
\end{equation}
where the slope is \(\frac{\gamma \cdot N_t}{V_s}\).

This analysis assumes that the activity correction factor doesn’t change appreciably during the titration).

There are many other Gran functions that can be derived. For example, one can be derived for Acidity or the concentration of a single weak or strong acid or base.

To facilitate data generation and subsequent Gran plot construction and analysis pH versus titrant volume can be read directly into a computer, that can be programmed to analyze the data using the Gran plot theory. The program generates the Gran function for all data and then systematically eliminates data until the Gran function (plot) is as linear as possible. The line is then extrapolated to the abscissa to find the equivalent volume.


\subsection{ANC Determination for Samples with pH \textless{} 4}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:anc-determination-for-samples-with-ph-4}}
After the equivalence point has been reached (adding more acid than ANC = 0) the only significant terms in equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_ANC_definition} are \(\left[{H}^{+} \right]\) and ANC.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_protons_dominate}
\begin{split} \left[{H}^{+} \right]>>{\; }\left[{HCO}_{{3}}^{{-}} \right]+{\; 2}\left[{CO}_{{3}}^{{-2}} \right]+\left[{OH}^{{-}} \right]{\; }\end{split}
\end{equation}
When the pH is 2 pH units or more below the lowest \(pK_a\) of the bases in the system the only species contributing significantly to ANC is the hydrogen ion (equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_protons_dominate}) and thus the ANC is simply
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_pH_lt4}
\begin{split} ANC= - [H^+]\end{split}
\end{equation}
For a sample containing only carbonates, if the pH is below 4 the ANC is approximately equal to -{[}\(H^+\){]} and no titration is necessary.


\subsection{Titration Techniques}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:titration-techniques}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-titration-techniques}}
Operationally, the first few titrant volumes can be relatively large increments since the important data lies at pH values less than that of the equivalence point (approximately pH = 4.5 for an Alkalinity titration). As the pH is lowered by addition of acid the ionic strength of the solution increases and the activity of the hydrogen ion deviates from the hydrogen ion concentration. This effect is significant below pH 3 and thus the effective linear range is generally between pH 4.5 and pH 3.0. The maximum incremental titrant volume (\(\mathrm{\Delta}V_a\)) that will yield n points in this linear region is obtained as follows.

If \(V_s\) \textgreater{}\textgreater{} \(V_t\) then equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_H_balance} reduces to
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:4}
\begin{split}{N}_{{t}} {\; \; \; }\frac{(V_{t} -V_{e} )}{V_{s} } \cong {\; [H}^{+} {]}\end{split}
\end{equation}
Let \([H^+]_e\) be the concentration of hydrogen ions at the equivalence point and \([H^+]_f\) be the final concentration of hydrogen ions at the end of the titration.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:5}
\begin{split}N_t \frac{(V_e - V_e)-(V_f - V_e)}{V_s} =[H^+]_e [H^+]_f\end{split}
\end{equation}
Thus the volume of acid added to go from \([H^+]_e\) to \([H^+]_f\) is
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_linear_titrant}
\begin{split} V_f - V_e =\frac{V_s \left([H^+]_f -[H^+]_e \right)}{N_t}\end{split}
\end{equation}
To obtain n data points between \([H^+]_e\) - \([H^+]_f\) requires the incremental titrant volume (\(\mathrm{\Delta} V_t\)) be 1/n times the volume of acid added between the equivalence point and the final titrant volume. Thus by substituting \(n\mathrm{\Delta}V_t\), and typical hydrogen ion concentrations of \([H^+]_e = 10^{-4.5}\) and \([H^+]_f = 10^{-3.0}\) into equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_linear_titrant} the maximum incremental titrant volume is obtained.
\begin{equation}\label{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:6}
\begin{split}\Delta V_t\cong \frac{(0.001-0.00003)V_s }{n\; N_t} \cong \frac{0.001V_s}{n\; N_t}\end{split}
\end{equation}

\section{Procedures}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:procedures}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-procedures}}

\subsection{Determine ANC of a Known Sample}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:determine-anc-of-a-known-sample}}\begin{enumerate}
\item {} 
Measure approximately 50 mL of reverse osmosis water (ANC = 0 meq/L) in a 100 mL beaker using an electronic balance.

\item {} 
Place the beaker on the magnetic stirrer, add a stir bar and stir slowly.

\item {} 
Place the pH electrode in the solution.

\item {} 
Analyze the sample using {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-gran-plot}]{\sphinxcrossref{\DUrole{std,std-ref}{Gran plot analysis}}}}.  Add 0.05 N HCl (the titrant) using a digital pipette in increments suggested by ProCoDA (or smaller).

\item {} 
Save the Gran data by selecting \sphinxincludegraphics{{Gran_save}.png}. The data will be saved in a tab delimited format. You will use this data to plot a titration curve and to verify that the Gran technique accurately measures the ANC of a sample.

\end{enumerate}

If the error is greater than 0.1 meq/L (equal to an error of 0.1 mL titrant) then check your pipette technique using a balance, verify that you ended the titration process correctly with a high correlation coefficient, and then repeat the titration.


\subsection{Determine ANC of Acid Rain Samples}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:determine-anc-of-acid-rain-samples}}
Determine the ANC for all samples collected from the Acid Lake Remediation lab.  Start with 50 mL from the t=0 sample and run through the procedure to learn how the software works. Then repeat the procedure with 50 mL from the t=0 sample and for remaining samples with the goal of making an accurate ANC measurement and creating an accurate titration curve by using 0.100 mL titrant increments throughout the entire titration. Remember that the biggest source of error for this lab will likely be poor pipette techniques.
\begin{enumerate}
\item {} 
Measure approximately 50 mL of a sample in a 100 mL beaker using an electronic balance.

\item {} 
Place the beaker on the magnetic stirrer, add a stir bar and stir slowly.

\item {} 
Place the pH electrode in the solution.

\item {} 
If the initial pH is less than 4.5 no titration is necessary and equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_Gran_pH_lt4} can be used to calculate the ANC.

\item {} 
Record the initial pH (prior to adding any titrant) and initial sample volume.

\item {} 
Analyze the sample using {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-gran-plot}]{\sphinxcrossref{\DUrole{std,std-ref}{Gran plot analysis}}}}.  Add 0.05 N HCl (the titrant) using a digital pipette in increments suggested by ProCoDA (or smaller).

\item {} 
Save the Gran data by selecting \sphinxincludegraphics{{Gran_save}.png}. The data will be saved in a tab delimited format. You will use this data to plot a titration curve and to verify that the Gran technique accurately measures the ANC of a sample.

\end{enumerate}


\section{Clean Up}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:clean-up}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-clean-up}}\begin{enumerate}
\item {} 
Empty and rinse sample bottles and place them on the drying racks.

\item {} 
Rinse the pH probe with reverse osmosis water

\item {} 
Reinstall the pH probe in the small bottle that ensures that the pH probe is maintained moist in a low pH solution (can be pH buffer 4.0).

\item {} 
Put away all of the equipment except for the ProCoDA box.

\end{enumerate}


\section{Prelab Questions}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:prelab-questions}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-prelab-questions}}\begin{enumerate}
\item {} 
Compare the ability of Cayuga lake and Wolf pond (an Adirondack lake) to withstand an acid rain runoff event (from snow melt) that results in 20\% of the original lake water being replaced by acid rain. The acid rain has a pH of 3.5 and is in equilibrium with the atmosphere. The ANC of Cayuga lake is 1.6 meq/L and the ANC of Wolf Pond is 70 \(\mu eq/L\). Assume that carbonate species are the primary component of ANC in both lakes, and that they are in equilibrium with the atmosphere. What is the pH of both bodies of water after the acid rain input? Remember that ANC is the conservative parameter (not pH!). Hint: You can use the scipy optimize root finding function called brentq. Scipy can’t handle units so the units must be removed using .magnitude.\}

\item {} 
What is the ANC of a water sample containing only carbonates and a strong acid that is at pH 3.2? This requires that you inspect all of the species in the ANC equation (Equation \eqref{equation:Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:eq_ANC_definition}) and determine which species are important.

\item {} 
Why is {[}\(H^+\){]} not a conserved species?

\end{enumerate}


\section{Data Analysis}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:data-analysis}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-data-analysis}}\begin{enumerate}
\item {} 
Plot the titration curve of the t=0 sample with 0.05 N HCl (plot pH as a function of titrant volume). Label the equivalent volume of titrant. Label the 2 regions of the graph where pH changes slowly with the dominant reaction that is occurring. (Place labels with the chemical reactions on the graph in the pH regions where each reaction is occurring.) Note that in a third region of slow pH change no significant reactions are occurring (added hydrogen ions contribute directly to change in pH).

\item {} 
Prepare a Gran plot using the data from the titration curve of the t=0 sample. Use linear regression on the linear region or simply draw a straight line through the linear region of the curve to identify the equivalent volume. Compare your calculation of \(V_e\) with that was calculated by ProCoDA.

\item {} 
Plot the measured ANC of the lake on the same graph as was used to plot the conservative, volatile, and nonvolatile ANC models (see questions 2 to 5 of the Acid Precipitation and Remediation of an Acid Lake lab).

\item {} 
Did the measured ANC values agree with the conservative ANC model?

\item {} 
Was the lake in equilibrium with atmospheric \(CO_2\)?

\end{enumerate}


\section{References}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:references}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-references}}\begin{quote}

Sawyer, C.N., P.L. McCarty and G.F. Parkin textit\{Chemistry for Environmental Engineering\}underbar\{, \}4th ed., McGraw-Hill (1994).

Pankow, J.F. textit\{Aquatic Chemistry Concepts\}, Lewis Publishers (1991).

Morel, F.M.M. and J.G. Hering textit\{Principles and Applications of Aquatic Chemistry\} Wiley-Interscience (1993).

Stumm, W. and J.J. Morgan textit\{Aquatic Chemistry\} 2nd ed. Wiley Interscience (1981).
\end{quote}


\section{Lab Prep Notes}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:lab-prep-notes}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-lab-prep-notes}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Reagent list.}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:id2}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:table-anc-reagent-list}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{50}|\X{20}{50}|\X{10}{50}|}
\hline
\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Supplier
&\sphinxstyletheadfamily 
Catalog number
\\
\hline
HCl 5.0 N
&
Fisher Scientific
&
LC15360-2
\\
\hline
Buffer-Pac
&
Fisher Scientific
&
SB105
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{Setup}
\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:setup}}\label{\detokenize{Acid_Neutralizing_Capacity/Acid_Neutralizing_Capacity:heading-anc-setup}}\begin{enumerate}
\item {} 
Verify that the pH probes are operational, stable, and can be calibrated.

\item {} 
Verify that buffers (pH = 4, 7, 10) are distributed to each student group

\end{enumerate}


\chapter{Reactor Characteristics}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:reactor-characteristics}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:title-reactor-characteristics}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics::doc}}

\section{Introduction}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:introduction}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-introduction}}
Chemical, biological, and physical processes in nature and in engineered systems usually take place in what we call “reactors.” Reactors are defined by a real or imaginary boundary that physically confines the processes. Lakes, segments of a river, and settling tanks in treatment plants are examples of reactors. Most, but not all, reactors experience continuous flow (in and out). Sequencing batch reactors have a sequence of states including fill, react, and empty. It is important to know the mixing level and residence time in reactors, since they both affect the degree of process reaction that occurs while the fluid (usually water) and its components (often pollutants) pass through the reactor.

Chlorine contactor tanks are designed to maximize the contact time between chlorine and pathogens before the water is delivered to consumers. Thus the design objective is to maximize the time that it takes for water to travel from the tank influent to the effluent. Tracer studies can be used to determine the hydraulic characteristics of a reactor such as the disinfection contact tanks at water treatment plants. The results from tracer studies are used to obtain accurate estimates of the effective contact time. In this laboratory students will experiment with different reactor designs with the goal of maximizing the contact time.


\section{Classifications}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:classifications}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-classifications}}

\subsection{Dispersion}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:dispersion}}
Mixing levels give rise to three categories of reactors; completely mixed flow reactors (CMFR), plug flow reactors (PFR) and flow with dispersion reactors (FDR). The plug flow reactor is an idealized extreme not attainable in practice. All real reactors fall under the category of FDR or CMFR.


\subsection{Boundary Conditions}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:boundary-conditions}}
The reactor inlet and outlet boundary conditions significantly affect the reactor response to the addition of a pulse of tracer. If dispersion is possible across a boundary, then the boundary is open. An example of a reactor with open boundaries is a section of a river. If a tracer is added to a section of a river it is possible for some of the tracer to move upstream, illustrating that an arbitrary section of a river is an open reactor (\hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-open-boundaries}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-open-boundaries}}}). This is equivalent to letting the reactor be defined as a section of a long reactor. One of the characteristics of open boundaries is that some of the tracer introduced at the reactor inlet can be carried upstream and thus the residence time for a conservative tracer can be greater than the hydraulic residence time!

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{open_boundaries}.png}
\caption{Schematic of a reactor with open boundary conditions.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id1}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-open-boundaries}}\end{figure}

A closed reactor is one where the reactor has a diffusion or dispersion coefficient different than those of the entrance or exit (\hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-closed-boundaries}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-closed-boundaries}}}).  Typically exit and entrance diffusion/dispersion are much less than the diffusion/dispersion in the reactor. An example of a reactor with closed boundaries is a tank with small inlet and outlet pipes.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{closed_boundaries}.png}
\caption{Schematic of a reactor with closed boundary conditions.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id2}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-closed-boundaries}}\end{figure}


\subsection{Modeling}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:modeling}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-modeling}}
Reactors can be studied by measuring the effluent concentration after the addition of a spike or pulse of a tracer in the influent or after a step function change in input concentration. The resulting response curves can be made non-dimensional by plotting \(\frac{C_t{\rlap{-} V }_r}{C_{tr}{\rlap{-} V }_{tr}}\) as a function of \({t/\theta}\). where \(\theta\) is the hydraulic residence time. The term \({t/\theta}\) will be defined as \(t^{\star}\). The non-dimensional response curves from pulse inputs and step inputs are known as E curves and F curves, respectively. The E curve is the exit age distribution and represents the actual output of tracer from a reactor.  The F curve is the cumulative age distribution and represents the cumulative fraction of tracer that has exited a reactor at time \(t^{\star}\). The E and F curves are related by
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:0}
\begin{split}F_{\left(t^{\star} \right)} =\int _{0}^{t^{\star} }E_{\left(t^{\star} \right)} dt^{\star}\end{split}
\end{equation}
The \(F_{\left(t^{\star} \right)}\) curve can either be obtained by integrating \(E_{\left(t^{\star} \right)}\) or by applying a step function change in influent concentration to a reactor and monitoring the effluent concentration. In that case \(F_{\left(t^{\star} \right)}\) is defined as
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:1}
\begin{split}F_{\left(t^\star\right)}=\frac{C_{\left(t^\star\right)}}{C_{in}}\end{split}
\end{equation}
The following sections will include typical E and F curves for different reactor types.


\subsection{Completely Mixed Flow Reactor}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:completely-mixed-flow-reactor}}
Completely mixed flow regimes can be approximated quite closely in practice. In the case of CMFRs, there is not an analytical solution to the advection-dispersion equation so we revert to a simple mass balance. For a completely mixed reactor a mass balance on a conservative tracer yields the following differential equation:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_mass_balance}
\begin{split} \rlap{-} V _{r} \frac{dC}{dt} =\left(C_{in} -C\right)Q\end{split}
\end{equation}
where Q is the volumetric flow rate and \(\rlap{-} V_r\) is the volume of the reactor.

Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_mass_balance} can be used to predict a variety of effluent responses to tracer inputs. If a pulse of tracer is discharged directly into a reactor so that the initial concentration of tracer in the reactor is \(C_{0} =\frac{C_{tr} \rlap{-} V _{tr} }{\rlap{-} V _{r} }\) and the input concentration is zero (\(C_{in} = 0\)) the solution to the differential equation is:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:2}
\begin{split}E_{\left(t\right)}=\frac{C_t{\rlap{-} V }_r}{C_{tr}{\rlap{-} V }_{tr}}=e^{\left(-t/\theta \right)}\end{split}
\end{equation}
or in the dimensionless form
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:3}
\begin{split}E_{\left(t^{\star} \right)} =\frac{C_{\left(t^{\star} \right)} \rlap{-} V _{r} }{C_{tr} \rlap{-} V _{tr} } ={\mathop{e}\nolimits^{\left(-t^{\star} \right)}}\end{split}
\end{equation}
where \(E_{\left(t^{\star} \right)}\) is the exit age or residence time distribution curve, \(\rlap{-} V _{r}\) is the reactor volume, \(\rlap{-} V _{tr}\) is the tracer volume, and \(C_{tr}\) is the tracer concentration.  If a reactor has a completely mixed flow regime its response, \(E_{\left(t^{\star} \right)}\), to a pulse input should plot as a straight line on a semi-logarithmic plot. Response curves for a CMFR are shown in \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-cmfr-e-and-f}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-cmfr-e-and-f}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{CMFR_E_and_F}.png}
\caption{Exit age (E) and Cumulative exit age (F) curves for completely mixed flow reactors.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id3}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-cmfr-e-and-f}}\end{figure}

The time for 10\% of the pulse to arrive at the effluent of a CMFR is approximately 0.1 \(t^{\star}\).


\subsection{Plug Flow Reactor}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:plug-flow-reactor}}
Plug flow regimes are impossible to attain because mass transport must be by advection alone. There can be no differential displacement of tracer relative to the average advective velocity. In practice some mixing will occur due to molecular diffusion, turbulent dispersion, and/or fluid shear. For the case of the plug flow reactor the advection-dispersion equation in 1.7 reduces to:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:4}
\begin{split}\frac{\partial C}{\partial t} =-U\frac{\partial C}{\partial x}\end{split}
\end{equation}
The velocity, U, serves to transform the directional concentration gradient into a temporal concentration gradient. In other words, a conservative substance moves with the advective flow of the fluid. The solutions to this differential equation for a pulse input and for a step input are shown graphically in \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pfr-pulse-step}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pfr-pulse-step}}}. The time for 10\% of the pulse to arrive at the effluent of a PFR is \(t^{\star}\) since all of the pulse arrives at the same time.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{PFR_pulse_step}.png}
\caption{Pulse and step input in a plug flow reactor.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id4}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pfr-pulse-step}}\end{figure}


\subsection{Flow with Dispersion}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:flow-with-dispersion}}
Real flow reactors that aren’t completely mixed exhibit behavior that is between plug flow and completely mixed. The reactor flow behavior is a function of the relative strength of the mixing process (or dispersion) compared to the advective flow. Analytical solutions that describe these real reactors are more difficult and in most cases a parameter describing the dispersion is fit to the data rather than predicted \sphinxstyleemphasis{a priori}. Two models for arbitrary mixing levels are described below.


\subsection{Open Boundary conditions: One Dimensional Advection-Dispersion Equation}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:open-boundary-conditions-one-dimensional-advection-dispersion-equation}}
The governing differential equation for a conservative (i.e., non-reactive) substance in a reactor that has advective transport (i.e., flow) and some mixing (dispersion) in the direction of flow (x - dimension) is given in equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_diff_advect_disperse}.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_diff_advect_disperse}
\begin{split} \frac{\partial C}{\partial t} ={\rm \; -U}\frac{\partial C}{\partial x} +{\rm \; D}_{{\rm d}} \frac{\partial ^{2} C}{\partial x^{2}}\end{split}
\end{equation}\begin{description}
\item[{Where}] \leavevmode
\begin{DUlineblock}{0em}
\item[] C = concentration of a conservative substance
\item[] U = average fluid velocity in the x direction
\item[] Dd = longitudinal dispersion coefficient
\item[] t = time
\end{DUlineblock}

\end{description}

The dispersion is described by a single parameter that is the same in the reactor as it is at the inlet and outlet for open boundary conditions. The solution to \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_diff_advect_disperse} for the case of complete mixing in the y-z plane and advective and dispersive transport only in the x direction for any x and t (after t=0) gives:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse}
\begin{split} {\rm C(x,t)\; }={\rm \; }\frac{M}{A\sqrt{4\pi D_{d} t} } \exp \left[\frac{-x'^{2} }{4D_{d} t} \right]\end{split}
\end{equation}\begin{description}
\item[{Where}] \leavevmode
\begin{DUlineblock}{0em}
\item[] M = mass of conservative material in the spike
\item[] \(D_{d}\) = axial dispersion coefficient {[}L2/T{]},
\item[] x’ = x - Ut, U = longitudinal advective velocity in the reactor,
\item[] A is the cross-sectional area of the reactor.
\end{DUlineblock}

\end{description}

A measure of dispersion can be obtained directly from equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse}. From this equation we expect a maximum value of C at t = x/U. At this time \({\rm C(x,t)\; }={\rm \; }\frac{M}{A\sqrt{4\pi D_{d} t} }\) . If the mass of the tracer input (M) and reactor cross-sectional area (A) are known, then \(D_{d}\) can be estimated. Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse} can be made dimensionless to more clearly reveal the important parameters. The dispersion coefficient can be made dimensionless by dividing into a velocity and a length.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Pe}
\begin{split} Pe=\frac{UL}{D_{d}}\end{split}
\end{equation}
where L is the length of the reactor and U is the mean advective velocity. The dimensionless parameter Pe (Peclet number) is used to characterize the level of dispersion in a reactor. The Peclet number is the ratio of advective to dispersive transport. In the limiting cases when Pe = 0 (very high dispersion) we have a completely mixed regime (CMFR) and when \(Pe = \mathrm{\infty}\), \(D_{d}\) = 0, no dispersion) we have a plug flow reactor (PFR).

The time can be normalized by dividing by the hydraulic residence time.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tstar}
\begin{split} t^{\star} =\frac{tU}{L}\end{split}
\end{equation}
Combining Equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Pe} and \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tstar} we obtain \(D_{d} t=t^{\star} PeL^{2}\) for substitution into Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse}. The concentration can be normalized by the mass of the tracer and the volume, \(\rlap{-} V\), of the reactor.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:5}
\begin{split}\rlap{-} V =AL\end{split}
\end{equation}\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:6}
\begin{split}E_{\left(t^{\star} \right)} =\frac{{\rm C(x,t)}\rlap{-} V }{{\rm M}}\end{split}
\end{equation}
The position in the reactor where the concentration measurements are made can be changed to the reactor effluent by substituting L for x. Substituting Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tstar} into the definition of \(x'^{2}\) we obtain:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:7}
\begin{split}x'^{2} =\left(L-Ut\right)^{2} =\left(1-t^{\star} \right)^{2} L^{2}\end{split}
\end{equation}
The resulting dimensionless form of Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse} is given in Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_AD}.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_AD}
\begin{split} E_{\left(t^{\star} \right)} =\sqrt{\frac{Pe}{4\pi t^{\star} } } \exp \left[\frac{-\left(1-t^{\star} \right)^{2} Pe}{4t^{\star} } \right]\end{split}
\end{equation}
Response curves for the advection-dispersion equation are shown in \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-100}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-100}}} and \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-4}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-4}}}. The exit age curve is highly skewed for low Pe because tracer that is in the reactor longer has more time for dispersion. As the Peclet number increases the dispersion decreases and the response becomes closer to plug flow.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{E_F_Pe_100}.png}
\caption{Exit age (E) and cumulative exit age (F) curves for the advection-dispersion equation with Pe of 100.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id5}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-100}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{E_F_Pe_4}.png}
\caption{Exit age (E) and cumulative exit age (F) curves for the advection-dispersion equation with Pe of 4.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id6}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-pe-4}}\end{figure}

Flow through porous media (such as groundwater through soil) is a type of flow with dispersion. The above equations can be applied by recognizing that the relevant water velocity is the pore water velocity. The pore water velocity is \(U = \frac{Q}{A\phi }\) where A is the cross sectional area of the porous media and \(\phi\) (volume of voids/total volume) is the porosity of the porous media.

The form of equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_advect_disperse} is exactly like the normal distribution curve:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:8}
\begin{split}\frac{CA}{M} ={\rm \; }\frac{1}{\sigma _{x} \sqrt{2\pi } } \exp \left[\frac{-x^{2} }{4\sigma _{x}^{2} } \right]\end{split}
\end{equation}
where
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_dispersion}
\begin{split} \sigma _{x}^{2} =2D_{d} t\end{split}
\end{equation}
Or in dimensionless form:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:9}
\begin{split}\frac{\sigma _{x}^{2} }{L^{2} } =2t^{\star} Pe\end{split}
\end{equation}
The variance in concentration over space (\(\sigma _{x}^{2}\)) is the variance in concentrations taken from many different positions in the reactor at some single moment in time, t. The variance in x (\(\sigma _{x}^{2}\)) has dimensions of length squared.


\subsection{Closed Boundary Conditions: Completely Mixed Flow Reactor in Series}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:closed-boundary-conditions-completely-mixed-flow-reactor-in-series}}
Completely mixed flow reactors are sometimes connected in series to create a reactor system with flow characteristics in between CMFR and PFR. CMFRs in series increase overall process efficiency because the reactants are at higher concentrations in the first reactors than they would be in a single large CMFR. Thus the total reactor volume can be smaller with a series of CMFRs. Similarly the reaction process can be made more efficient given the same reactor volume if it is divided into a series of CMFRs.

Non ideal reactors with mixing levels between that of CMFRs and PFRs and reactors containing baffles can also be modeled as a series of CMFRs. In this case the mixing level for the system is represented by the number of CMFRs that are used to represent the non-ideal reactor. The equation describing the concentration of a conservative tracer in the \(N^{th}\) reactor is given in equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_C_N_CMFR}.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_C_N_CMFR}
\begin{split} \frac{C_{N} \left(t\right)\rlap{-} V }{M} =\frac{N^N}{\left(N-1\right)!} \left(\frac{t}{\theta} \right)^{N-1} {\mathop{e}\nolimits^{{}^{\left(\frac{-Nt}{\theta} \right)} }}\end{split}
\end{equation}
The non-dimensional form of equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_C_N_CMFR} is given in equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_N_CMFR}
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_N_CMFR}
\begin{split} {E_{N}}_{\left(t^{\star} \right)} = \frac{N^N}{\left(N-1\right)!} \left(t^{\star} \right)^{N-1} {\mathop{e}\nolimits^{{}^{\left(-Nt^{\star} \right)} }}\end{split}
\end{equation}
It can be shown that equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_AD} and \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_E_N_CMFR} converge for large N when
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:10}
\begin{split}Pe=2N\end{split}
\end{equation}
Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_C_N_CMFR} is limited to integer values of N. The model can be extended to include non-integer values of N if the factorial function (i.e., (N-1)!) were replaced with the \(\Gamma\) function. This extension is particularly beneficial when fitting data to the models because the \(\Gamma\) function is continuous.

Response curves for the advection-dispersion equation are shown in \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-n-2}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-n-2}}}. Notice that the effluent concentration begins to rise much more quickly in series CMFRs than in the advection-dispersion model for a single CMFR. This distinction between the two models lessens as the number of reactors increases and the \sphinxstyleemphasis{Pe} increases.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{E_F_N_2}.png}
\caption{Exit age (E) and cumulative exit age (F) curves for series CMFR with N of 2.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id7}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-e-f-n-2}}\end{figure}


\section{Reactor Studies}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:reactor-studies}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-studies}}
One of the easiest methods to determine the mixing (dispersion) characteristics of a reactor is to add a spike input of a conservative material and then monitor the concentration of the material in the reactor effluent. The equations below can be used to analyze the data and extract the mixing characteristics of the reactor. One of the challenges of using the equations below is that they require collecting data long enough to get all of the tracer. This is generally not practical and the tracer concentration measurements are challenging as the tracer approaches background levels or the measurement detection limit. For this laboratory exercise we will fit the acquired data to the models. We will collect until most of the tracer has left the reactor or approximately 2 hydraulic residence times.

The equations below are included for completeness with the caveat that they require collecting data until the tracer concentration is negligible.

The variance of tracer concentration versus time (\(\sigma _{t}^{2}\), with dimensions of time squared) can be measured by sampling at a single point in the reactor at many different times and can be computed using the following equations.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:11}
\begin{split}\sigma _{t}^{2} \; =\; \frac{\int _{0}^{\infty }C(t)(t-\bar{t})^{2}  dt}{\int _{0}^{\infty }C(t) dt} =\; \frac{\int _{0}^{\infty }t^{2} \cdot C(t) dt}{\int _{0}^{\infty }C(t) dt} -\; \bar{t}^{2}\end{split}
\end{equation}
where
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:12}
\begin{split}\bar{t}{\rm \; }={\rm \; }\frac{\int _{0}^{\infty }t\; C(t)dt }{\int _{0}^{\infty }C(t)dt }\end{split}
\end{equation}
For discrete data points:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma}
\begin{split} \sigma _{t}^{2} =\; \frac{\sum _{i=0}^{n}t_{i}^{2} \cdot C_{i}  \Delta t}{\sum _{i=0}^{n}C_{i}  \Delta t} -\; \bar{t}^{2}\end{split}
\end{equation}
and
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tbar}
\begin{split} \bar{t}=\; \frac{\sum _{i=0}^{n}t_{i} \cdot C_{i}  \Delta t}{\sum _{i=0}^{n}C_{i}  \Delta t}\end{split}
\end{equation}
Inlet and outlet boundary conditions affect the response obtained from a reactor. Closed reactors have little dispersion across their inlet and outlet boundaries whereas open reactors can have significant dispersion across their inlet and outlet boundaries. Typically open systems have no physical boundaries in the direction of flow. An example of an open system would be a river segment. Closed systems have small inlets and outlets that minimize dispersion across the inlet and outlet regions. An example of a closed system is a tank (or a lake) with a small inlet and outlet. The reactor used in the lab is closed. The \(\bar{t}\) in equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tbar} is the measured average residence time for the tracer in the reactor. For ideal closed reactors the measured residence time, \(\bar{t}\), is equal to the theoretical hydraulic residence time (\(\theta\) = reactor volume/flow rate). For open reactors \(\bar{t}\) can exceed the hydraulic residence time. If \(\bar{t}\) is less than the hydraulic residence time it may indicate that the reactor contains “dead volume” or “short circuiting” such that some volume of the reactor is effectively unused.

The above equations suggest that from the reactor response to a spike input we can compute the dispersion coefficient for the reactor. We have two options for measuring reactor response:
\begin{enumerate}
\item {} 
synoptic measurements: at a fixed time sampling many points along the axis of the reactor will yield a Gaussian curve of concentration vs. distance. In practice synoptic measurements are difficult because it requires sampling devices that are time-coordinated. By combining equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_dispersion}, \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma}, and \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_tbar} it is possible to estimate the dispersion coefficient from synoptic measurements.

\item {} 
single point sampling: measure the concentration at a fixed position along the x axis of the reactor for many times. If the reactor length is fixed at L and measurements are made at the effluent of the reactor (observe the concentration of a tracer at x = L as a function of time) then x is no longer a variable and C(x,t) becomes C(t) only. The response curve obtained through single point sampling is skewed. The curve spread changes during the sampling period and the response curve is skewed.

\end{enumerate}


\subsection{Peclet Number Estimation}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:peclet-number-estimation}}
For single point sampling of the effluent response curve, skew increases as the dispersion level in the reactor increases. The degree of skew depends on the dispersion coefficient, the velocity in the x-direction, and the length of the reactor. Peclet values in the range \(100\mathrm{<}Pe \mathrm{<} \mathrm{\infty}\) result in a symmetric response curve.

Response curve skew makes the assumption of a symmetrical normal distribution curve inappropriate and a new relationship between the variance and the dispersion coefficient (or \sphinxstyleemphasis{Pe}) has to be determined. Boundary conditions affect the determination of the dispersion coefficient. The relationship between the Peclet number and variance for open systems is given by
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open}
\begin{split} \sigma _{t}^{2} =\left(\frac{2}{Pe} +\frac{8}{Pe^{2} } \right)\cdot \theta ^{2}\end{split}
\end{equation}
For closed systems the relationship is:
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_closed}
\begin{split} \sigma _{t}^{2} =\left[\frac{2}{Pe} -\frac{2}{Pe^{2} } \cdot \left(1-{\mathop{e}\nolimits^{-Pe}} \right)\right]\cdot \theta ^{2}\end{split}
\end{equation}
The term \(\frac{2}{Pe}\) in equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open} and \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open} is dominant for Peclet numbers much greater than 10 as is shown in \hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pe-open-and-closed}]{Fig.\@ \ref{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pe-open-and-closed}}}. The additional terms in equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open} and \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open} are corrections for skewedness in the response curve. These skewedness corrections are not very significant for Peclet numbers greater than 10. Thus for Peclet numbers greater than 10 the Peclet number can be determined using equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_approx} for both open and closed systems.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Pe_open_and_closed}.png}
\caption{Relationship between equations \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open} through \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_open}.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id8}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-pe-open-and-closed}}\end{figure}
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_sigma_approx}
\begin{split} Pe=\frac{2\theta ^{2} }{\sigma _{t}^{2} }\end{split}
\end{equation}

\subsection{Mass Conservation}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:mass-conservation}}
When a pulse of conservative tracer is added to a continuous flow reactor, all of the tracer is expected to leave the reactor eventually. The mass of a substance that has left the reactor is given in equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Mout}.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Mout}
\begin{split} M_{out} =\sum _{i=0}^{n}QC_{i} \Delta t_{i}\end{split}
\end{equation}
where Q is the flow rate and M is the mass of any substance whose concentration is given by C. If Q and \(\mathrm{\Delta}t\) are constant, then equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Mout} can be rewritten as
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Mout_constantQ}
\begin{split} M_{out} =Q\Delta t\sum _{i=0}^{n}C_{i}\end{split}
\end{equation}
Equation \eqref{equation:Reactor_Characteristics/Reactor_Characteristics:eq_Reactor_Mout_constantQ} can be used to determine if all of the tracer was measured in the reactor effluent. Alternately, mass conservation can be checked by plotting the F curve and checking if the plot approaches \#. If some of the tracer is in the reactor at the end of the experiment then the following equation can be used to test for mass closure.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:13}
\begin{split}M_{in} =M_{out} +\Delta M_{stored}\end{split}
\end{equation}

\section{Tracers}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:tracers}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-tracers}}
A conservative tracer will be used to characterize your reactors. Typical tracers include salt and various dyes. For this experiment we will use \#40 Red Dye as the conservative tracer. The red dye concentration will be measured using an optical spectrophotometric probe. The linear range of operation for the probes is from about 0.01 mg/L to 30 mg/L. We will add an amount of red dye near the high end of this range to acquire a dataset that spans multiple orders of magnitude.

Additional constraints for the tracer are that if a highly concentrated tracer is used, then there will be a significant density difference between the tracer and the water in the reactor. If a very dilute tracer is used then a large volume of tracer will need to be added and the volume of tracer could become a large fraction of the reactor volume and thus the pulse could no longer be modeled as having negligible volume.

The reactors are 30 cm long and 15 cm wide. If the depth is limited to (a maximum of) 5 cm, then the total volume is 2.25 L and with a peristaltic pumping rate of approximately 380 mL/min, the residence time is approximately 6 minutes.

The tracer should be added directly by pipette into the first chamber of your reactor. The red dye will also make it possible to qualitatively observe the advective and dispersive transport in the reactors.


\subsection{Mass balance}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:mass-balance}}
Collect data that makes it possible to perform a mass balance on red dye. Note that if it is expedient to shorten an experimental run such that there is a significant quantity of the tracer residual in the reactor, that the mass of the residual (stored) tracer can be measured by pouring the reactor contents into a container and measuring the mass or volume of the mixture. The concentration of red dye in the mixture can be measured be connecting back to the optical probe.


\section{Setting up the reactor for experiments}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:setting-up-the-reactor-for-experiments}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-setting-up-the-reactor-for-experiments}}
See the section on {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-photometer}]{\sphinxcrossref{\DUrole{std,std-ref}{calibrate photometer}}}} to set up the photometer. We recommend using the syringe method to pull calibration standards into the photometer. Suggested standards are 0, 10, 20, 30, 40, 50 mg/L of red dye \#40.

In these experiments, we will be pumping tap water from a 20 L Jerrican to the influent of your reactor. Place your reactor on a stir plate and make sure that the 3/8’’ push-connect fitting is on the effluent side of your reactor (some may have 3/8’’ holes on both sides). The effluent of the reactor should be a straight short tube to the drain.

Use a second pump head with \#17 tubing to pull a sample from near the effluent weir through the photometer and then to the drain.

Before running an experiment, it is important to determine whether your setup works. Turn the pump to approximately 380 mL/min (100 rpm) and get water flowing through the system and off to waste. Two important things to check:
\begin{enumerate}
\item {} 
Is your sensor reading a stable voltage of approximately +3.5V? If not, you might have some air bubbles trapped in the sensor cell. Tap it gently to release the air.

\item {} 
Is the effluent weir working properly or is the reactor gaining volume? We want to maintain a constant volume throughout the experiment, so let the pump run for ten minutes or so and confirm that the volume is stable (put a line or a piece of tape to mark the water level).

\end{enumerate}


\section{Testing protocol}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:testing-protocol}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-testing-protocol}}
To ensure that everything is working properly I recommend that you begin by first testing a CMFR. Use the CMFR data to verify that you obtain mass balance and that you obtain the expected exit age response.

For each test make sure that you accurately measure the reactor volume, residual reactor red dye concentration, and the flow rate. The reactor volume can be approximated by taking the mass of the reactor, as you did to estimate the volume of your lakes.  Measure the residual concentration of red dye in the reactor by measuring the completely mixed concentration (this is just the concentration at the end of the experiment for the CMFR, but you will have to remove the baffles and mix for the baffled reactors). The flow rate can be accurately determined by measuring the volume of a timed sample from the pump.
\begin{enumerate}
\item {} 
Configure ProCoDA so that it is both monitoring the photometer voltage AND monitoring the photometer concentration. You can do this by selecting the same data source twice in the list of sensors. Calibrate one of them using the photometer calibration and leave the other one uncalibrated as volts. This will make it possible to do a post experiment recalibration of the photometer if necessary.

\item {} 
Log data to file so that you have a record of the red dye concentration (and photometer volts) in the effluent of the reactor as a function of time.

\item {} 
Prepare to save a text note into the data file indicating the exact moment when you will actually start the experiment.

\item {} 
Add a volume of red dye \#40 stock that will give a maximum concentration of \sphinxstyleemphasis{approximately} 30 mg/L near the influent of the reactor. Immediately enter the text note to record when the experiment began. For the CMFR you can easily calculate this. For other reactors you may need to try and if necessary repeat the experiment if the tracer concentration goes above the 50 mg/L or if the maximum tracer concentration is below 10 mg/L.

\item {} 
Collect data until the majority of the tracer has exited.

\item {} 
Stop the experiment and pour the contents of the reactor into a container. Weigh the container to determine the exact volume of the reactor.

\item {} 
Sample the contents of the mixed reactor with the photometer to obtain the average concentration in the reactor at the end of your experiment. This will enable you to do a mass balance on the red dye.

\end{enumerate}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Reactor_photo_front}.png}
\caption{Front view of the reactor setup. The smaller diameter peristaltic pump tubing is used to continuously sample from the reactor right next to the reactor effluent.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id9}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-reactor-photo-front}}\end{figure}

The reactor setup is designed to maintain a constant depth in the tank with an overflow weir. The second pump channel is used to sample the effluent through the photometer without sending air bubbles into the photometer.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Reactor_photo_top}.png}
\caption{Top view of the reactor setup.}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id10}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:figure-reactor-photo-top}}\end{figure}


\section{Reactor Design}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:reactor-design}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-design}}

\subsection{Baffle Design}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:baffle-design}}
Baffles can be added to tanks to decrease the ability of the solution to travel quickly from the tank inlet to the tank outlet. The goal of the baffle design depends on whether the tank is designed for a reaction or for separation. The baffles in reactors should generally be designed to achieve mixing in each of the baffled zones. The baffles in tanks designed for separation (clarifiers) should be designed to achieve uniform flow (a much more difficult goal to achieve). Mixing within each baffled zone could be achieved with a propeller mixer or by appropriately sized pores in the baffles. If pore mixing is desired the energy for mixing is provided by the kinetic energy of the fluid flowing through the pores.

The flow characteristics of a baffled tank are complex and would require computational fluid dynamics (CFD) to model. In lieu of developing a CFD model we will turn to dimensional analysis to help us characterize the mixing efficiency of a baffled reactor segment. The independent parameter that we will measure to characterize the reactor is its Peclet number or the number of N CMFRs in series.

The design goal is to determine the diameter and spacing of the pores required to achieve adequate mixing. The fluid flow out of the pores is jet flow. The jets entrain and mix with the surrounding fluid. To develop effective mixing the jet should be turbulent. The transition between turbulent and laminar behavior for jets occurs at a jet Reynolds number of a few hundred (Personal communication with Dr. Cowen).
\begin{align}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:14}\!\begin{aligned}
Re_{jet} =\frac{V_{jet} d_{jet} }{\nu }\\
Re_{jet} =\frac{4Q_{jet} }{\pi d_{jet} \nu }\\
Re_{jet} =\frac{4Q_{reactor} }{n_{ports} \pi d_{jet} \nu }\\
\end{aligned}\end{align}
The optimal pore spacing for maximum mixing could be based on the spread of the jet in the distance to the next baffle.  Jets expand in the radial direction at a rate of approximately 10\% of the distance the jet travels axially. Thus the pore spacing could be in a rectangular grid with the distance between pores equal to 10\% of the distance between baffles. This spacing may be smaller than practical since it will require a large number of pores.

An additional constraint on pore design is that the head loss through the pores not be excessive. The hydraulic grade line (and thus depth of each baffled reactor) will drop by a distance equal to the head loss through the pores. The head loss through the pores is given by the orifice equation
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:15}
\begin{split}Q_{orifice} =K_{orifice} A_{orifice} \sqrt{2g\Delta h}\end{split}
\end{equation}
where the orifice coefficient, \(K_{orifice}\), has a value of approximately 0.6, the area of the orifice is \(A_{orifice}\), and the head loss through the orifice is \(\Delta h\).
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:16}
\begin{split}Q_{orifice} =K_{orifice} \frac{\pi d_{orifice}^{2} }{4} \sqrt{2g\Delta h}\end{split}
\end{equation}\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:17}
\begin{split}Q_{reactor} =n_{orifice} K_{orifice} \frac{\pi d_{orifice}^{2} }{4} \sqrt{2g\Delta h}\end{split}
\end{equation}
where \(n_{orifice}\) is the number of pores. Solving for the pore diameter we obtain.
\begin{equation}\label{equation:Reactor_Characteristics/Reactor_Characteristics:Reactor_Characteristics/Reactor_Characteristics:18}
\begin{split}d_{orifice} =\sqrt{\frac{4Q_{reactor} }{\pi n_{orifice} K_{orifice} \sqrt{2g\Delta h} } }\end{split}
\end{equation}

\subsection{Chlorine Contact Tank Design}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:chlorine-contact-tank-design}}
The design objective for chlorine contact tanks is to maximize the inactivation of pathogens by maximizing the contact time between the chlorine and the pathogens before the water is sent to the distribution system. This objective has been codified by the EPA with the contact time for a tank defined as the time for the effluent of the tank to reach 10\% of the influent value after a step change in the influent.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Comparison of \(t^{\star}\) at F=0.1 for non-ideal reactors (Malcolm Pirnie, 1991).}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:id11}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:table-reactor-baffling}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{60}|\X{20}{60}|\X{20}{60}|}
\hline
\sphinxstyletheadfamily 
Baffling Condition
&\sphinxstyletheadfamily 
Guidance manual value of \(t^{star}\) at F=0.1
&\sphinxstyletheadfamily 
Extent of Baffles
\\
\hline
Unbaffled (CMFR)
&
0.1
&
No baffles, agitated basin with low length to width ratio, high inlet and outlet flow velocities
\\
\hline
Poorly baffled
&
0.3
&
Single or multiple unbaffled inlets and outlets, no intrabasin baffles
\\
\hline
Average
&
0.5
&
Baffled inlet or outlet with some intrabasin baffles
\\
\hline
Superior
&
0.7
&
Perforated inlet baffles, serpentine or perforated intrabasin baffles, outlet weir or perforated launders
\\
\hline
Perfect (PFR)
&
1.0
&
Very high length to width ratio (pipeline flow), perforated inlet, outlet and intrabasin baffles
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{Procedures}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:procedures}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-procedures}}
The reactor you will be working with can be easily modified by installing various configurations of perforated or staggered baffles. Your objectives are
\begin{enumerate}
\item {} 
to modify the reactor to obtain a maximum value of \(t^{\star}\) at F = 0.1.

\item {} 
to document your progress toward this goal by obtaining appropriate experimental data

\item {} 
to compare your experimental data with appropriate models

\end{enumerate}

Note that you are allowed to collaborate with other teams to obtain the results from additional tests. All data sharing must be documented in your report.


\subsection{Baffle installation}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:baffle-installation}}
Install the baffles so that each compartment has the same volume. If desired the gap between the baffles and the reactor walls can be sealed using duct tape.


\section{Prelab Questions}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:prelab-questions}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-pre-laboratory-questions}}\begin{enumerate}
\item {} 
Calculate the change in hydraulic grade line between baffled sections of a reactor with a flow rate of 380 mL/min. The reactor baffles are perforated with 6 holes 1 mm in diameter. Is the flow through these orifices in series or in parallel? Do you multiply the head loss for one orifice by the number of orifices to get the total head loss? Are the orifices in parallel or in series? \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/core/physchem.py}{Use the pc.head\_orifice} function to calculate the head loss through an orifice. The \sphinxstyleemphasis{vena contracta} for the orifice can be found at \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/core/constants.py}{aguaclara.core.constants.VC\_ORIFICE\_RATIO}. Why would 6 holes 1 mm in diameter not be a good design for this reactor?

\item {} 
On a single graph plot the exit age distribution (\(E_{(t\star)}\)) for a reactor that operates as a 1-dimensional advection-dispersion reactor with Peclet numbers of 1, 10, and 100 (there will be three plots on the graph and thus a legend is required). The x-axis should be \(t^\star\) from 0.0 to 3.0. Comment on the shapes of the curves as a function of the Peclet number. Note that the advective dispersion equation is undefined for \(t\star = 0\). Use the \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/environmental\_processes\_analysis.py}{epa.E\_Advective\_Dispersion(t,Pe)} function.

\end{enumerate}


\section{Data Analysis}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:data-analysis}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-data-analysis}}
You will analyze all of the datasets in the same way. Use a consistent set of units throughout your data analysis and include the units in your python code and discussion!
\begin{enumerate}
\item {} 
Use multivariable nonlinear regression to obtain the best fit between the experimental data and the two models by minimizing the sum of the squared errors. Use \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/environmental\_processes\_analysis.py}{epa.Solver\_AD\_Pe and epa.Solver\_CMFR\_N}. These functions will minimize the error by varying the values of average residence time, (mass of tracer/reactor volume), and either the number of CMFR in series or the Peclet number.

\item {} 
Generate a plot showing the experimental data as points and the model results as thin lines for each of your experiments. Explain which model fits best and discuss those results based on your expectations.

\item {} 
Compare the trends in the estimated values of N and Pe across your set of experiments. How did your chosen reactor modifications effect dispersion?

\item {} 
Report the values of \(t^{\star}\) at F = 0.1 for each of your experiments. Do they meet your expectations?

\item {} 
Evaluate whether there is any evidence of “dead volumes” or “short circuiting” in your reactor.

\item {} 
Make a recommendation for the design of a full scale chlorine contact tank. As part of your recommendation discuss the parameter you chose to vary as part of your experimentation and what the optimal value was determined to be.

\end{enumerate}


\section{References}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:references}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-references}}
Weber, W. J. J. and F. A. Digiano. 1996. Process Dynamics in Environmental Systems. New York, John Wiley \& Sons, Inc.

Malcolm Pirnie, Inc., and HDR Engineering, Inc. Guidance Manual for Compliance with the Filtration and Disinfection Requirements for Public Water Systems Using Surface Water Sources. AWWA, Denver CO, 1991.


\section{Lab Prep Notes}
\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:lab-prep-notes}}\label{\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-lab-prep-notes}}\begin{enumerate}
\item {} 
Create 100 mL of 100 g/L red dye stock (thus use 10 g of red dye) and distribute in small vials to each lab bench.

\item {} 
Use \# 18 tubing for inlet and \#17 for photometer sampling.

\item {} 
Organize team research so they don’t use the same materials and so they answer different questions.

\end{enumerate}


\chapter{Adsorption}
\label{\detokenize{Adsorption/Adsorption:adsorption}}\label{\detokenize{Adsorption/Adsorption:title-adsorption}}\label{\detokenize{Adsorption/Adsorption::doc}}
Water is sometimes called the universal solvent and that property has both positive and negative aspects. On the positive side, water’s ability to serve as a carrier for many compounds is essential for life. On the negative side that same ability can result in water carrying substances that are harmful to life. Environmental engineers often have the challenge of removing harmful dissolved species from water. This task shows up when we are producing safe drinking water from a ground water source that is contaminated with arsenic, fluoride, nitrate, or atrazine. Surface water sources can be contaminated with naturally organic matter that interacts with disinfectants to produce toxic by products. Wastewater reuse requires removal of a long list of dissolved species that would otherwise accumulate. Dyeing of clothing produces an industrial waste water contaminated with high concentrations of dissolved dyes. As we develop improved analytical techniques we realize that many of the substances that we use including caffeine, cocaine, pharmaceuticals, herbicides, and pesticides are present in the environment.

Our strategies for removing dissolved species are limited to stopping the manufacture and use of the harmful compounds, encouraging reactions to transform the compounds into less harmful products, or removing the compounds from water. Of course, removing the compounds from water requires that we put the compounds somewhere else. We can either concentrate the compounds in water (reverse osmosis) or transfer the compounds into a gas (air stripping) or solid phase (adsorption).

Adsorption to a solid phase is commonly used in drinking water treatment plants. Aluminum and iron hydroxide coagulant nanoparticles are used for flocculation because they are sticky and readily attach to suspended particles. The coagulant nanoparticles also adsorb many dissolves species including naturally occurring dissolved organics. The coagulant nanoparticles are then concentrated in the solid phase of the sludge produced by water treatment plants. Activated carbon is also used in drinking water treatment to transfer dissolved species to the solid phase. This laboratory experiment will give us an opportunity to learn about the removal of dissolved species through adsorption to a solid phase.


\section{Objectives}
\label{\detokenize{Adsorption/Adsorption:objectives}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-objectives}}
The objectives of this experiment are to:
\begin{enumerate}
\item {} 
Investigate the breakthrough characteristics of red dye \#40 on activated carbon or on coagulant nanoparticles in a continuous-flow carbon contactor at a range of concentrations.

\item {} 
Determine the equilibrium partitioning of red dye \#40 on activated carbon or on coagulant nanoparticles

\end{enumerate}


\section{Background}
\label{\detokenize{Adsorption/Adsorption:background}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-background}}
Adsorption is a unit operation in which surface-active materials in true solution are removed from the solvent by interphase transfer to the surface of an adsorbent particle. This process is employed in environmental engineering practice for removal of various pollutants such as soluble organics, dyes, pesticides, humic substances, etc., from wastewaters and for removal of color, taste, and odor-producing compounds from natural waters that are to be used as potable water supplies. Adsorption onto granular activated carbon (GAC) also finds wide application in the remediation of groundwater contaminated with volatile and nonvolatile organic pollutants.

Under isothermal conditions the equilibrium partitioning between solution and solid phase is a function of concentration. In this experiment the partitioning will be analyzed using both Freundlich
\begin{equation}\label{equation:Adsorption/Adsorption:Freundlich}
\begin{split} q =K_f C^{\frac{1}{n}}\end{split}
\end{equation}
and Langmuir partitioning models.
\begin{equation}\label{equation:Adsorption/Adsorption:Langmuir}
\begin{split} q =\frac{K_{Lang}q_{\max} C}{1+K_{Lang}C}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where
\item[] \(q\) is the mass of adsorbate (species being removed from solution) per mass of adsorbent (solid phase)
\item[] \(C\) is the concentration of the adsorbate in water
\item[] \(K_f\) and \(n\) are the Freundlich empirical constants describing the partitioning
\item[] \(K_{Lang}\) and \(q_{\max}\) are the Langmuir empirical constants describing the partitioning
\end{DUlineblock}

We will preload columns of sand (or glass beads) with the adsorbent and then pump a solution of red dye \#40 through the column. We will measure the effluent concentration of the dye as a function of time using a photometer. In these experiments the column of sand is inert, but provides a mechanism to hold the adsorbent stationary (fixed bed) while the red dye solution flows through. The red dye will adsorb to the adsorbent and the effluent red dye concentration is expected to be very low for some time. Red dye will begin breaking through once the majority of the adsorbent reaches equilibrium with the influent concentration of the red dye.

In this analysis we are neglecting several aspects of the adsorption process. We assume that the time required to reach equilibrium partitioning is very small relative to the hydraulic residence time, \(\theta_{HRT}\), of the column. This assumption requires that both liquid phase and solid phase adsorbate mass transport mechanisms are relatively fast. Transport within the solid phase matrix of an activated carbon granule is by the slow process of diffusion. Thus we expect diffusion to increase the time required to reach equilibrium for adsorbents that require diffusion over longer distances. Diffusion time will be greatest for Large diameter granular activated carbon, less for powdered activated carbon, and very fast for coagulant nanoparticles.

The mass of the adsorbate in the column adsorbed to the adsorbent at breakthrough is given by
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:0}
\begin{split}M_{adsorbate} = M_{adsorbent} q_{0}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where
\item[] \(M_{adsorbent}\) is the mass of the adsorbent in the column
\item[] \(M_{adsorbate}\) is the mass of the adsorbate in the column adsorbed to the adsorbent
\end{DUlineblock}

The mass transfer zone travels at velocity \(v_{mtz}\) through the fixed bed as the absorbent slowly fills to the equilibrium density, \(q_0\), based on the influent concentration, \(C_0\).

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/ziLug9EEwM4}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{MTZ}.png}}\caption{Movie illustrating how the effluent concentration of the absorbate changes with time as the mass transfer zone moves through the fixed bed.}\label{\detokenize{Adsorption/Adsorption:id1}}\label{\detokenize{Adsorption/Adsorption:figure-mass-transport-zone}}\end{figure}

The velocity of the mass transfer zone (mtz or the adsorption front) can be obtained by a mass balance on the system. If we set our frame of reference (and our control volume) to be centered on the mass transfer zone, then the average velocity (over the pore fraction of the control surface) of fluid entering the mtz is equal to pore water velocity minus the velocity of the mtz. The fluid phase concentration of the adsorbate entering the control surface is \(C_0\) and the fraction of the control surface where fluid is passing through is the porosity, \(\phi\).

The average velocity of the solid phase exiting through the control surface is \(-v_{mtz}\). The bulk density of the adsorbate is \(\frac{q_0 M_{adsorbent}}{V_{column}}\). The mass rate of adsorbate passing through the control surface in liquid phase must precisely balance the mass rate of adsorbate passing through the control surface in the solid phase because the mtz is stationary.
\begin{equation}\label{equation:Adsorption/Adsorption:eq_mtz_cs_1}
\begin{split} [(v_{pore} - v_{mtz})C_0\phi] - \left[v_{mtz}\frac{q_0 M_{adsorbent}}{V_{column}}\right] = 0\end{split}
\end{equation}
We can apply continuity to find the relationship between the velocity in the pores and velocity above the porous fixed bed. The plan view area of the fixed bed cancels out.
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:1}
\begin{split}\phi v_{pore} = v_a\end{split}
\end{equation}
The effective bed porosity, \(\phi\) can be calculated from
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:2}
\begin{split}\phi =1 - \frac{\frac{M_{ac}}{\rho_{ac}} + \frac{M_{sand}}{\rho_{sand}}}{V_{column}}\end{split}
\end{equation}
where
\begin{quote}

\begin{DUlineblock}{0em}
\item[] \(\rho_{ac}  =  2.1 g/cm^3\)
\item[] \(\rho_{sand} = 2.65 g/cm^3\)
\end{DUlineblock}
\end{quote}

Eliminate \(v_{pore}\) from the equation \eqref{equation:Adsorption/Adsorption:eq_mtz_cs_1} we obtain:
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:3}
\begin{split}(v_a C_0 - v_{mtz}C_0\phi) - \left[v_{mtz}\frac{q_0 M_{adsorbent}}{V_{column}}\right] = 0\end{split}
\end{equation}
Now solve for \(v_{mtz}\).
\begin{equation}\label{equation:Adsorption/Adsorption:eq_Adsorb_v_mtz}
\begin{split} v_{mtz}=\frac{v_a C_0}{C_0\phi + \frac{q_0 M_{adsorbent}}{V_{column}}}\end{split}
\end{equation}
In equation \eqref{equation:Adsorption/Adsorption:eq_Adsorb_v_mtz} the term \(C_0\phi\) represents the liquid phase mass of the adsorbate per unit volume of the fixed bed and the term \(\frac{q_0 M_{adsorbent}}{V_{column}}\) represents the solid phase mass of the adsorbate per unit volume of the fixed bed. The second term dominates for fixed bed adsorption reactors that are effective.

The time until breakthrough can be obtained by dividing the length of the adsorption column (\(L_{column}\)) by the velocity of the mtz (equation \eqref{equation:Adsorption/Adsorption:eq_Adsorb_v_mtz})
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:4}
\begin{split}\frac{L_{column}}{v_{mtz}} = \frac{L_{column}\phi}{v_a} + \frac{L_{column}q_0 M_{adsorbent}}{v_a C_0 V_{column}}\end{split}
\end{equation}
The equation above is equivalent to
\begin{equation}\label{equation:Adsorption/Adsorption:Adsorption/Adsorption:5}
\begin{split}t_{mtz} = t_{water} + t_{ads}\end{split}
\end{equation}
Thus the time to breakthrough is the time required for water to flow through the reactor plus the additional time required due to the adsorption process. The retardation factor is defined as the ratio of the time for the mass transfer zone to travel through the bed divided by the time for water to travel through the bed.
\begin{equation}\label{equation:Adsorption/Adsorption:eq_R_adsorption_tmz}
\begin{split}R_{adsorption} = \frac{t_{mtz}}{t_{water}} = \frac{v_{pore}}{v_{mtz}} = \frac{v_a}{\phi v_{mtz}}\end{split}
\end{equation}
Substituting equation \eqref{equation:Adsorption/Adsorption:eq_Adsorb_v_mtz} into equation \eqref{equation:Adsorption/Adsorption:eq_R_adsorption} we obtain:
\begin{equation}\label{equation:Adsorption/Adsorption:eq_R_adsorption}
\begin{split} R_{adsorption} =1+ \frac{q_0 M_{adsorbent}}{C_0 \phi V_{column}}\end{split}
\end{equation}
Experimentally we can estimate \(R_{adsorption}\) based on the time required to reach 50\% of the influent adsorbate for columns with and without adsorbent. Given the estimate of \(R_{adsorption}\) we can estimate the mass of adsorbate per mass of adsorbent,  \(q_0\).
\begin{equation}\label{equation:Adsorption/Adsorption:eq_q_0}
\begin{split} q_0 = \left(R_{adsorption} - 1\right) \frac{C_0 \phi V_{column}}{M_{adsorbent}}\end{split}
\end{equation}
From experiments conducted in the Cornell environmental laboratory around 2003 we have  \(q_{50 mg/L}\) = 0.08. Our goal is to design a fixed bed reactor that has a \(t_{mtz}\) of about 30 minutes. With a 15 cm deep column at 1 mm/s and with a porosity of 0.4 the hydraulic residence time is 1 minute. Given a target retardation factor of 30 we can calculate the mass of carbon that we should have in the column. We can achieve this mass of carbon while holding the length of the column constant by diluting the activated carbon with sand.

The approach velocity for granular activated carbon contactors is generally between 1.4 and 4.2 mm/s. We will operate at 1 mm/s.
\begin{equation}\label{equation:Adsorption/Adsorption:eq_M_ac}
\begin{split} M_{adsorbent} = \left(R_{adsorption} - 1\right) \frac{C_0 \phi V_{column}}{q_0}\end{split}
\end{equation}
Different teams can try different masses of activated carbon or could experiment with filling the sand pores with coagulant as an alternative adsorbent.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{n}{v\PYGZus{}a} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{porosity} \PYG{o}{=} \PYG{l+m+mf}{0.4}
\PYG{n}{L\PYGZus{}column} \PYG{o}{=} \PYG{l+m+mf}{15.2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{D\PYGZus{}column} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{n}{A\PYGZus{}column} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{D\PYGZus{}column}\PYG{p}{)}
\PYG{n}{V\PYGZus{}column} \PYG{o}{=} \PYG{n}{A\PYGZus{}column} \PYG{o}{*} \PYG{n}{L\PYGZus{}column}
\PYG{n}{C\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{q\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mf}{0.08}
\PYG{n}{t\PYGZus{}water} \PYG{o}{=} \PYG{p}{(}\PYG{n}{L\PYGZus{}column}\PYG{o}{*}\PYG{n}{porosity}\PYG{o}{/}\PYG{n}{v\PYGZus{}a}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{t\PYGZus{}mtz\PYGZus{}target} \PYG{o}{=} \PYG{l+m+mi}{1800}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{c+c1}{\PYGZsh{} set the breakthrough time to 30 minutes = 1800 s}
\PYG{n}{R\PYGZus{}adsorption} \PYG{o}{=} \PYG{n}{t\PYGZus{}mtz\PYGZus{}target}\PYG{o}{/}\PYG{n}{t\PYGZus{}water}
\PYG{n}{M\PYGZus{}ac} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{R\PYGZus{}adsorption}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{C\PYGZus{}0}\PYG{o}{*}\PYG{n}{porosity}\PYG{o}{*}\PYG{n}{V\PYGZus{}column}\PYG{o}{/}\PYG{n}{q\PYGZus{}0}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The mass of activated carbon given the dilution with sand should be}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{M\PYGZus{}ac}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Density\PYGZus{}AC} \PYG{o}{=} \PYG{l+m+mi}{2100} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}We measured the bulk density in the lab}
\PYG{n}{Density\PYGZus{}bulk\PYGZus{}AC} \PYG{o}{=} \PYG{l+m+mi}{386} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{V\PYGZus{}carbon} \PYG{o}{=} \PYG{p}{(}\PYG{n}{M\PYGZus{}ac}\PYG{o}{/}\PYG{n}{Density\PYGZus{}bulk\PYGZus{}AC}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume of activated carbon is approximately}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{V\PYGZus{}carbon}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{density\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mi}{2650} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{M\PYGZus{}sand} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}column}\PYG{o}{\PYGZhy{}}\PYG{n}{V\PYGZus{}carbon}\PYG{p}{)}\PYG{o}{*}\PYG{n}{density\PYGZus{}sand}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{porosity}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The mass of sand is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{M\PYGZus{}sand}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{V\PYGZus{}reddye} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{n}{A\PYGZus{}column}\PYG{o}{*}\PYG{n}{t\PYGZus{}mtz\PYGZus{}target}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume of red dye required for one experiment is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{V\PYGZus{}reddye}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Q\PYGZus{}reddye} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{n}{A\PYGZus{}column}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{Q\PYGZus{}reddye}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{mLperrev\PYGZus{}Tubing\PYGZus{}17} \PYG{o}{=} \PYG{l+m+mf}{2.8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{revolution}
\PYG{n}{Pump\PYGZus{}rpm} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q\PYGZus{}reddye}\PYG{o}{/}\PYG{n}{mLperrev\PYGZus{}Tubing\PYGZus{}17}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{revolution}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The pump rpm is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{Pump\PYGZus{}rpm}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Contactor Procedures}
\label{\detokenize{Adsorption/Adsorption:contactor-procedures}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-contactor-procedures}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{New_Schematic}.png}
\caption{Proposed design of the carbon column and feed system.}\label{\detokenize{Adsorption/Adsorption:id2}}\label{\detokenize{Adsorption/Adsorption:figure-ac-schematic}}\end{figure}


\subsection{Carbon Contactor Setup}
\label{\detokenize{Adsorption/Adsorption:carbon-contactor-setup}}
Assemble the system shown in \hyperref[\detokenize{Adsorption/Adsorption:figure-ac-schematic}]{Fig.\@ \ref{\detokenize{Adsorption/Adsorption:figure-ac-schematic}}}. Use a peristaltic pump with \#17 tubing at approximately 10 rpm. Prepare 20 L jerricans with 50 mg/L of Red dye \#40. Use reverse osmosis water to dilute the dye. The carbon contactor will be operated in down flow mode. The specifications for the carbon contactors are given in Table \hyperref[\detokenize{Adsorption/Adsorption:table-carbon-contactor-settings}]{Table \ref{\detokenize{Adsorption/Adsorption:table-carbon-contactor-settings}}}.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Carbon contactor settings.}\label{\detokenize{Adsorption/Adsorption:id3}}\label{\detokenize{Adsorption/Adsorption:table-carbon-contactor-settings}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{40}|\X{20}{40}|}
\hline
\sphinxstyletheadfamily 
Parameter
&\sphinxstyletheadfamily 
Value
\\
\hline
Influent red dye Concentration
&
0.050  g/L
\\
\hline
Mass of red dye/20 L
&
1.00 g
\\
\hline
Depth of fixed bed
&
15 cm
\\
\hline
Mass of sand
&
120 g (to fill column)
\\
\hline
Approach velocity (1 mm/s)
&\\
\hline
Column diameter
&
2.54 cm
\\
\hline
\(q_{(50 mg/L)}\)
&
0.080  g/g
\\
\hline
Mass of carbon
&
5, 10, 15, 20  g
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Set up the Contactor}
\label{\detokenize{Adsorption/Adsorption:set-up-the-contactor}}
Work through this procedure twice. For the first test skip the activated carbon and thus measure the F curve (see {\hyperref[\detokenize{Reactor_Characteristics/Reactor_Characteristics:heading-reactor-modeling}]{\sphinxcrossref{\DUrole{std,std-ref}{reactor modeling}}}}) for the sand column. Rinse the column with RO water, remove the sand, and repeat the procedure with a mixture of activated carbon and sand (see Table \hyperref[\detokenize{Adsorption/Adsorption:table-carbon-contactor-settings}]{Table \ref{\detokenize{Adsorption/Adsorption:table-carbon-contactor-settings}}}).
\begin{quote}
\begin{enumerate}
\item {} 
Test column and pump and all tubing to ensure that it is leak tight using reverse osmosis water.

\item {} 
Remove top from column

\item {} 
Mix sand and adsorbent (total volume of media adjusted to fill column)

\item {} 
Wet method

\end{enumerate}
\begin{enumerate}
\item {} 
Pour mixture of sand and adsorbent into a beaker containing reverse osmosis water (or tap water if using coagulant).

\item {} 
Swirl until most of the air is released.

\item {} 
Use a funnel and a reverse osmosis water wash bottle to wash the mixture from the beaker into the column.

\item {} 
Use a 50 mL syringe to remove excess water from the top of the column if necessary.

\item {} 
Use a long rod to gently stir activated carbon to help release air bubbles.

\item {} 
Assemble the column end fitting.

\end{enumerate}
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Dry method

\end{enumerate}
\begin{enumerate}
\item {} 
Use a funnel to pour dry mixture of sand and activated carbon into the column

\item {} 
Assemble the column end fitting.

\item {} 
Fill the column with water in up flow mode (at 5 mL/min - idea is to do this slowly so that air escapes)

\end{enumerate}
\begin{enumerate}
\setcounter{enumi}{4}
\item {} 
In up flow mode (at 0.5 mL/s), discharge the column effluent to waste until most of the fines are removed.

\item {} 
The turn both directional valves directly on top and bottom of filter perpendicular so that no water goes in or out

\item {} 
put the bottom directional valve in down flow mode, disconnect the top connection

\item {} 
Run the pump to remove air out of this line

\item {} 
After air is removed, reconnect the tubing and run DI water in down flow mode. There may be a small air bubble left. You can put the filter in up flow mode again to remove that air bubble.

\item {} 
Next, run in down flow mode again and make sure to get all of the air out of the photometer.

\item {} 
Verify that the photometer is reading approximately 0 mg/L of red dye. This indicates that most of the activated carbon fines are removed from the column.

\item {} 
Configure ProCoDA to log the concentration of red dye at 5 second intervals

\item {} 
Start pumping Red Dye \#40.

\item {} 
Measure the flow rate using a balance to get mass of water in approximately 1 minute.

\item {} 
It is impractical to try and achieve \(C/C_0 = 1\), but run long enough to attain at least \(C/C_0 = 0.6\).

\end{enumerate}
\end{quote}


\subsection{Troubleshooting and Reflections}
\label{\detokenize{Adsorption/Adsorption:troubleshooting-and-reflections}}
Spring 2019 is the first time that we are including this experiment. There are always multiple challenges associated with developing a new laboratory experiment and in this case it is possible to anticipate several potential problems with this experimental design.
\begin{enumerate}
\item {} 
Air bubbles! Air in the sand column or in the photometer will result in failure. Surface tension makes it difficult to remove the air bubbles from the activated carbon. The methods may need to be modified if air causes problems.

\item {} 
Mass transport of the red dye into the activated carbon pores is slow because it is a diffusion process. It is possible that this will result in premature breakthrough of red dye long before the activated carbon reaches equilibrium with the influent concentration of red dye.

\item {} 
The relatively small amount of activated carbon in the sand column may result in inefficient transport of the red dye to the activated carbon granules. This would also result in inefficient removal of red dye.

\end{enumerate}

An alternative to granular activated carbon is Poly aluminum chloride (PACl - not to be confused with Powdered Activated Carbon or PAC). PACl will remove red dye by adsorption and given that PACl forms nanoparticles (rather than millimeter sized granules for GAC) it is possible that the mass transport of red dye to PACl will be much faster than mass transport of red dye to GAC. This could be tested by substituting PACl for GAC in the column. We would need to develop a method to deliver the PACl flocs to the sand column.


\subsection{Contactor Results and Analysis}
\label{\detokenize{Adsorption/Adsorption:contactor-results-and-analysis}}\begin{quote}
\begin{enumerate}
\item {} 
Plot the breakthrough curves showing \(\frac{C}{C_0}\) versus time.

\item {} 
Find the time when the effluent concentration was 50\% of the influent concentration and plot that as a function of the mass of activated carbon used.

\item {} 
Calculate the retardation coefficient (\(R_{adsorption}\)) based on the time to breakthrough for the columns with and without activated carbon.

\item {} 
Calculate the \(q_0\) for each of the columns based on equation \eqref{equation:Adsorption/Adsorption:eq_q_0}. Plot this as a function of the mass of activated carbon used.

\end{enumerate}

What did you learn from this analysis? How can you explain the results that you have obtained? What changes to the experimental method do you recommend for next year (or for a project)?
\end{quote}


\section{Prelab Questions}
\label{\detokenize{Adsorption/Adsorption:prelab-questions}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-pre-laboratory-questions}}\begin{enumerate}
\item {} 
A carbon column is packed with 15 cm of activated carbon and then used to remove 50 mg/L of red dye \#40. The approach velocity is 1 mm/s, the porosity is 0.8, and the bulk density of the activated carbon is 0.38 \(g/cm^3\). The mass of red dye per mass of carbon at equilibrium with 50 mg/L of red dye is 0.08. How long will it take for the mass transfer zone to travel to the bottom of the carbon column? This analysis shows why we use less activated carbon for our experiments in the lab!

\end{enumerate}


\section{Lab Prep Notes}
\label{\detokenize{Adsorption/Adsorption:lab-prep-notes}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-lab-prep-notes}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Reagent list.}\label{\detokenize{Adsorption/Adsorption:id4}}\label{\detokenize{Adsorption/Adsorption:table-activated-carbon-reagent-list}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{50}|\X{20}{50}|\X{10}{50}|}
\hline
\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Supplier
&\sphinxstyletheadfamily 
Catalog number
\\
\hline
activated carbon
&&\\
\hline
red dye \#40
&&\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Setup}
\label{\detokenize{Adsorption/Adsorption:setup}}\begin{enumerate}
\item {} 
Verify that all necessary supplies are in place for the pumps, tanks, column, valves, and tubing.

\item {} 
Prepare the Red Dye \#40 stock solution.

\item {} 
Prepare a 5\% bleach solution (5 mL bleach diluted to 100 mL with reverse osmosis water) for cleaning the photometer sample cell and sample lines.

\end{enumerate}


\subsection{Procedure to remove air from the top of the column}
\label{\detokenize{Adsorption/Adsorption:procedure-to-remove-air-from-the-top-of-the-column}}\begin{enumerate}
\item {} 
Close the Red Dye \#40 influent valve.

\item {} 
Open the reverse osmosis water influent valve.

\item {} 
Wait for the influent line to clear of Red Dye \#40.

\item {} 
Turn off the pump.

\item {} 
Reverse the column flow direction.

\item {} 
Turn on the pump until the air is removed.

\item {} 
Turn off the pump.

\item {} 
Reverse the column flow direction.

\item {} 
Turn on the pump and switch the influent to Red Dye \#40.

\end{enumerate}


\section{References}
\label{\detokenize{Adsorption/Adsorption:references}}\label{\detokenize{Adsorption/Adsorption:heading-adsorption-recommendations-from-previous-years}}
Lawler, D. F., \& Benjamin, M. M. (2013). Water quality engineering: physical / chemical treatment processes. Hoboken, N.J.: Wiley. Retrieved from \sphinxurl{http://search.ebscohost.com/login.aspx?direct=true\&scope=site\&db=nlebk\&db=nlabk\&AN=631668}


\chapter{Gas Transfer}
\label{\detokenize{Gas_Transfer/Gas_Transfer:gas-transfer}}\label{\detokenize{Gas_Transfer/Gas_Transfer:title-gas-transfer}}\label{\detokenize{Gas_Transfer/Gas_Transfer::doc}}

\section{Introduction}
\label{\detokenize{Gas_Transfer/Gas_Transfer:introduction}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-introduction}}
Exchange of gases between aqueous and gaseous phases is an essential element of many environmental processes. Wastewater treatment plants require enhanced transfer of oxygen into activated sludge tanks to maintain aerobic degradation. Water treatment plants require gas transfer to dissolve chlorine gas or ozone. Gas transfer can also be used to remove unwanted volatile chemicals such as carbon tetrachloride, tetrachloroethylene, trichloroethylene, chloroform, bromodichloromethane, and bromoform from water (Zander et al., 1989). Exchange of a dissolved compound with the atmosphere is controlled by the extent of mixing in the aqueous and gaseous phase, the surface area of the interface, the concentration of the compound in the two phases, and the equilibrium distribution of the compound. Technologies that have been developed to enhance gas transfer include: aeration diffusers, packed-tower air stripping, and membrane stripping. Each of these technologies creates a high interface surface area to enhance gas transfer.


\section{Theory}
\label{\detokenize{Gas_Transfer/Gas_Transfer:theory}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-theory}}
Oxygen transfer is important in many environmental systems. Oxygen transfer is controlled by the partial pressure of oxygen in the atmosphere (0.21 atm) and the corresponding equilibrium concentration in water (approximately 10 mg/L). According to Henry’s Law, the equilibrium concentration of oxygen in water is proportional to the partial pressure of oxygen in the atmosphere.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{P\PYGZus{}air} \PYG{o}{=} \PYG{l+m+mf}{101.3}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kPa}
\PYG{n}{temp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{C\PYGZus{}Oxygen} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{O2\PYGZus{}sat}\PYG{p}{(}\PYG{n}{P\PYGZus{}air}\PYG{p}{,}\PYG{n}{temp}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{,}\PYG{n}{C\PYGZus{}Oxygen}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (degrees Celsius)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Oxygen concentration (mg/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}fig.savefig(\PYGZsq{}Gas\PYGZus{}Transfer/Images/Oxygen\PYGZus{}vs\PYGZus{}T\PYGZsq{})}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Oxygen_vs_T}.png}
\caption{Dissolved oxygen concentrations in equilibrium with the atmosphere.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id2}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-oxygen-vs-t}}\end{figure}

Natural bodies of water may be either supersaturated or undersaturated with oxygen depending on the relative magnitude of the sources and sinks of oxygen. Algae can be a significant source of oxygen during active photosynthesis and can produce supersaturation. Algae also deplete oxygen levels during the night.

At high levels of supersaturation dissolved gas will form microbubbles that eventually coalesce, rise, and burst at the water surface. The bubbles provide a very efficient transfer of supersaturated dissolved gas to the gaseous phase, a process that can be observed when the partial pressure of carbon dioxide is decreased by opening a carbonated beverage. Bubble formation by supersaturated gasses also occurs in the environment when cold water in equilibrium with the atmosphere is warmed rapidly. The equilibrium dissolved oxygen concentration decreases as the water is warmed (\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-oxygen-vs-t}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-oxygen-vs-t}}}).

Supersaturation of dissolved gases can also occur when water carrying gas bubbles from a waterfall or spillway plunges into a deep pool. The pressure increases with depth in the pool and gasses carried deep into the pool dissolve in the water. When the water eventually approaches the surface the pressure decreases and the dissolved gases come out of solution and form bubbles. Bubble formation by supersaturated gases can kill fish (similar to the bends in humans) as the bubbles form in the bloodstream.


\subsection{Gas Transfer Coefficient}
\label{\detokenize{Gas_Transfer/Gas_Transfer:gas-transfer-coefficient}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-coefficient}}
The gas transfer rate can be modeled as the product of a driving force (the difference between the equilibrium concentration and the actual concentration) and an overall volumetric gas transfer coefficient (a function of the geometry, mixing levels of the system and the solubility of the compound). In equation form
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_first_order}
\begin{split} \frac{dC}{dt} =\hat{k}_{v,l} \left(C^{*} -C\right)\end{split}
\end{equation}
where C is the dissolved gas concentration, C* is the equilibrium dissolved gas concentration, and \(\hat{k}_{v,l}\) is the overall volumetric gas transfer coefficient . Although \(\hat{k}_{v,l}\) has dimensions of 1/T, it is a function of the interface surface area (A), the liquid volume (V), the oxygen diffusion coefficient in water (D), and the thickness of the laminar boundary layer (?) through which the gas must diffuse before the much faster turbulent mixing process can disperse the dissolved gas throughout the reactor.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:0}
\begin{split}\hat{k}_{v,l} =f(D,\delta ,A,V)\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Single_film_model}.png}
\caption{Single film model of interphase mass transfer of oxygen.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id3}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-single-film-model}}\end{figure}

The overall volumetric gas transfer coefficient is system specific and thus must be evaluated separately for each system of interest (Weber and Digiano, 1996).

A schematic of the gas transfer process is shown in \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-single-film-model}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-single-film-model}}}. Fickian diffusion controls the gas transfer in the laminar boundary layer. The oxygen concentration in the bulk of the fluid is assumed to be homogeneous due to mixing and the oxygen concentration above the liquid is assumed to be that of the atmosphere.

The gas transfer coefficient will increase with the interface area and the diffusion coefficient and will decrease with the reactor volume and the thickness of the boundary layer. The functional form of the relationship is given by
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:1}
\begin{split}\hat{k}_{v,l} =\frac{AD}{V\delta }\end{split}
\end{equation}
Equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_first_order} can be integrated with appropriate initial conditions to obtain the concentration of oxygen as a function of time. However, care must be taken to ensure that the overall volumetric gas transfer coefficient is not a function of the dissolved oxygen concentration. This dependency can occur where air is pumped through diffusers on the bottom of activated sludge tanks. Rising air bubbles are significantly depleted of oxygen as they rise through the activated sludge tank and the extent of oxygen depletion is a function of the concentration of oxygen in the activated sludge. Integrating equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_first_order} with initial conditions of C = C0 at t = t0
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:2}
\begin{split}\int _{C_{0} }^{C}\frac{dC}{C^{*} -C}  =\int _{t_{0} }^{t}\hat{k}_{v,l} dt\end{split}
\end{equation}\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_linearized}
\begin{split} \ln \frac{C^{*} -C}{C^{*} -C_{0} } =-\hat{k}_{v,l} (t-t_{0} )\end{split}
\end{equation}
Equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_linearized} can be evaluated using linear regression so that \(\hat{k}_{v,l}\) is the slope of the line.

The simple gas transfer model given in equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_linearized} is appropriate when the gas transfer coefficient is independent of the dissolved gas concentration. This requirement can be met in systems where the gas bubbles do not change concentration significantly as they rise through the water column. This condition is met when the water column is shallow, the bubbles have large diameters, or the difference between the concentration of dissolved gas and the equilibrium concentration is small.


\subsection{Oxygen Transfer Efficiency}
\label{\detokenize{Gas_Transfer/Gas_Transfer:oxygen-transfer-efficiency}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-oxygen-transfer-efficiency}}
An important parameter in the design of aeration systems for the activated sludge process is the energy cost of compressing air to be pumped though diffusers. The pumping costs are a function of the pressure and the airflow rate. The pressure is a function of the hydrostatic pressure (based on the depth of submergence of the diffusers) and the head loss in the pipes and through the diffuser. The required airflow rate is a function of the BOD of the wastewater and the efficiency with which oxygen is transferred from the gas phase to the liquid phase. This oxygen transfer efficiency (OTE) is a function of the type of diffuser, the diffuser depth of submergence, as well as temperature and ionic strength of the activated sludge. Oxygen transfer is a remarkably inefficient process; only a small fraction of the oxygen carried by the rising bubbles diffuses into the activated sludge. The most efficient systems use membrane diffusers and achieve an OTE of approximately 10\%.

The manufacturer typically provides oxygen transfer efficiency for a specific diffuser. In this laboratory we will measure oxygen transfer efficiency for the aeration stone that we will be using in an activated sludge tank. The molar transfer rate of oxygen through the diffuser is
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_air_supply}
\begin{split} \dot{n}_{gas\; o_{2} } =\frac{Q_{air} P_{air} f_{O_{2} } }{RT}\end{split}
\end{equation}\begin{description}
\item[{where}] \leavevmode
\begin{DUlineblock}{0em}
\item[] \(f_{O_2}\) is the molar fraction of air that is oxygen (0.21),
\item[] \(Q_{air}\) is the volumetric flow rate of air into the diffuser,
\item[] \(P_{air}\) is the air pressure immediately upstream from the diffuser,
\item[] \(R\) is the universal gas constant and
\item[] \(T\) is absolute temperature.
\end{DUlineblock}

\end{description}

If the airflow rate is already given with units of moles/s then the molar transfer rate of oxygen can be obtained by multiplying by the molar fraction of air that is oxygen.

The molar rate of dissolution into the aqueous phase is
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:3}
\begin{split}\dot{n}_{aq\; o_{2} } =\frac{\rlap{-} V}{MW_{O_{2} } } \frac{dC}{dt}\end{split}
\end{equation}\begin{description}
\item[{where}] \leavevmode
\begin{DUlineblock}{0em}
\item[] \(MW_{O_2}\) is the molecular weight of oxygen,
\item[] \(\rlap{-} V\) is the reactor volume, and
\item[] \(\frac{dC}{dt}\) is the change in aqueous oxygen concentration with time.
\end{DUlineblock}

\end{description}

The rate of change of oxygen concentration is a function of the dissolved oxygen concentration and is a maximum when the dissolved oxygen concentration is zero. Oxygen transfer efficiency could be measured for any dissolved oxygen concentration. A better method of analysis is to substitute the right side of equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_first_order} for \(\frac{dC}{dt}\) .
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_O2_dissolved}
\begin{split} \dot{n}_{aq\; o_{2} } =\frac{V\hat{k}_{v,l} \left(C^{*} -C\right)}{MW_{O_{2} } }\end{split}
\end{equation}
The oxygen transfer efficiency is the ratio of equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_O2_dissolved} to equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_air_supply}.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_OTE}
\begin{split} OTE=\frac{\hat{k}_{v,l} \left(C^{*} -C\right)VRT}{MW_{O_{2} } Q_{air} P_{air} f_{O_{2} } }\end{split}
\end{equation}
Measurement of OTE using equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_OTE} requires that the gas transfer coefficient, air flow rate, air pressure, and the air temperature be measured. (\(P_{air}\) and \(Q_{air}\) have to correlate and in this experiment the best combination is atmospheric pressure and the flow rate given by the pump.)

If the molar airflow rate is controlled then OTE is based on the ratio of equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_O2_dissolved} to the molar transfer rate of supplied oxygen.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:4}
\begin{split}OTE=\frac{\dot{n}_{aq\; o_{2} } }{f_{O_{2} } \dot{n}_{air} } =\frac{V\hat{k}_{v,l} \left(C^{*} -C\right)}{f_{O_{2} } \dot{n}_{air} MW_{O_{2} } }\end{split}
\end{equation}

\subsection{Deoxygenation}
\label{\detokenize{Gas_Transfer/Gas_Transfer:deoxygenation}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-deoxygenation}}
To measure the reaeration rate it is necessary to first remove the oxygen from the reactor. This can be accomplished by bubbling the solution with a gas that contains no oxygen. Nitrogen gas is typically used to remove oxygen from laboratory reactors. Alternately, a reductant can be used. Sulfite is a strong reductant that will reduce dissolved oxygen in the presence of a catalyst.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:5}
\begin{split}{O}_{{2}} +{2SO}_{{3}}^{-{2}} \stackrel{{cobalt}}{\longrightarrow}{2SO}_{{4}}^{-{2}}\end{split}
\end{equation}
The mass of sodium sulfite required to deoxygenate 1 mg of oxygen is calculated from the stoichiometry of equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_first_order}.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:6}
\begin{split}\frac{{mole\; O}_{{2}} }{{32000\; mg\; O}_{{2}} } \cdot \frac{{2\; mole\; Na}_{{2}} {SO}_{{3}} }{{mole\; O}_{{2}} } \cdot \frac{{126,000\; mg\; Na}_{{2}} {SO}_{{3}} }{{mole\; Na}_{{2}} {SO}_{{3}} } =\frac{{\; 7.875\; mg\; Na}_{{2}} {SO}_{{3}} }{{mg\; O}_{{2}} }\end{split}
\end{equation}
If complete deoxygenation is desired a 10\% excess of sulfite can be added. The sulfite will continue to react with oxygen as oxygen is transferred into the solution. The oxygen concentration can be measured with a dissolved oxygen probe or can be estimated if the temperature is known and equilibrium with the atmosphere assumed (\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-oxygen-vs-t}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-oxygen-vs-t}}}).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{O2\PYGZus{}C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{Sample\PYGZus{}V} \PYG{o}{=} \PYG{l+m+mi}{750} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}
\PYG{n}{SulfiteperO2} \PYG{o}{=} \PYG{l+m+mf}{7.875}
\PYG{n}{Sulfite\PYGZus{}Stock\PYGZus{}C} \PYG{o}{=} \PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}
\PYG{k}{def} \PYG{n+nf}{Sulfite\PYGZus{}V}\PYG{p}{(}\PYG{n}{O2\PYGZus{}C}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{Sample\PYGZus{}V}\PYG{o}{*}\PYG{n}{O2\PYGZus{}C}\PYG{o}{*}\PYG{n}{SulfiteperO2}\PYG{o}{/}\PYG{n}{Sulfite\PYGZus{}Stock\PYGZus{}C}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{O2\PYGZus{}C}\PYG{p}{,}\PYG{n}{Sulfite\PYGZus{}V}\PYG{p}{(}\PYG{n}{O2\PYGZus{}C}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Oxygen concentration (mg/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sulfite stock volume (mL)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}fig.savefig(\PYGZsq{}Gas\PYGZus{}Transfer/Images/Sulfite\PYGZsq{})}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Sulfite}.png}
\caption{Volume of 100 mg/mL sodium sulfite stock required to deoxygenate a 750 mL sample of water.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id4}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-sulfite}}\end{figure}


\section{Experimental Objectives}
\label{\detokenize{Gas_Transfer/Gas_Transfer:experimental-objectives}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-experimental-objectives}}
The objectives of this lab are to:
\begin{enumerate}
\item {} 
Illustrate the dependence of gas transfer on gas flow rate.

\item {} 
Develop a functional relationship between gas flow rate and gas transfer.

\item {} 
Measure the oxygen transfer efficiency of a course bubble diffuser.

\item {} 
Explain the theory and use of dissolved oxygen probes.

\end{enumerate}

A small reactor that meets the conditions of a constant gas transfer coefficient will be used to characterize the dependence of the gas transfer coefficient on the gas flow rate through a simple diffuser. The gas transfer coefficient is a function of the gas flow rate because the interface surface area i.e., the surface area of the air bubbles) increases as the gas flow rate increases.


\section{Dissolved Oxygen Probes}
\label{\detokenize{Gas_Transfer/Gas_Transfer:dissolved-oxygen-probes}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-dissolved-oxygen-probes}}

\subsection{Theory}
\label{\detokenize{Gas_Transfer/Gas_Transfer:id1}}
The dissolved oxygen probes make use of the fact that an applied potential of 0.8 V can reduce \(O_2\) to \(H_2O\):
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:7}
\begin{split}4 e^- + 4 H^+ + O_2 \mathrm{\to} 2 H_2O\end{split}
\end{equation}
The cell is separated from solution by a gas permeable membrane that allows \(O_2\) to pass through. The concentration of \(O_2\) in the cell is kept very low by reduction to \(H_2O\). The rate at which oxygen diffuses through the gas permeable membrane is proportional to the difference in oxygen concentration across the membrane. The concentration of oxygen in the cell is \(\mathrm{\approx}0\) and thus the rate at which oxygen diffuses through the membrane is proportional to the oxygen concentration in the solution.

Oxygen is reduced to water at a silver (Ag) cathode of the probe. Oxygen reduction produces a current that is converted to a voltage that is measured by ProCoDA.


\section{Experimental Methods}
\label{\detokenize{Gas_Transfer/Gas_Transfer:experimental-methods}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-experimental-methods}}
The reactors are 1 L beakers that will be filled with 750 mL of water (\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}}}). The DO probe should be placed in a location so as to minimize the risk of air bubbles lodging on the membrane on the bottom of the probe. Groups from previous years have recommended keeping the DO probe close to the bottom of the reactor so that no air bubbles cover the DO probe. The aeration stone is connected to a source of regulated air flow. A 200-kPa pressure sensor is used to measure the air pressure in the accumulator.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{new_schematic}.png}
\caption{Apparatus used to measure reaeration rate.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id5}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}}\end{figure}

The ProCoDA II software will be used to control the air flow rate for the aeration experiment. The software will use external code to calculate the calibration constant for the flow restriction, to control valve 1 (the air supply valve), and to regulate the flow of air into the accumulator. The calibration uses the ideal gas law to determine the flow rate as a function of the difference in pressure between the source and the accumulator. Once this calibration is obtained a separate code will set the fraction of time that valve 1 needs to be open to obtain the desired flow rate of air into the accumulator.


\subsection{Initial Setup}
\label{\detokenize{Gas_Transfer/Gas_Transfer:initial-setup}}
Follow these steps to set up the experiment.
\begin{enumerate}
\item {} 
Assemble the apparatus.

\item {} 
Make sure that you push hard and twist to insert tubing into quick connect fittings.

\item {} 
Install the accumulator pressure sensor \sphinxincludegraphics[height=45\sphinxpxdimen]{{Accumulator_pressure_sensor}.jpg} so that the positive side of the sensor is connected to the accumulator. The positive side of the pressure sensor is the longer side or the side that is farthest from where the cable is attached to the sensor.

\item {} 
Use the \sphinxincludegraphics{{Config_open_save_export}.png} on the ProCoDA configuration tab (select the left open folder icon) to load the \sphinxhref{https://github.com/monroews/EnvEngLabTextbook/raw/master/ProCoDA/methods/Gas\_Transfer\_Student\_method\_file.pcm}{method file containing the configuration necessary to control airflow}.

\item {} 
Plug the pressure sensor that is monitoring the flow accumulator into sensor port 0.

\item {} 
Plug the dissolved oxygen probe into sensor port 1.

\item {} 
Plug the air source valve that is connected to the flow restriction into the port labeled 2 24 V.

\item {} 
Plug the aeration valve that is upstream from the needle valve into the port labeled 3 24 V.

\item {} 
Open the accumulator bottle cap to ensure that it is at atmospheric pressure.

\item {} 
Zero the accumulator pressure sensor by selecting \sphinxincludegraphics{{config_sensors}.png}, select the accumulator pressure sensor and then select \sphinxincludegraphics{{sensor_set_to_zero}.png}.

\item {} 
Close the accumulator bottle cap.

\item {} 
Open the air valve that provides laboratory air to your apparatus and fix any air leaks that you observe.

\item {} 
Close the needle valve (\(N_2\) in \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}}}) that is closest to the beaker by turning it clockwise.

\item {} 
Navigate to the ProCoDA Process Operation tab.

\item {} 
Set the \sphinxstylestrong{operator selected state} to toggle.  The solenoid valves should click rhythmically if they are working properly. You can hold a solenoid valve in your hand to fill it actuating. If it isn’t actuating you can test the connection where it is plugged into ProCoDA.

\item {} 
Open the needle valve, \(N_2\), so that air pulses gently in your reactor and doesn’t spill any water.

\end{enumerate}


\subsection{Connect to the shared source pressure sensor}
\label{\detokenize{Gas_Transfer/Gas_Transfer:connect-to-the-shared-source-pressure-sensor}}\begin{enumerate}
\item {} 
Navigate to the ProCoDA configuration tab and click on share data \sphinxincludegraphics{{Share_data}.png}.

\item {} 
Browse to the shared S drive (right below the Local Disk C), select the folder “Shared data”.

\item {} 
A shared variable called “Source pressure” should be in the tab of “Shared data from other instances of ProCoDA”. Select that variable by clicking on it. It will highlight.

\item {} 
Click on OK.

\item {} 
Select the ProCoDA Graph tab.

\end{enumerate}


\subsection{Check for air leaks}
\label{\detokenize{Gas_Transfer/Gas_Transfer:check-for-air-leaks}}\begin{enumerate}
\item {} 
Fill the accumulator with air by selecting the “calibrate” state. (You may need to open needle valve \(N_1\).)

\item {} 
After the accumulator is at high pressure (approximately 50 kPa or greater), then close all solenoid valves by selecting the “Off” state.

\item {} 
Check your system for air leaks by monitoring the accumulator pressure. If it drops over time, then check each tubing connection and if necessary push hard and twist to properly insert tubing into the quick connect tube fittings. If the pressure increases then the solenoid valve, \(S_1\), is leaking and should be replaced.

\item {} 
If the leaking persists then check for other leaks. Possible leak sources include pipe thread connections, rough tubing ends at the instant tube fitting o-ring seal, accumulator cap, or leaking solenoid valves.

\end{enumerate}


\subsection{Calibrate the air flow controller}
\label{\detokenize{Gas_Transfer/Gas_Transfer:calibrate-the-air-flow-controller}}
The purpose of this calibration step is to measure the characteristics of the flow resistor so that the rate of flow from the air supply to the flow accumulator can be predicted and controlled. The flow rate from the air source to the flow accumulator is dependent on the air source pressure, the accumulator pressure, and the flow resistance between them. The flow rate decreases as the difference in pressure decreases.

The calibration uses 3 states. The first state is “prepare to calibrate”. In this state the aeration valve opens and the accumulator pressure drops until it reaches the “Min calibration pressure (Pa)” which is set at 5,000 Pa. The second state is “calibrate”. In this state the aeration valve closes and the air source valve opens. This causes the flow accumulator to rapidly fill. The “calibrate” state ends when the pressure in the accumulator reaches 60\% of the source pressure. The next state is a 5 second pause in which both valves are closed. Finally the system switches to aerate and uses the flow rate entered as a variable in \sphinxincludegraphics{{config_edit_rules}.png}. The calibration sequence creates a graph as shown in \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-calibration-graph}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-calibration-graph}}}. The data from the “calibrate” state is used to find the unknown term in equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_t_fill_accumulator}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Airflow_calibration_graph}.png}
\caption{Graph of the airflow calibration. The initial accumulator pressure decrease is during the “prepare to calibrate” state. The accumulator fills rapidly during the “calibrate” state.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id6}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-calibration-graph}}\end{figure}

Complete the following steps.
\begin{enumerate}
\item {} 
Gently close the needle valve that is close to the air supply (\(N_1\)). Then open the valve about 1/8th of a turn.

\item {} 
Set up the graph in the ProCoDA Graphs tab to look similar to \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-calibration-graph}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-calibration-graph}}}. Note that you can select multiple data source for plotting by holding down the control key while clicking on the data to plot.

\item {} 
Set both the Accumulator pressure and the Source Pressure plots to use the same left y axis \sphinxincludegraphics{{select_y_axis_scale}.png}. Select the y axis by clicking on the plot of interest in the legend. This will make it easy to observe how the accumulator is behaving relative to the source pressure.

\item {} 
Set the mode of operation \sphinxincludegraphics{{Mode_of_operation}.png} to automatic operation and the \sphinxstyleemphasis{operator selected state} to “prepare to calibrate”. The software should quickly cycle through the calibration step and then begin attempting to control the air flow rate to the target value.  Note:  the purpose of the prepare to calibrate state is to vent excess pressure from the accumulator.  The state will not change to calibrate until the pressure drops below a predefined threshold.  To speed this up, you may open the needle valve.

\item {} 
The air slope should have a value of approximately 1.5 E7 to 2.5 E7. To increase the air slope close the \(N_1\) needle valve slightly and repeat the “Calibrate” step.

\item {} 
Repeat the “Calibrate” step several times to make sure you understand what ProCoDA is doing and to confirm that the air slope \sphinxincludegraphics{{air_slope}.png} displayed on the ProCoDA “Process Operation” tab is repeatable (within about 5\%). Hint: You can tell ProCoDA to go back to “prepare to calibrate” state by right clicking on that state.

\item {} 
Lock the air slope by changing it from a variable to a constant. This will prevent you from accidently losing the air slope by clicking on the calibrate state. Browse to the ProCoDA “Configuration” tab, select \sphinxincludegraphics{{config_edit_rules}.png}, select the variable “air slope”, and change it to a constant.  \sphinxincludegraphics{{Change_air_slope_to_constant}.png}

\item {} 
Don’t adjust the \(N_1\) needle valve now that the air flow is calibrated.

\end{enumerate}


\subsection{Test the air flow controller}
\label{\detokenize{Gas_Transfer/Gas_Transfer:test-the-air-flow-controller}}
In the following test, the air flow controller should provide a constant flow of air into the accumulator. You can assess how well the air flow controller is working based on the slope of the pressure as a function of time. The equation for the expected change in pressure vs time can be derived from the ideal gas law.
\begin{align}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:8}\!\begin{aligned}
PV = nRT\\
P = \frac{nRT}{V}\\
\Delta P = \frac{\dot{n}RT}{V}\Delta t\\
P = P_{0} + \Delta P = P_{0} +\frac{\dot{n}RT}{V}\Delta t\\
\end{aligned}\end{align}
This equation has been programming in ProCoDA as the “air fill model”. Thus you can compare the measured pressure in the accumulator and the “air fill model” to see if the flow controller is working properly.
\begin{enumerate}
\item {} 
Add the “air fill model” to the ProCoDA graph and make sure that it is using the left axis.

\item {} 
Set the air flow rate based on our calibration be navigating to the Configuration tab and selecting \sphinxincludegraphics{{config_edit_rules}.png}. We want to control the air flow rate, so select air flow rate from the set points and variables list. Set the air flow rate to a value of 400u (400 \(\mu M/s\)).

\item {} 
Begin logging data at a 1 s interval using the \sphinxincludegraphics{{config_Logging_data_short_exp1}.png} datalog button on the configuration tab. Data is being logged when the icon is green.

\item {} 
Set the \sphinxstylestrong{operator selected state} to “Prepare to test fill”

\item {} 
Watch the graph to see the accumulator pressure and air fill model increase at the same rate (hopefully).

\item {} 
End logging data when the fill cycle ends.

\item {} 
The resulting graph should look like the figure below.

\item {} 
The measured value for the final pressure at the end of the “Fill accumulator” state should be within 20\% of the predicted value. You can find these values in the data log.

\end{enumerate}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Accumulator_fill}.png}
\caption{Graph of the accumulator filling at a flow rate of 100 \(\mu M/s\). The measured values and the model are in reasonable agreement.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id7}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-accumulator-fill}}\end{figure}


\subsection{Install the Membrane Cap on the Dissolved Oxygen Probe}
\label{\detokenize{Gas_Transfer/Gas_Transfer:install-the-membrane-cap-on-the-dissolved-oxygen-probe}}\begin{enumerate}
\item {} 
Make sure to wear gloves for these steps!

\item {} 
Use a pipette or dropper to fill the membrane cap with 0.05 N NaOH solution. Take care not to dispense air bubbles into the membrane cap. Fill the cap to within 5 mm of the top.

\item {} 
Place a beaker on the bench top below the membrane cap to catch any spilled NaOH solution.

\item {} 
Hold the cap so that it doesn’t spill and screw the probe into the cap. Some NaOH will leak out as you tighten the cap. Catch these drips in the beaker.

\item {} 
Rinse the probe with deionized water.

\item {} 
Inspect the probe carefully to see if there are any air bubbles inside the membrane. If there are any bubbles, repeat starting at step 2.

\end{enumerate}


\subsection{Calibrate the Dissolved Oxygen Probe}
\label{\detokenize{Gas_Transfer/Gas_Transfer:calibrate-the-dissolved-oxygen-probe}}\begin{enumerate}
\item {} 
Add 750 mL of tap water to the reactor.

\item {} 
The instructor or TA will add \(10\frac{ \mu g}{L}\) of \(CoCl_2 \cdot 6H_2O\) (note this only needs to be added once because it is the catalyst). A stock solution of \(100 \mu g/mL\) of \(CoCl_2 \cdot 6H_2O\) (thus add 75 \(\mu L\) per 750 mL) has been prepared to facilitate measurement of small cobalt doses. (Use gloves when handling cobalt!)

\item {} 
{\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-dissolved-oxygen}]{\sphinxcrossref{\DUrole{std,std-ref}{Calibrate the DO probe}}}}. Use \(22^{\circ}C\) as the temperature.

\end{enumerate}


\subsection{Measure the Gas Transfer}
\label{\detokenize{Gas_Transfer/Gas_Transfer:measure-the-gas-transfer}}
\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:table-air-flow-rates}]{Table \ref{\detokenize{Gas_Transfer/Gas_Transfer:table-air-flow-rates}}} provides the air flow rates for each team. The data will be consolidated


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Suggested flow rates.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id8}}\label{\detokenize{Gas_Transfer/Gas_Transfer:table-air-flow-rates}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Group       Flows
&\sphinxstyletheadfamily 
(\(mu M/s\))
\\
\hline
Group 1
&
100, 400, 700
\\
\hline
Group 2
&
125, 425, 725
\\
\hline
Group 3
&
150, 450, 750
\\
\hline
Group 4
&
175, 475, 775
\\
\hline
Group 5
&
200, 500, 800
\\
\hline
Group 6
&
225, 525, 825
\\
\hline
Group 7
&
250, 550, 850
\\
\hline
Group 8
&
275, 575, 875
\\
\hline
Group 9
&
300, 600, 900
\\
\hline
Group 10
&
325, 625, 925
\\
\hline
Group 11
&
350, 650, 950
\\
\hline
Group 12
&
375, 675, 975
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{description}
\item[{Set the stirrer speed to mix the tank but not to cause a vortex that sucks bubbles into the stirrer. Then repeat the following steps for each flow rate.}] \leavevmode\begin{enumerate}
\item {} 
Set the air flow rate in \sphinxincludegraphics{{config_edit_rules}.png} to the desired flow rate.

\item {} 
Set the \sphinxstylestrong{operator selected state} to aerate.

\item {} 
Set the needle valve that is close to the beaker, \(N_2\), so the pressure in the accumulator is between 20 and 50 kPa.

\item {} 
Wait until the accumulator pressure reaches steady state.

\item {} 
Turn the air off by changing the operator selected state to OFF.

\item {} 
Add enough sodium sulfite to deoxygenate the solution. It is okay if the sample doesn’t completely deoxygenate. The goal is to have less than 1.5 mg/L of oxygen at the beginning of the aeration. A stock solution of sodium sulfite (100 mg/mL) has been prepared to facilitate measurement of small sulfite doses. Calculate this dose based on the measured dissolved oxygen concentration. (see \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-sulfite}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-sulfite}}})

\item {} 
Prepare to record the dissolved oxygen concentration using ProCoDA software. Use 5-second data intervals and log the data to \sphinxcode{\sphinxupquote{S:\textbackslash{}Courses\textbackslash{}4530\textbackslash{}Group \#\textbackslash{}gastran\textbackslash{}x}} where x is the flow rate in \(\mu M/s\) for later analysis. Include the actual flow rate in the file name.

\item {} 
Turn the air on by changing the \sphinxstylestrong{operator selected state} to Aerate.

\item {} 
Monitor the dissolved oxygen concentration until it reaches 50\% of saturation value or 10 minutes (whichever is shorter).

\item {} 
Repeat steps 1-9 to collect data from at least two additional flow rates which are assigned to your group in Table 8.

\item {} 
Email your data files (correctly named!) to the course email account. \sphinxstylestrong{Warning*}: Do not edit your data files collected from ProCODA. This will cause issues when it comes time to analyze the data.

\item {} 
Answer the questions in the section on {\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-lab-explorations}]{\sphinxcrossref{\DUrole{std,std-ref}{Lab Explorations}}}}.

\end{enumerate}

\end{description}


\section{Lab Explorations}
\label{\detokenize{Gas_Transfer/Gas_Transfer:lab-explorations}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-lab-explorations}}
This lab exercise introduces the use of computer control as well as some interesting hydraulics. These questions are designed to help you think through everything that is happening in this lab. Include a discussion of these questions in the laboratory report.

The ProCoDA method that you used in this lab has two programs that cause ProCoDA to switch between states and change what it is doing. Explore the rule editor, \sphinxincludegraphics{{config_edit_rules}.png}, to figure out answers to the following questions.
\begin{enumerate}
\item {} 
Under what condition does ProCoDA switch from the “prepare to calibrate” state to the “calibrate” state?

\item {} 
Under what condition does ProCoDA switch from the “calibrate” state to the “Pause” state?

\item {} 
How does the “Pause” state know which state to go to next?

\item {} 
What is the equation that is used to calculate the maximum calibration pressure and why is this equation better than using a constant for the maximum calibration pressure?

\item {} 
Explain how ProCoDA calculates the predicted pressure in the accumulator when it is filled at a constant mass flow rate.

\item {} 
What are the inputs to the “air valve control”?

\item {} 
What does “air valve control” control and which two states use it?

\item {} 
Write a ProCoDA program that cycles between two states that aerate for 15 s and then pause for 10 s. Show the TA!

\end{enumerate}


\section{Prelab Questions}
\label{\detokenize{Gas_Transfer/Gas_Transfer:prelab-questions}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-pre-laboratory-questions}}\begin{enumerate}
\item {} 
Calculate the mass of sodium sulfite needed to reduce all the dissolved oxygen in 750 mL of pure water in equilibrium with the atmosphere and at \(22^\circ C\).

\item {} 
Describe your expectations for dissolved oxygen concentration as a function of time during a reaeration experiment.  Assume you have added enough sodium sulfite to consume all of the oxygen at the start of the experiment. What would the shape of the curve look like?

\item {} 
Why is \(\hat{k}_{v,l}\) not zero when the gas flow rate is zero? How can oxygen transfer into the reactor even when no air is pumped into the diffuser?

\item {} 
Describe your expectations for \(\hat{k}_{v,l}\) as a function of gas flow rate. Do you expect a straight line? Why?

\item {} 
A dissolved oxygen probe was placed in a small vial in such a way that the vial was sealed. The water in the vial was sterile. Over a period of several hours the dissolved oxygen concentration gradually decreased to zero. Why? (You need to know how dissolved oxygen probes work!)

\end{enumerate}


\section{Data Analysis}
\label{\detokenize{Gas_Transfer/Gas_Transfer:data-analysis}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-data-analysis}}
This lab will use the power of python to streamline repetitive data analysis. Use the data from the entire class for the analysis. You can use for loops to cycle through all of the data sets.
\begin{enumerate}
\item {} 
Eliminate the data from each data set when the dissolved oxygen concentration was less than 2 mg/L. This will ensure that all of the sulfite has reacted. Also remove the data when the dissolved oxygen concentration was greater than 6 mg/L to reduce the effect of measurement errors when the oxygen deficit is small.

\item {} 
Plot a representative subset of the data showing dissolved oxygen vs. time. Perhaps show 5 plots on one graph.

\item {} 
Calculate \(C^{\star}\) based on the average water temperature, barometric pressure, and the equation from \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/environmental\_processes\_analysis.py}{environmental processes} analysis called O2\_sat. \(C^{\star} =P_{O_{2}} {\mathop{e}\nolimits^{\left(\frac{1727}{T} -2.105\right)}}\) where T is in Kelvin, \(P_{O_{2} }\) is the partial pressure of oxygen in atmospheres, and \(C^{\star}\) is in mg/L.

\item {} 
Estimate \(\hat{k}_{v,l}\) using linear regression and equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_linearized} for each data set.

\item {} 
Create a graph with a representative plot showing the model curve (as a smooth curve) and the data from one experiment. You will need to derive the equation for the concentration of oxygen as a function of time based on equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_linearized}.

\item {} 
Plot \(\hat{k}_{v,l}\) as a function of airflow rate (\(\mu mole/s\)).

\item {} 
Plot OTE as a function of airflow rate (?mole/s) with the oxygen deficit (\(C^{\star} -C\)) set at 6 mg/L.

\item {} 
Comment on the oxygen transfer efficiency and the trend or trends that you observe.

\item {} 
Propose a change to the experimental apparatus that would increase the efficiency.

\item {} 
Verify that your report and graphs meet the requirements.

\end{enumerate}


\section{References}
\label{\detokenize{Gas_Transfer/Gas_Transfer:references}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-references}}\begin{quote}

Weber, W. J. J. and F. A. Digiano. 1996. Process Dynamics in Environmental Systems. New York, John Wiley \& Sons, Inc.Zander, A. K.; M. J. Semmens and R. M. Narbaitz. 1989. \sphinxstylestrong{Removing VOCs by membrane stripping} American Water Works Association Journal 81: 76-81.
\end{quote}


\section{Lab Prep Notes}
\label{\detokenize{Gas_Transfer/Gas_Transfer:lab-prep-notes}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-lab-prep-notes}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Reagent list.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id9}}\label{\detokenize{Gas_Transfer/Gas_Transfer:table-gas-reagent-list}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{60}|\X{20}{60}|\X{10}{60}|\X{10}{60}|}
\hline
\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Supplier
&\sphinxstyletheadfamily 
Catalog number
&\sphinxstyletheadfamily 
Concentration
\\
\hline
\(Na_2SO_3\)
&
Fisher Scientific
&
S430-500
&
100 g/L
\\
\hline
\(CoCl_2 \cdot 6H_2O\)
&
Fisher Scientific
&
C371-100
&
100 mg/L
\\
\hline
\(NaOH\)
&
VWR
&
pending
&
0.05 N = 2 g/L
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{Setup}
\label{\detokenize{Gas_Transfer/Gas_Transfer:setup}}\begin{enumerate}
\item {} 
Prepare the sodium sulfite immediately before class and distribute to groups in 15 mL PP bottles to minimize oxygen dissolution and reaction with the sulfite.

\item {} 
The cobalt solution can be prepared anytime and stored long term.

\item {} 
Install the membranes on the DO probes and confirm that all probes are operational.

\item {} 
Provide clamps to mount DO probes on magnetic stirrers.

\item {} 
Determine maximum airflow rate that is reasonable given small reactor volume.

\item {} 
Configure the TA workstation to be measuring the source air pressure and sharing it using this \sphinxhref{https://github.com/monroews/EnvEngLabTextbook/raw/master/ProCoDA/methods/Gas\_Transfer\_TAbench\_method\_file.pcm}{ProCoDA method}.

\item {} 
Verify that the source air pressure is close to 100 kPa. If it exceeds 120 kPa then ask the building manager to reduce the air pressure.

\end{enumerate}


\section{Clean up}
\label{\detokenize{Gas_Transfer/Gas_Transfer:clean-up}}\begin{enumerate}
\item {} 
DO Probe: unscrew the cap from the probe and wash the electrodes core (cathode: platinum, anode: lead) and the cap with deionized water. Dry all the components with tissue. Screw the cap back to the probe without adding any filling solution to prevent the anode from being consumed. Put all the components back into the package.

\item {} 
Pore water used for aeration into container designated by the TA. We collect this water because of the cobalt contamination.

\item {} 
Do \sphinxstylestrong{not disassemble the aeration system}. Rinse it, dry it and keep it as one unit and place in storage at your workstation.

\end{enumerate}


\section{Airflow Control}
\label{\detokenize{Gas_Transfer/Gas_Transfer:airflow-control}}\label{\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-airflow-control}}
The ProCoDA software can be configured to control the flow of air into the reactor. The hardware required is shown in \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-gas-schematic}}}. The control algorithm is based on the theoretical relationship between head loss and flow rate for the air flowing into the accumulator. We can empirically measure the head loss coefficient and then use the theoretical relationship to determine what fraction of time the influent valve should be open to obtain the desired flow rate. We can use the change in pressure in the accumulator when the influent valve is open to determine how fast air was flowing into the accumulator. In order to develop an appropriate head loss model we need to know if the flow into the accumulator is laminar or turbulent.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_Re}
\begin{split} {Re}=\frac{\rho VD}{\mu }\end{split}
\end{equation}\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:9}
\begin{split}{Re}=\frac{4\rho Q}{\pi d\mu }\end{split}
\end{equation}
If we hold pressure and temperature constant and then take the derivative of the ideal gas law we obtain.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:10}
\begin{split}P\rlap{--}\dot{V}=\dot{n}RT\end{split}
\end{equation}
and since change in volume with respect to time is a flow rate we have
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_Qair}
\begin{split} Q=\frac{\dot{n}RT}{P}\end{split}
\end{equation}
Density of an ideal gas is given by
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_density}
\begin{split} \rho =\frac{PM_{gas} }{RT}\end{split}
\end{equation}
Substituting these relationships into equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_Re} for Reynolds number we obtain
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:11}
\begin{split}{Re}=\frac{4\dot{n}M_{gas} }{\pi d\mu }\end{split}
\end{equation}
For the air flow controller used in the lab the following values are obtained
\begin{quote}

\(\dot{n}\) max flow is about 10,000 \(\mu M/s\) \(M_{gas}\) is 0.029 kg/M, and \(\mu\) is \(1.8 x 10^{-5} Ns/m^2\).
\end{quote}
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:12}
\begin{split}{Re}=\frac{4\left(10000\times 10^{-6} \frac{M}{s} \right)\left(0.029\frac{kg}{M} \right)}{\pi \left(1\times 10^{-3} m\right)\left(1.8\times 10^{-5} \frac{N\cdot s}{m^{2} } \right)} =20,500\end{split}
\end{equation}
The flow into the air accumulator will almost certainly be turbulent. In any case, we can use the turbulent flow equations for minor losses to describe head loss. The equation for minor losses is:
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_minor_losses}
\begin{split} h_{minor} =K\frac{8Q^{2} }{g\pi ^{2} D^{4} }\end{split}
\end{equation}
To use equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_minor_losses} for air we substitute pressure change for \(h_{minor}\), equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_Qair} for flow rate, and equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_density} for density.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_minor_losses_for_gas}
\begin{split} \Delta p=K\frac{8M_{gas} RT\dot{n}^{2} }{\pi ^{2} D^{4} P}\end{split}
\end{equation}
This change of pressure is occurring between the air supply and the accumulator. The pressure, P, in equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_minor_losses_for_gas} helps determine the velocity of the air and thus head loss is a function of the pressure. The pressure varies between the pressure of the lab air supply, \(P_s\), and the pressure in the air accumulator, \(P_a\). As a reasonable first approximation we use the average pressure of the supply and the accumulator for P, the difference in pressure for \(\Delta p\), and solve equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_minor_losses_for_gas} for the molar flow rate.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_molar_flow_of_air}
\begin{split} \dot{n}=\frac{\pi D^{2} }{4\sqrt{KM_{gas} RT} } \sqrt{\left(P_{s} -P_{a} \right)\left(P_{s} +P_{a} \right)}\end{split}
\end{equation}
where \(\dot{n}\) is the molar flow rate.

Multiplying terms and noting that the supply pressure is relatively constant, but that the accumulator pressure varies as it charges according to the ideal gas law we obtain.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:13}
\begin{split}\frac{dn}{dt} =\frac{\pi D^{2} }{4\sqrt{KM_{gas} RT} } \sqrt{P_{s}^{2} -\frac{n^{2} R^{2} T^{2} }{V^{2} } }\end{split}
\end{equation}
Separating terms and integrating from an initial condition with \(n_0\) moles to a final condition with \(n\) moles in the accumulator.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:14}
\begin{split}\frac{\rlap{--}V}{RT} \int _{n_{0} }^{n }\frac{dn}{\sqrt{\frac{P_{s}^{2} V^{2} }{R^{2} T^{2} } -n^{2} } }  =\int _{0}^{t}\frac{\pi D^{2} }{4\sqrt{KM_{gas} RT} } dt\end{split}
\end{equation}
After integrating we obtain the following equation.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:15}
\begin{split}\frac{\rlap{--}V}{RT} \left(\sin ^{-1} \frac{n RT}{P_{s} V} -\sin ^{-1} \frac{n_{0} RT}{P_{s} V} \right)=\frac{\pi D^{2} t}{4\sqrt{KM_{gas} RT} }\end{split}
\end{equation}\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:Gas_Transfer/Gas_Transfer:16}
\begin{split}t=\frac{4\sqrt{KM_{gas} RT} }{\pi D^{2} } \left(\sin ^{-1} \frac{n RT}{P_{s} V} -\sin ^{-1} \frac{n_{0} RT}{P_{s} V} \right)\frac{\rlap{--}V}{RT}\end{split}
\end{equation}
Since we will be measuring the pressure in the accumulator we can now substitute that pressure for the terms containing moles of air to obtain an equation that is in a linear form such that a single term containing K and D can be obtained by linear regression.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_t_fill_accumulator}
\begin{split} t=\frac{4\sqrt{KM_{gas} RT} }{\pi D^{2} } \left(\sin ^{-1} \frac{P_{a } }{P_{s} } -\sin ^{-1} \frac{P_{a_{0} } }{P_{s} } \right)\frac{\rlap{--}V}{RT}\end{split}
\end{equation}
Taking a data set obtained by filling the accumulator, finding the unknown term \(\frac{4\sqrt{KM_{gas} RT} }{\pi D^{2} }\) by linear regression and then plotting the resulting model next to the data we obtain \hyperref[\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-controller-calibration}]{Fig.\@ \ref{\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-controller-calibration}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Airflow_controller_calibration}.png}
\caption{The model describing the filling of the accumulator fits the data very well.}\label{\detokenize{Gas_Transfer/Gas_Transfer:id10}}\label{\detokenize{Gas_Transfer/Gas_Transfer:figure-airflow-controller-calibration}}\end{figure}

The final step is to calculate the fraction of time that the valve must be open in order to obtain a desired flow rate into the accumulator. Take the target air flow rate \(\dot{n}_{target}\) and divide by the molar flow rate given by equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_molar_flow_of_air} to get the fraction of time the valve must be open to get the desired average flow rate.
\begin{equation}\label{equation:Gas_Transfer/Gas_Transfer:eq_Gas_fvalve}
\begin{split} f_{valve} =\frac{\dot{n}_{t\arg et} }{\dot{n}} =\frac{\dot{n}_{t\arg et} }{\frac{\pi D^{2} }{4\sqrt{KM_{gas} RT} } \sqrt{P_{s}^{2} -P_{a}^{2} } }\end{split}
\end{equation}
Equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_fvalve} assumes that inertial effects during flow startup are not significant. Application of equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_fvalve} results in slightly more air being delivered than requested. The reason for this error is that when the valve is closed the volume between the location of the head loss and the valve fills to the pressure of the source. This volume of air quickly discharges through the valve as soon as the valve is opened. This error can be minimized by using small valves and by keeping the head loss orifice as close to the valve as possible.

Equation \eqref{equation:Gas_Transfer/Gas_Transfer:eq_Gas_fvalve} is used by the air flow control.vi to calculate the fraction of time that the valve should be open. The ability of the control algorithm to create a desired flow rate can be measured by setting the flow rate and closing the effluent valves from the accumulator. The result is that the accumulator will gradually fill and as it fills \(f_{valve}\) will gradually increase so the flow rate into the accumulator remains constant. The slope of the pressure vs. time line is proportional to the flow rate.


\chapter{Nutrient Removal with Sequencing Batch Reactors}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:nutrient-removal-with-sequencing-batch-reactors}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:title-nutrient-removal-with-sequencing-batch-reactors}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal::doc}}

\section{Process Control}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:process-control}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:heading-nrp-process-control}}
An introduction to automated process control is available in pages 1681 to 1703 of (Metcalf \& Eddy, Tchobanoglous et al. 2003).


\subsection{Sensors}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:sensors}}
Sensors that are can be used to monitor the status of the sequencing batch reactor include pressure, temperature, dissolved oxygen, pH, and turbidity. The pressure sensors are quite versatile and can be used to measure airflow, water flow, volume of water in the reactor, as well as head loss through the course bubble diffuser.


\section{Measure Oxygen Uptake}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:measure-oxygen-uptake}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:heading-nrp-measure-oxygen-uptake}}
One of the objectives of a wastewater treatment plant is to reduce the Biochemical Oxygen Demand (BOD). The minimum national standard for secondary wastewater treatment is that the average 30-day concentration of \(BOD_5\) be less than 30 mg/L. Biochemical oxygen demand is difficult to measure since it takes 5 days for a test. The long test period also precludes the possibility of using BOD as a control parameter in operating a WWTP. Most WWTPs don’t have the luxury of knowing the concentration of influent BOD. For the NRP the composition and properties of the synthetic feed are known. Thus it should be possible to estimate the BOD removal and the residual BOD by measuring the oxygen uptake rate. Temporarily increasing the oxygen concentration in the sequencing batch reactor, turning the airflow off, and then measuring the decrease in oxygen concentration with time can measure the oxygen uptake rate. The aeration rate with the airflow turned off is insignificant and thus the rate of oxygen consumption is equal to the rate of change of the oxygen concentration.


\section{References}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:references}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:heading-nrp-references}}\begin{quote}

Cicek, N., J. P. Franco, et al. (1998). “Using a Membrane bioreactor to reclaim wastewater.” Journal American Water Works Association 90(11): 105-113.
Metcalf \& Eddy, I., G. Tchobanoglous, et al. (2003). Wastewater Engineering: Treatment and Reuse. New York, McGraw Hill.
Rittmann, B. E. and P. L. McCarty (2001). Environmental Biotechnology: Principles and Applications. New York, McGraw Hill.
R. Mikler, W. Kramer, O. Doblhoff - Dier, K. Bayer (04/07/95) Strategies For Optimal Dissolved Oxygen (Do) Control \sphinxurl{https://doi.org/10.1016/B978-0-08-042377-7.50059-3}
\end{quote}


\section{Lab Setup}
\label{\detokenize{Nutrient_Removal/Nutrient_Removal:lab-setup}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:heading-nrp-lab-setup}}
For 6 weeks of operation of 4 plants prepare 20 L of 100x organic stock. Mix in a 20 L Jerrican and use a power mixer inserted through the opening to mix after the addition of each chemical. Store 100x stock in a refrigerator.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{List of chemicals needed for synthetic waste}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:id1}}\label{\detokenize{Nutrient_Removal/Nutrient_Removal:table-synthetic-waste}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{105}|\X{20}{105}|\X{20}{105}|\X{20}{105}|\X{20}{105}|\X{5}{105}|}
\hline
\sphinxstyletheadfamily 
Compound
&\sphinxstyletheadfamily 
Chemical Formula
&\sphinxstyletheadfamily 
Molecular Weight (g/mol)
&\sphinxstyletheadfamily 
Concentration (mg/L)
&\sphinxstyletheadfamily 
total grams required (g)
&\sphinxstyletheadfamily 
stock
\\
\hline
Starch
&&
40,000
&
84.40
&
162.048
&
1
\\
\hline
Casein
&&
30,000
&
125.00
&
240
&
1
\\
\hline
Sodium acetate
&
\(C_2H_3O_2Na \cdot 3H_20\)
&
136.1
&
31.90
&
61.248
&
1
\\
\hline
Capric acid
&
\(C_{10}H_{20}O_2\)
&
172.3
&
11.60
&
22.272
&
1
\\
\hline
Ammonium chloride
&
\(NH_4Cl\)
&
53.5
&
75.33
&
144.6336
&
1
\\
\hline
Potassium phosphate
&
\(K_2HPO_4\)
&
174.2
&
6.90
&
13.248
&
1
\\
\hline
Sodium hydroxide
&
\({NaOH}\)
&
40.0
&
1.75
&
3.36
&
1
\\
\hline
Glycerol
&
\(C_3H_8O_3\)
&
92.1
&
12.00
&
23.04
&
1
\\
\hline
Magnesium sulfate
&
\(MgSO_4 \cdot 7H_2O\)
&
246.5
&
69.60
&
133.632
&
2
\\
\hline
Sodium molybdate
&
\(NaMoO_4 \cdot 2H_2O\)
&
241.9
&
0.15
&
0.288
&
2
\\
\hline
Manganese sulfate
&
\(MnSO_4 \cdot H_2O\)
&
169.0
&
0.13
&
0.2496
&
2
\\
\hline
Cupric sulfate
&
\(CuSO_4 \cdot 4H_2O\)
&
249.7
&
0.08
&
0.1536
&
2
\\
\hline
Zinc sulfate
&
\(ZnSO_4 \cdot 7H_2O\)
&
287.5
&
0.48
&
0.9216
&
3
\\
\hline
Calcium chloride
&
\(CaCl_2 \cdot 2H_2O\)
&
147.0
&
22.50
&
43.2
&
3
\\
\hline
Iron chloride
&
\(FeCl_3 \cdot 6H_2O\)
&
270.3
&
18.33
&
35.1936
&
3
\\
\hline
Cobalt chloride
&
\(CoCl_2 \cdot 6H_2O\)
&
237.9
&
0.42
&
0.8064
&
3
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\chapter{ProCoDA: Process Control and Data Acquisition}
\label{\detokenize{ProCoDA/ProCoDA:procoda-process-control-and-data-acquisition}}\label{\detokenize{ProCoDA/ProCoDA:title-procoda}}\label{\detokenize{ProCoDA/ProCoDA::doc}}

\section{Abstract}
\label{\detokenize{ProCoDA/ProCoDA:abstract}}
ProCoDA is easily configured process control and data acquisition software and hardware that significantly enhances experimental evaluation of unit processes and that permits fully automated parametric studies. The \sphinxhref{https://github.com/monroews/LabVIEW/wiki/ProCoDA}{ProCoDA software} is a LabVIEW executable and incorporates sensors, states, rules, an external microprocessor for controls, the ability to link to external LabVIEW code to add new features, and data logging. The composite system is flexible and user friendly. First year undergraduates have used the software to control a bench top drinking water treatment plant and both undergraduate and graduate students have used the software to conduct parametric studies of methane generation, the activated sludge process, flocculation, and porous media filtration. The system offers the user the ability to program an entire series of experimental runs including variation of a parameter over a series of values and inclusion of replicate tests to confirm repeatability of the results. The automated parametric testing has greatly increased our ability to study the response of complex systems. Evaluation of colloidal particle flocculation and porous media filtration in bench-scale experiments are presented here as example applications of the ProCoDA software.


\section{Introduction}
\label{\detokenize{ProCoDA/ProCoDA:introduction}}
Process control is commonly used in undergraduate teaching laboratories in electrical and mechanical engineering with an emphasis on the PID (proportional, derivative, integral) control algorithm (Braatz and Johnson, 1998). Process control laboratory experiences typically focus on control of a single parameter such as flow rate, temperature, liquid level, pressure (Rehg et al., 1999), or motor angular velocity (Choi, 2004). Control of real processes generally requires integration of individual process control components into a larger system that includes data acquisition and data logging, as well as the concepts of process state and operating rules. Although researchers have frequently created customized process control code for specific applications ProCoDA is a highly configurable system that can be used to automate the control of parametric experiments or complex processes.

Experimental work is often characterized by repetitive experiments and the need for an individual to configure each of those experiments and then measure and record the data. In the case of engineered environmental systems we are often interested in optimizing the performance of unit processes and exploring the response of processes to a range of inputs. It is often necessary to cycle a selected process through a sequence of operational stages or states, to change process related variables, and to subject the process to a range of inputs. For example, operation of porous media filtration requires implementation of backwash, optional pretreatment, and particle challenge states. Filtration process variables might include flow velocities or the duration of a state, and inputs might include variation in the type and concentration of colloidal particles or coagulant type and dose. In conventional jar tests an experimenter would evaluate flocculation efficiency based on the turbidity of settled water or measure the critical sedimentation velocity by taking a batch sample of the flocs and measuring the turbidity as the sample settles. The measurement of settled water turbidity requires first loading the sample vial with flocs, then measuring turbidity as the flocs settle, and finally purging the sample vial with clean water. Although the states to control porous media filtration and to measure the effectiveness of flocculation could be implemented by a human operator, they are well suited for automation.

We have taken the automation components that are commonly used to control industrial and municipal processes and adapted them for use in the laboratory. Our objective was to create process control software that was highly configurable and link it to sensors and outputs for control. The \sphinxhref{https://github.com/monroews/LabVIEW/wiki/ProCoDA}{ProCoDA software} began as data acquisition software capable of remote monitoring of experiments with easily configured sensors. The ability to control on/off devices (valves, pumps, mixers, etc.) and the ability to control continuously variable devices such as a variable flow peristaltic pumps was then added. The process control and data acquisition components were integrated and a user friendly programming environment that is highly configurable was created that incorporates the concepts of states, rules, constants, variables, and customizable external functions.

The guiding principle in developing the ProCoDA code was to create an application that was general and easily configured to handle a wide variety of challenges. Thus the code is not designed for a particular unit process. The goal of designing code that was highly adaptable required implementing features that make it possible for users to customize the software for specific tasks. The ProCoDA software includes a built in programming environment for defining variables, constants, and sensors and for writing the logic that controls moving from one process state to the next. To extend the capabilities of the software without making the interface overly complex the ability to use external code to define new functions was added. Examples of external code that we have used to extend the capabilities of the ProCoDA software include proportional integral derivative control algorithms, acquisition of data from turbidimeters and electronic balances over USB ports, functions that incrementally vary a parameter over a specified range and functions that take a flow rate and tubing size and calculate the peristaltic pump speed.

The \sphinxhref{https://github.com/monroews/LabVIEW/wiki/ProCoDA}{ProCoDA software} was written using LabVIEW. The high level predefined functions, the ease of developing graphical user interfaces, and the integration with input and output devices made LabVIEW the preferred programming environment. In addition to the software we designed hardware interfaces to simplify the use of sensors and controls.

The \sphinxhref{https://github.com/monroews/LabVIEW/wiki/ProCoDA}{ProCoDA software} runs five parallel processes during normal operation. The five processes are:
\begin{enumerate}
\item {} 
Data acquisition from the ProCoDA hardware

\item {} 
Calculation of output values, processing of rules to determine state changes, sending commands to the ProCoDA hardware, and logging of state changes and the rule that caused the state to change

\item {} 
Data logging of sensor data as well as all user defined variables

\item {} 
Graphical display of all sensor data as well as all user defined variables

\item {} 
An event loop that responds to 20 user events to initiate processes such as sensor configuration, rule editing, pump calibration, and hardware selection.

\end{enumerate}

The parallel processes are asynchronous and share data through the use of code objects (LabVIEW SubVIs) that contain both data and methods.

A core feature of the ProCoDA software is the user programmable feature that facilitates customization of the control logic for specific tasks. The rule editor provides a programming environment for setting up states, control logic, set points, variables defined by links to external code, and selecting which user defined parameter controls each output in each state.

Sensor signal wires and power supply connections have been integrated in a single cable to make sensors easy to use in a student laboratory environment. The sensors use a standardized wiring scheme so that a variety of sensors can be used in a connect-calibrate-measure approach. The elimination of power supplies at each experiment location and all of the associated wiring has made sensor use easy for students. The process control software interface for sensors allows adding and configuring sensors while simultaneously collecting data.

The ProCoDA hardware/software can vary the state of on/off devices as well as control devices that require a 4-20 mA signal. The on/off outputs are 24 V with sufficient current to operate small solenoid valves or to switch relays for controlling the power to any number of devices. The 4-20 mA analog outputs are used to control peristaltic pumps. External code is already provided for communication with digital devices including HF scientific turbidimeters, HF scientific AccUView UV meter. We also have external code to control digital peristaltic pumps using Modbus. Other Modbus devices can easily be added.

ProCoDA software allows the user to automate data collection and to control many parts of the experimental apparatus. This enables researchers to focus on experimental design and data analysis. Process control software can control the speed of peristaltic pumps, regulate flow through solenoid valves, and measure (or control with feedback) water quality parameters such as temperature, pressure, and dissolved oxygen.

The ProCoDA software is designed to allow complete automation of experiments including running a series of tests where a parameter is adjusted to a different value for each test. ProCoDA is a state machine. That means that you can create a series of states. Each state has it’s own logic for which state to go to next and what to do while in that state. A simple example of a state machine is a washing machine. Washing machine states could include


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Washing machine states}\label{\detokenize{ProCoDA/ProCoDA:id8}}\label{\detokenize{ProCoDA/ProCoDA:table-procoda-washing-machine-states}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{5}{25}|\X{10}{25}|\X{10}{25}|}
\hline
\sphinxstyletheadfamily 
State
&\sphinxstyletheadfamily 
What it does
&\sphinxstyletheadfamily 
Exit rule
\\
\hline
Fill
&
Fills tub with selected amount of water at the requested temperature
&
Switch to \sphinxstyleemphasis{Agitate} state when pressure sensor reaches target value
\\
\hline
Agitate
&
Agitate to clean clothing
&
Switch to \sphinxstyleemphasis{Spin to remove dirty water} after target time is reached
\\
\hline
Spin to remove dirty water
&
open drain and spin
&
Switch to \sphinxstyleemphasis{Rinse} after target time is reached
\\
\hline
Rinse
&
Add water to target level while agitating
&
Switch to \sphinxstyleemphasis{Spin dry} when target time is reached.
\\
\hline
Spin dry
&
Spin and drain water
&
Switch to \sphinxstyleemphasis{off} when target time is reached.
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
Setpoints: There are two types of setpoints in ProCoDA, constants and variables. These are the numbers that ProCoDA uses to run any of its functions (These are things like warm or cold water temperatures)

\item {} 
States: States are the different ways ProCoDA can run (These are the steps of a laundry cycle like agitate, rinse, spin)

\item {} 
Rules: These control when ProCoDA changes between states (These are like going from rinse to spin)

\end{itemize}


\subsection{General Notes}
\label{\detokenize{ProCoDA/ProCoDA:general-notes}}\begin{itemize}
\item {} 
When you input a value that it a decimal it will convert it into a form without the decimal (i.e. 0.3 will become 300m)

\item {} 
The default unit of time is seconds and we recommend using seconds consistently.

\item {} 
ProCoDA doesn’t actually use units internally. The units are only used for documentation. It is the users responsibility to make sure that you are using a consistent set of units.

\item {} 
The required set points give the order of the set points and the set points must be in the same order when you input them. The set points do not need to be contiguous! They just need to be in the correct order.

\item {} 
All added set points must be added after ON and OFF,

\item {} 
As a general rule, add new set points and states at the bottom of the list. This is because ProCoDA only tracks set points and states as elements in an array and thus if the array elements are shifted ProCoDA will refer to the wrong element.

\end{itemize}

The hardware consists of box with a National Instruments data acquisition board that connects to the computer via a USB port. The box has 12 ports.
\sphinxincludegraphics{{ProCoDA_ports}.png}
\begin{enumerate}
\item {} 
pump 0 and 1: Ports that control on/off, direction, and speed of peristaltic pumps. The on/off and direction controls are based on digital outputs from the data acquisition board. The speed control uses an analog output from the data acquisition board that is converted into a 4-20 mA signal.

\item {} 
sensor 0 to 3 measure voltages from sensors. The ports also contain +5V, -5V, +10V, +15V, -15V power supplies that are used to power sensors (pressure, photometer) or is used to power signal conditioning circuits that are required by some sensors (pH, dissolved oxygen, temperature, photometer).

\item {} 
24V 2 to 7 provide 24 volt outputs that can be used to power solenoid valves or relays that can then power larger electrical loads.

\end{enumerate}

The distinction between \sphinxstylestrong{inputs and outputs} is \sphinxstylestrong{critical}. The pump and 24V ports are all outputs. They \sphinxstylestrong{control devices}. The sensor ports are inputs that are used to \sphinxstylestrong{measure}. Don’t plug sensors into outputs! Don’t plug pumps into 24 volt ports or into sensors! Don’t plug solenoid valves into pump or sensor ports! Don’t confuse in and out!

In addition to the devices that connect to the ProCoDA hardware it is possible to connect devices on a Modbus network or devices that can connect to a serial or USB port. The Modbus devices (connect to a RS 485 adaptor connected to a serial or USB port). \sphinxincludegraphics{{RS485_adaptor}.png}

The software combines 3 elements: sensors (inputs from the real world), set points (inputs from the plant operator and calculated values based on sensors and other set points), and logic (rules that govern how the plant should operate given the sensor data and set points). The software contains a graphical user interface where you can edit, save, and open files containing sensor information and files containing the set point and logic information.


\section{Data Acquisition}
\label{\detokenize{ProCoDA/ProCoDA:data-acquisition}}
The ProCoDA software is designed to receive data from two types of digital sources. Sensors or meters that have their own digital communication interface can transmit their data to the ProCoDA software through external code that is written specifically for each meter. For example this method is used to acquire data from HF Scientific turbidimeters. Sensors that can be configured to produce an analog voltage such as pressure, pH and dissolved oxygen are monitored with a National Instruments USB data acquisition board.

Sensors are wired using Category 5 or 6 Ethernet cable using our own {\hyperref[\detokenize{ProCoDA/ProCoDA:table-procoda-sensor-wiring}]{\sphinxcrossref{\DUrole{std,std-ref}{analog}}}} wiring standard. Two wires are used to carry the sensor output voltage designated as S- and S+. Five wires are used for different voltage power supplies, and one wire is used for the power supply ground. Sensors are wired to connect to the power supply that they require. Thus, the sensor is powered and monitored through a single port. This scheme is used for a variety of sensors including pressure, strain gage, pH, dissolved oxygen, photometer, and temperature. For several of the sensors the power supplies are also used to power a signal conditioning circuit to transform the sensor output into a voltage that can easily be monitored with a data acquisition system.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Wiring standard used for combining power supplies and analog data acquisition in a Category 5 Ethernet cable}\label{\detokenize{ProCoDA/ProCoDA:id9}}\label{\detokenize{ProCoDA/ProCoDA:table-procoda-sensor-wiring}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{60}|\X{20}{60}|\X{20}{60}|}
\hline
\sphinxstyletheadfamily 
T-568B standard
&\sphinxstyletheadfamily 
T-568A standard
&\sphinxstyletheadfamily 
voltage
\\
\hline
white/orange
&
white/green
&
S-
\\
\hline
white/green
&
white/orange
&
ground
\\
\hline
white/brown
&
white/brown
&
-15 V
\\
\hline
white/blue
&
white/blue
&
+5 V
\\
\hline
orange
&
green
&
S+
\\
\hline
green
&
orange
&
+10 V
\\
\hline
brown
&
brown
&
+15V
\\
\hline
blue
&
blue
&
-5 V
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{Configure}
\label{\detokenize{ProCoDA/ProCoDA:configure}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-configure}}
The configure tab of ProCoDA is used to select the ProCoDA box that will be controlled by the software. It is possible to connect more than one ProCoDA box to a single computer and have multiple instances of the ProCoDA software running at the same time. But that is a capability that we haven’t truly tested and most users want to control a single experiment with one ProCoDA box.

Select the \sphinxincludegraphics{{config_select_daq}.png} to select the ProCoDA box and to configure the data acquisition.  \sphinxincludegraphics{{config_DAQ}.png} The available analog input (AI) channels (for sensors) are displayed along with the maximum voltage that can be measured. Most of our sensors have an output voltage of less than 1 volt and thus the maximum voltage can be set to 1 volt. The exception is the photometer that has an output maximum voltage of 5 V.

ProCoDA keeps a small amount of data in memory at all time that can be used for making decisions. This is critical because sensors area always noisy and thus it is poor practice to make decisions based on instantaneous measurements. Instead we use an average of recent data and select the amount of averaging based on the requirements for the control system. The length (in seconds) of the data record that is available in the buffer is set by the size of the buffer and the rate of sampling. The highest rate of sampling is 2500 Hz. We recommend that sampling be as fast as possible and that data averaging be used to smooth the data.

Data averaging is implemented by pressing the spacebar and then editing the number of samples per read. In the example below we have set samples per read to 10. In this case the data is read at 250 Hz in 10 sample chunks. Each chunk of 10 samples is averaged on its way into the ProCoDA program. Thus the data is smoothed and results in less noisy signals.
\sphinxincludegraphics{{config_samples_per_read}.png}

The ProCoDA circuitry that sets the peristaltic pump speed can be calibrated (in software) with \sphinxincludegraphics{{config_calibrate_pump}.png}. This calibration ensures that the pump actually rotates at the speed set by ProCoDA. This calibration only needs to be done once for each pump that is controlled.

ProCoDA has the ability to access data from other ProCoDA software on other computers if there is a shared server where the data can be shared. This data sharing \sphinxincludegraphics{{config_share_data}.png} makes it possible for multiple users to have access to data that is being logged at one location. In the AguaClara laboratory researchers can access the laboratory water temperature using this system. In the Environmental Engineering teaching laboratory this feature is used to enable all of the workstations to access the pressure of the air supply that is used for the gas transfer experiments.


\subsection{Methods}
\label{\detokenize{ProCoDA/ProCoDA:methods}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-methods}}
ProCoDA is highly configurable (it is after all, a friendly programming environment for laboratory automation) and those configurations or methods are saved in files. ProCoDA automatically saves ALL changes in configuration as they happen in \sphinxcode{\sphinxupquote{C:\textbackslash{}ProCoDA Data\textbackslash{}ProCoDA 0.pcm}} where the integer refers to the instance of the ProCoDA software if multiple instances are being used. This method file is automatically loaded when ProCoDA is launched. Very occasionally ProCoDA crashes and creates a corrupted method file and thus refuses to launch properly. In that case simply delete this file.

Given that ProCoDA automatically saves the method file that means that any mistakes in editing are immediately saved as well. To safeguard against this ProCoDA also saves a copy of the method file in the folder location where the data is being logged. We recommend that copies of the ProCoDA method also be saved in a secure location by the researcher as a third level of safety. Use the \sphinxincludegraphics{{Config_open_save_export1}.png} buttons to save the current method, retrieve a method from file, or export the method in a tab delimited file in a human readable format.


\section[Sensors]{Sensors \lowercase{\sphinxincludegraphics}{{config_sensors1}.png}}
\label{\detokenize{ProCoDA/ProCoDA:sensors-config-sensors}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-sensors}}
Monitoring sensors requires conversion of the measured voltage into a physically meaningful unit. The data acquisition module of the ProCoDA software uses conversion files to implement a variety of conversion algorithms including polynomials and correspondence tables as well as the calibration algorithms required for pH, dissolved oxygen, and photometers. The pressure sensor conversion files make it easy to use pressure sensors to measure pressures in various physical units, to measure reactor volumes (of known cross sectional area), and flow rates (through devices with known relationships between flow and pressure drop). In addition to the application of a conversion to a physical unit it is possible to calibrate the pressure sensor output to a specific value by changing an offset.

The sensor part of ProCoDA includes software that eliminates the need for pH meters, dissolved oxygen meters, temperature meters. A software interface for a single wavelength photometer is also included. Any sensor that has a voltage output can be monitored.

Add a sensor to the list of sensors by either inserting a new unconfigured sensor, \sphinxincludegraphics{{sensor_insert}.png}, or by selecting a configured sensor that you want to duplicate, \sphinxincludegraphics{{sensor_copy}.png}. The \sphinxincludegraphics{{sensor_copy}.png} will automatically increment the channel that the sensors are connected to. You can always \sphinxincludegraphics{{sensor_delete}.png} any channels that you don’t want.

Each sensor must be connected to a sensor port \sphinxincludegraphics{{ProCoDA_ports}.png} using
\sphinxincludegraphics{{sensor_channels}.png}. Note that it is possible to monitor the same port more than once using ProCoDA. This would be useful if you wanted to simultaneously log both the raw voltage and a calibrated physical unit from the same sensor. This would be particularly useful if you want the option to change the conversion from voltage to physical units.

Sensor that have simple linear relationships between voltage and calibrated output can be easily adjusted \sphinxincludegraphics{{sensor_linear_offsets}.png}. For example, a pressure sensor can be calibrated by setting its output to an independently measured value \sphinxincludegraphics{{sensor_set_to_value}.png}. Or the pressure could be zeroed \sphinxincludegraphics{{sensor_set_to_zero1}.png} under conditions of no flow (if you are measuring head loss). The offsets can be cleared, \sphinxincludegraphics{{sensor_clear_offsets}.png}, to return to the original uncalibrated sensor output.

The \sphinxincludegraphics{{sensor_edit_calibration}.png} can be used to view how the voltage is being converted to a physical unit. This makes it possible to edit the conversion values and can be used to create conversion files for new sensors. New conversion files can be saved \sphinxincludegraphics{{sensor_save_calibration_file1}.png} for use later.

One of the failure modes with ProCoDA occurs when a sensor produces a voltage that is outside of the range \sphinxincludegraphics{{sensor_range_error}.png} that was set when configuring the data acquisition board (see {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-configure}]{\sphinxcrossref{\DUrole{std,std-ref}{ProCoDA Configure}}}}). It is critical that the sensor voltage not be out of range. Sensors that are out of range provide useless data! Your goal is to see \sphinxincludegraphics{{sensor_no_range_error}.png}.


\subsection{Pressure Measurement}
\label{\detokenize{ProCoDA/ProCoDA:pressure-measurement}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-pressure-measurement}}
We use 1 psi (7 kPa) and 30 psi (200 kPa) pressure sensors (Omega sensor models PX26-001DV, and PX26-030DV) in our laboratory to measure water depth, reactor volumes, flow rates, and head loss. These sensors have maximum output voltages of 16.7 mV and 100 mV respectively with a power supply of 10 V. We use the differential pressure model since the sensors can be used to measure gage pressure or differential pressure. The sensors can directly measure water pressure although the electrical connections \sphinxstylestrong{must be kept dry}.
The ProCoDA software converts the voltage output from the pressure sensors into the physical units of water column height or pressure using linear conversion algorithms. The sensors can also be zeroed or set to a measured value using a one point calibration.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{pressure_sensor}.jpg}
\caption{Differential pressure sensors are used to measure water depth, head loss, and air pressure.}\label{\detokenize{ProCoDA/ProCoDA:id10}}\label{\detokenize{ProCoDA/ProCoDA:figure-pressure-sensor}}\end{figure}

Steps to set up a pressure sensor.
\begin{enumerate}
\item {} 
Navigate to the Configuration tab

\item {} 
Click the \sphinxincludegraphics{{config_sensors1}.png} button to select and configure your sensor (thermistor).

\item {} 
Click \sphinxincludegraphics{{sensor_insert}.png} to add a sensor to your list.

\item {} 
Now you need to tell ProCoDA where he pressure sensor is plugged in.  In the \sphinxincludegraphics{{sensor_channels}.png} pull-down menu, select the address of the pressure sensor.

\item {} 
Finally, you need to tell the software to convert the signal into a pressure.  This is done with a calibration file.  Click \sphinxincludegraphics{{sensor_open_calibration_file}.png} and select the folder named with the pressure range of the sensor you are using. Then select the pressure units you would like to use.

\item {} 
You should now be reading pressure. Verify that the pressure sensor is working by gently pushing on one of the pressure ports. The goal is shove some of your skin into the port to increase the pressure! One port should respond with a positive pressure and the other port should respond with a negative pressure.

\item {} 
Use what you learned about positive and negative ports to make sure that you connect the pressure sensor to your experimental apparatus correctly.

\end{enumerate}


\subsection{Temperature Measurement}
\label{\detokenize{ProCoDA/ProCoDA:temperature-measurement}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-temperature-measurement}}
We use a linear temperature sensor coupled with a simple voltage dividing circuit such as the Omega sensor model OL703. The voltage output is converted to a temperature using a linear equation.
\begin{enumerate}
\item {} 
Navigate to the Configuration tab

\item {} 
Click the \sphinxincludegraphics{{config_sensors1}.png} button to select and configure your sensor (thermistor).

\item {} 
Click \sphinxincludegraphics{{sensor_insert}.png} to add a sensor to your list.

\item {} 
Now you need to tell the software where your sensor is plugged in.  In the \sphinxincludegraphics{{sensor_channels}.png} pull-down menu, select the address of your sensor.  All addresses begin with a Dev/ai prefix. The number in the address refers to the number on thd

\item {} 
Finally, you need to tell the software to convert the signal into temperature units.  This is done with a calibration file.  Click \sphinxincludegraphics{{sensor_open_calibration_file}.png} and select the calibration file named thermistor.smc.

\item {} 
You should now be reading temperature in units of degrees Celsius. Verify that you are monitoring the correct temperature probe by holding the temperature probe in your hand and warming it up.  Does the temperature reading respond?

\end{enumerate}


\subsection[pH Measurement]{pH Measurement \lowercase{\sphinxincludegraphics}{{sensor_pH}.png}}
\label{\detokenize{ProCoDA/ProCoDA:ph-measurement-sensor-ph}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-ph-measurement}}
pH sensors produce a voltage output in the range that would normally be easy to measure using standard data acquisition hardware. Unfortunately, the impedance requirement for a pH sensor is orders of magnitude higher than the inputs of standard data acquisition hardware and thus a signal conditioning circuit must be used to amplify the pH sensor output. The circuit consists of unity gain amplifiers that have less than 0.1 pA input leakage current.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{pH_circuit}.png}
\caption{Circuit diagram for the signal conditioning circuit that takes the output from a pH (or other ion selective) electrode and amplifies the signal so that it can be measured by the data acquisition system. This is required because pH probes have a very high impedance that is too high for standard data acquisition systems to measure.}\label{\detokenize{ProCoDA/ProCoDA:id11}}\label{\detokenize{ProCoDA/ProCoDA:figure-ph-circuit-png}}\end{figure}

pH measurements require calibration in known buffers.
\begin{enumerate}
\item {} 
Open the ProCoDA II software.

\item {} 
Navigate to the Configuration tab and select the \sphinxincludegraphics{{config_sensors1}.png} button.

\item {} 
Insert a new sensor at the bottom of the sensor list using the \sphinxincludegraphics{{sensor_insert}.png} button.

\item {} 
Select the appropriate channel based on in which sensor port you plugged you pH probe.

\item {} 
Select \sphinxincludegraphics{{sensor_pH}.png}.

\item {} 
The pH probe should never be dry and is therefore stored with a small vial of pH 4.0 buffer screwed onto the tip.  Unscrew the storage vial cap and place the vial in a place where it will not be tipped over (the cap can stay on the probe).

\item {} 
Rinse the pH probe with DI water (use a squeeze bottle) into a beaker.

\item {} 
To calibrate the pH probe, we will use three pH buffer solutions with known pH (red=4.0, yellow=7.0, and blue=10.0).  After rinsing the pH probe, place it into the pH=4.0 buffer.  Stir gently and wait for the pH reading on the software to stabilize.  Once stabilized, press the \sphinxincludegraphics{{pH_add_buffer}.png} button.  Rinse the pH probe with DI water and repeat for the pH=7.0 and pH=10.0 buffer solutions.

\item {} 
When you have tested all calibration buffers, click, OK to exit \sphinxincludegraphics{{sensor_pH}.png}. Click OK again to exit \sphinxincludegraphics{{config_sensors1}.png}.

\end{enumerate}

The \sphinxincludegraphics{{pH_add_buffer}.png} option is used if you have additional buffers that you want to use to calibrate a pH probe. The list of buffers can also be cleared, \sphinxincludegraphics{{pH_clear_buffers}.png}, and recreated by adding new buffers.


\subsection{Gran Plot}
\label{\detokenize{ProCoDA/ProCoDA:gran-plot}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-gran-plot}}
The Gran plot is used to measure the acid neutralizing capacity or the alkalinity of a water sample.
\begin{enumerate}
\item {} 
Open the ProCoDA II software.

\item {} 
navigate to configuration, select \sphinxincludegraphics{{config_sensors1}.png}, select \sphinxincludegraphics{{sensor_pH}.png}, and click on \sphinxincludegraphics{{Gran_start}.png}.

\item {} 
You will be prompted for the normality of titrant and the volume of sample.  You can also choose to measure ANC (acid neutralizing capacity) or BNC (base neutralizing capacity). If you are measuring BNC you will need to titrate with a strong base. After entering the normality of acid (or base) and the sample volume the computer will suggest an incremental volume of titrant that will produce a good Gran plot. Smaller incremental titrant volumes can be used, but will require more time to titrate the sample. After entering the values, exit the dialog box by clicking on the OK button. It will look like this: \sphinxincludegraphics{{Gran_get_titration_values}.png}

\item {} 
The Gran Plot analysis uses 3 controls: \sphinxincludegraphics{{Gran_incremental_titrant}.png}, \sphinxincludegraphics{{Gran_accept_pH}.png}, and \sphinxincludegraphics{{Gran_end_titration}.png}. The “incremental titrant added” \sphinxincludegraphics{{Gran_incremental_titrant}.png} is the amount of acid added since the previous time the \sphinxincludegraphics{{Gran_accept_pH}.png} button was clicked. For the first data point if no titrant was added the “incremental titrant added” should be set to zero. For subsequent readings, change the incremental titrant added to the volume you are adding, add the titrant with a digital pipette, wait for the pH to stabilize and then click on \sphinxincludegraphics{{Gran_accept_pH}.png}. Any amount of titrant can be added at each step, but it is important that below pH 5 the titrant volumes be smaller than the recommended value so that sufficient data points are obtained in the linear region.

\item {} 
There is no way to delete unwanted data points after they are accepted. Therefore, make sure you only press the enter button once after each addition of titrant.

\item {} 
Continue adding titrant until a line is fit through the linear region of the data. When the line is drawn through the linear region press \sphinxincludegraphics{{Gran_end_titration}.png}. Note that \sphinxincludegraphics{{Gran_end_titration}.png} accepts the last data point and ends the titration. \sphinxincludegraphics{{Gran_end_titration}.png} is pressed after the last addition of acid INSTEAD of pressing \sphinxincludegraphics{{Gran_accept_pH}.png}!

\item {} 
The equivalent volume (\(V_e\)) is given in the same units as were used for the titrant and sample volumes. The equivalent volume is the abscissa intercept of the line fit to the data in the region of constant slope. The ANC is given in equivalents per liter.

\item {} 
If desired the titration data can be saved in tab delimited format by selecting  \sphinxincludegraphics{{Gran_save1}.png}. You will be prompted for a file name and location.

\end{enumerate}


\subsection[Dissolved Oxygen]{Dissolved Oxygen \lowercase{\sphinxincludegraphics}{{sensor_DO}.png}}
\label{\detokenize{ProCoDA/ProCoDA:dissolved-oxygen-sensor-do}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-dissolved-oxygen}}
Dissolved oxygen diffuses across a gas-permeable membrane into a solution where all oxygen is immediately converted to water by an electrolysis circuit.
\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:0}
\begin{split}4e^- + 4H^+ + O_2 \to 2H_2O\end{split}
\end{equation}
The current required to reduce the oxygen that is diffusing across the membrane is measured by a circuit. Dissolved oxygen probes produce a current in the pA range that is proportional to the oxygen concentration in the bulk solution. The signal conditioning circuit is designed to convert this very small current into a measurable voltage and to isolate the probe from the effects of fluctuations in the voltage level of the solution containing the probe. This isolation is critical if the solution is monitored with additional probes or if the solution is electrically connected to a building plumbing system or to any other voltage source.

When using the DO probe make sure that there \sphinxstyleemphasis{aren’t any air bubbles} on the probe membrane. If you are aerating the sample place the probe as far from the air bubbles as possible. Air bubbles on the membrane will cause inaccurate readings.
\begin{enumerate}
\item {} 
The dissolved oxygen probe will read out voltages in the range of +/- 5V, so we will need to let the software know to expect that range. On the Configuration Tab in the ProCoDA II software, find the section for the NI Input/Output device and hit the \sphinxincludegraphics{{config_select_daq}.png} button. Set the maximum voltage for channel with the dissolved oxygen probe to 5V.

\item {} 
Connect a Gravity: Analog Dissolved Oxygen Sensor to one of the sensor ports on the ProCoDA box.

\item {} 
Navigate to the ProCoDA Configuration tab and select \sphinxincludegraphics{{config_sensors1}.png} to configure the dissolved oxygen channel(s).

\item {} 
\sphinxstylestrong{Select the DO probe from the sensor list} (This is important! Otherwise you will turn a different sensor into a DO probe!) and point the channel to the correct sensor port.

\item {} 
Click on \sphinxincludegraphics{{sensor_DO}.png} to calibrate the DO probe.

\item {} 
Enter the temperature of the sample. This can be measured by using a thermistor or a thermometer. A good estimate is \(22^\circ C\). If you have a thermistor connected to ProCoDA you can configure the oxygen probe to incorporate continuous temperature readings into the calculation of the dissolved oxygen concentration.

\item {} 
Create a zero oxygen solution (50 mL is sufficient) by adding \(10 \mu g/L\) cobalt chloride as a catalyst and an excess of {\hyperref[\detokenize{Gas_Transfer/Gas_Transfer:heading-gas-transfer-deoxygenation}]{\sphinxcrossref{\DUrole{std,std-ref}{sodium sulfite}}}} to react with all of the dissolved oxygen.

\item {} 
Wait for the probe voltage readings to stabilize. They should reach approximately -1.3 V.  Then click on \sphinxincludegraphics{{DO_zero}.png}.

\item {} 
The current atmospheric pressure is required so that ProCoDA can calculate the equilibrium concentration in saturated water. The local air pressure can be obtained from the \sphinxhref{https://www.weather.gov}{National Weather Service} Be careful with the units when you enter the value in \sphinxincludegraphics{{DO_set_barometric}.png}. Atmospheric pressure is always close to 100 kPa.

\item {} 
Place the probe in oxygen saturated water (bubble air into water in a small container).  The voltage from the DO probe should be approximately \(0 \pm 0.2 V\) if the probe is working correctly. If the voltage is not in that range it may be time to replace the membrane or the solution may not be saturated with oxygen.

\item {} 
Select \sphinxincludegraphics{{DO_set_to_saturation}.png} to calibrate the DO sensor.

\item {} 
Select OK when you are satisfied with the calibration.

\item {} 
If desired you may save the calibration for later use \sphinxincludegraphics{{sensor_save_calibration_file1}.png}. However, it is not necessary to save the calibration to use the calibration because it is automatically saved as part of the ProCoDA method file..

\end{enumerate}


\subsection[Photometer]{Photometer \lowercase{\sphinxincludegraphics}{{sensor_photometer}.png}}
\label{\detokenize{ProCoDA/ProCoDA:photometer-sensor-photometer}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-photometer}}
The photometer is a flow cell with an optical path length of 19 mm. The flow cell has 1/8 inch NPT threads for connections to experimental or sample streams from processes. The photometer uses a KingBright LED (Digikey part 754-1489-ND) with an emission peak at 465 nm as its light source. The spectral bandwidth defined by 50\% of the dominant wavelength is 25 nm.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{n}{b\PYGZus{}cell} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{b\PYGZus{}cell}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Photometer_exploded1}.jpg}
\caption{The photometer flow cell is a sealed chamber with round glass plates on both sides. There is a 465 nm LED (blue light) on the right of this image. A photodetector on the left produces a voltage that varies linearly with the intensity of the light that passes through the sample cell.}\label{\detokenize{ProCoDA/ProCoDA:id12}}\label{\detokenize{ProCoDA/ProCoDA:figure-photometer-exploded}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{Photometer_w_signal_conditioning}.jpg}
\caption{The photometer must always be held in a vertical orientation to ensure that air bubbles are carried out of the sample cell. The sensor output is conditioned for monitoring by ProCoDA in the black box.}\label{\detokenize{ProCoDA/ProCoDA:id13}}\label{\detokenize{ProCoDA/ProCoDA:figure-photometer-w-signal-conditioning}}\end{figure}

To calibrate the photometer, you will need to connect the peristaltic pump, a 1 L bottle, and the photometer in a closed loop. Use enough tubing so that the flow path of the photometer is oriented in the vertical direction with flow \sphinxstylestrong{up} through the photometer (this ensures that air bubbles are carried up and out of the photometer). Add 1 L (or a known volume) of tap water to the bottle and turn the pump on at 380 mL/min. The high flow rate is to speed up the response time when the concentration is changed. The goal is to have a known volume of solution circulating through the calibration system.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{sensor_photometer_cal_schematic}.png}
\caption{Experimental setup for calibrating photometer. Flow must be \sphinxstylestrong{up} through the photometer to ensure that any air bubbles are removed. It may be necessary to lightly tap the photometer to help release any trapped air bubbles.}\label{\detokenize{ProCoDA/ProCoDA:id14}}\label{\detokenize{ProCoDA/ProCoDA:figure-sensor-photometer-cal-schematic-png}}\end{figure}


\subsubsection{Calibration steps}
\label{\detokenize{ProCoDA/ProCoDA:calibration-steps}}\begin{enumerate}
\item {} 
Connect the photometer probe to one of the sensor ports of your ProCoDA box.

\item {} 
The photometer will read out voltages in the range of +/- 5V, so we will need to let the software know to expect that range. On the Configuration Tab in the ProCoDA II software, find the section for the NI Input/Output device and hit the \sphinxincludegraphics{{config_select_daq}.png} button. Set the maximum voltage for channel with the photometer to 5V.

\item {} 
Navigate to the ProCoDA configuration tab and then select \sphinxincludegraphics{{config_sensors1}.png}.

\item {} 
Select the sensor in the sensor list that you want to configure as a photometer.

\item {} 
Make sure that the sensor channel is set correctly.

\item {} 
Select \sphinxincludegraphics{{sensor_photometer}.png}. You will see a voltage reading in the top right corner. When the LED light in the photometer is off (toggle switch in the middle) the voltage should read approximately -1.3 V. When the LED is light in the photometer is on (toggle switch to the left or right) the voltage should read approximately +3.5 V. Verify that this range is being measured and is stable in the off and on configuration. If the voltage is -1 V or +1 V, check to make sure that the voltage range for the sensor was set correctly (set step 2). If the voltage is zero, check the ProCoDA power supply. If the voltage with the LED on is less than +3.5 V, then pump water up through the photometer and tap it gently to release the air bubble that is reflecting light in the sample cell.

\item {} 
Turn the LED off and when the voltage is stable and approximately -1.3 V click on \sphinxincludegraphics{{photometer_read_dark}.png}.

\item {} 
Turn the LED on with the blank solution in the photometer and click on \sphinxincludegraphics{{photometer_read_blank}.png}. Remember the voltage should be approximately +3.5 V.

\end{enumerate}

An example continuous flow calibration routine is given below. We suggest preparing a 40 g/L stock solution of Red Dye \#40 to make a calibration curve for the photometer. Calculate the volume of red dye that will be needed to generate a calibration with points at 0, 1, 2, 5, 10, 20, 30, 40, and 50 mg/L. Remember that you will be adding the dye cumulatively and thus you need to calculate the incremental volumes. The first calibration point is 0 mg/L. This is the same as the blank.


\subsubsection{Sipper cell flow Calibration}
\label{\detokenize{ProCoDA/ProCoDA:sipper-cell-flow-calibration}}\begin{enumerate}
\item {} 
Insert the sipper tube into the standard (x mg/L) and use the syringe to pull the standard through the photometer.

\item {} 
Make sure that any air bubbles have been dislodged from the photometer and the voltage reading is stable.

\item {} 
Click on read standard next to the x mg/L row.

\item {} 
Use the syringe to push the standard back into the bottle

\item {} 
Rinse the photometer with the same water that is used for the blank if sample carry-over is a concern

\item {} 
Repeat for the other standards. The R squared value should be greater than 0.99.

\item {} 
When you are done, click on the save icon in \sphinxincludegraphics{{photometer_open_save_export1}.png} to save the calibration as a file. This calibration should be good for as long as the LED lasts, which should be a very long time!

\item {} 
Use the export icon to create a tab delimited file containing all of the calibration data.

\end{enumerate}


\subsubsection{Continuous flow Calibration}
\label{\detokenize{ProCoDA/ProCoDA:continuous-flow-calibration}}\begin{enumerate}
\item {} 
Click on read standard next to the 0 mg/L row before adding any red dye.

\item {} 
Add red dye to make the concentration in the calibration system be 1 mg/L. If necessary, hit “Add Standard” and enter the concentration of the standard you are reading. This approach allows you to see how well the data is fitting to a straight line as you add the standards.

\item {} 
Continue to add dye, add standard, equilibrate, read standard until you have a full calibration and all of the standards have been read. The R squared value should be greater than 0.99.

\item {} 
When you are done, click on the save icon in \sphinxincludegraphics{{photometer_open_save_export1}.png} to save the calibration as a file. This calibration should be good for as long as the LED lasts, which should be a very long time!

\item {} 
Use the export icon to create a tab delimited file containing all of the calibration data.

\end{enumerate}

The photometer calibrator calculates the absorbance using the equation.
\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:1}
\begin{split}A = -log \frac{V_{Sample} - V_{Dark}}{V_{Blank} - V_{Dark}}\end{split}
\end{equation}
This equation can be used to convert raw voltage data into absorbance readings. The absorbance is converted into a concentration by using Beer’s law.
\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:2}
\begin{split}A = \varepsilon bC\end{split}
\end{equation}\begin{description}
\item[{where}] \leavevmode
\begin{DUlineblock}{0em}
\item[] \(\varepsilon\) is the extinction coefficient for that particular wavelength and that particular dissolved species
\item[] \(b\) is the optical path length
\item[] \(C\) is the concentration of the dissolved species
\end{DUlineblock}

Given that \(A\) is dimensionless the extinction coefficient takes on whatever units are required.

\end{description}


\section{Logging Data}
\label{\detokenize{ProCoDA/ProCoDA:logging-data}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-logging-data}}
ProCoDA offers two distinct methods of logging data. The first method is accessed by selecting a folder (not a file!) where you would like to save data. \sphinxincludegraphics{{config_data_state_log}.png} In that system ProCoDA automatically creates 3 different types of files (data log, state log, and method file) and saves them. This approach is ideal for long term experiments that span multiple days. Every day at midnight ProCoDA starts a new data log and state log file. The daily saving and closing of the files reduces the risk of data loss due to a power failure or file corruption. The “Datalog File Failure” indicator is the one (and only) red indicator light that can be safely ignored while use ProCoDA! The state logs are particularly useful when ProCoDA is used to cycle through a series of experiments or through a series of states and thus the data may only be of interest in one of those states.

The second method of saving data only creates a data log file. This can be most convenient for short duration experiments where the researcher is present during the experiment. Data is being logged when the data log icon is green. \sphinxincludegraphics{{config_Logging_data_short_exp2}.png}

The data interval can be set for both data logging methods. The data from the data buffer is averaged according to the user selected data log interval. It is important to recognize that the logged data is \sphinxstylestrong{not} the same as the data that is used by ProCoDA to make decisions. The averaging interval used to make decisions and the averaging interval used to log data are both user selected values and are independent. This distinction becomes clear when ProCoDA logic appears to make decisions that are not in agreement with the logged data. This occurs when noisy data is used to make a decision (such as a state transition) and when smoothed data is recorded in the data file.


\section[Logic, States, and Outputs]{Logic, States, and Outputs \lowercase{\sphinxincludegraphics}{{config_edit_rules1}.png}}
\label{\detokenize{ProCoDA/ProCoDA:logic-states-and-outputs-config-edit-rules}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-logic}}
ProCoDA’s ability to quickly set up a state machine is all contained inside the rule editor.

The programming environment for creating rules that determine exit conditions for states and which state to go to readily facilitates setting up the algorithms for controlling simple repetitive processes such as a sequencing batch reactors or rapid sand filters. For experimental purposes it is desirable to have the capability to systematically vary a parameter to test the performance of the process over a range of input values. This is accomplished via an external code that compares the number of specified replicates to a parameter that increments when the ProCoDA enters a specified state. The output parameter can be used to control pump speeds, times, or can be an input to subsequent calculations.

A word of caution. The sensors, set points, and states are used within the rule editor. If new sensors, set points or states are added in the middle of their respective lists or deleted from their lists any rules that were created previously may be incorrect. The software does not attempt to correct for changes in the lists of set points and states. It is your responsibility to verify that all rules are correct when making changes to the configuration. You can minimize this problem by adding states, set points, and sensors at the end of their respective lists.


\subsection{Set Points}
\label{\detokenize{ProCoDA/ProCoDA:set-points}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-set-points}}
The rule editor provides a graphical user interface where the operator can completely configure the control logic for the plant. Begin by creating the set points for the process. Set points can include time, parameters that can be compared with sensor values, parameters that are required inputs for external code, and parameters that are outputs of external code. Set points that are outputs of external code are designated as variables. The only constraint on developing the list of set points is that set points that are inputs to external code must be in the same order (although they don’t have to be adjacent) in the list of set points as they are expected by the external code.

When adding a new set point the name, value and unit of the set point can be edited in the Set Points control. The list of the Current set points functions as the index to the array of Set Points, thus allowing the operator to select and edit any of the set points. The unit field is not used by the process controller, but is a reminder for the operator. It is imperative that the units of the set points be the same as the units of the sensor data that they will be compared with.

\sphinxincludegraphics{{SetPoints_filter_example}.png}

When configuring a set point as a variable calculated by external code first load the code by clicking on the folder icon. If the code fails to load it is either because the external code doesn’t have the correct connector pane or because the external code has sub VIs that aren’t in the same folder as the external code. If the code loads correctly it will display the list of needed inputs at the bottom of the dialog box.


\subsection{External code}
\label{\detokenize{ProCoDA/ProCoDA:external-code}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-external-code}}
LabVIEW executables can be enabled to connect to external code. This capability makes it possible to easily extend the capabilities of the ProCoDA software. The external code must be designed to meet specific requirements for the data types of inputs and outputs. An external code interface has been created to take a variable number of numeric inputs and produce a single numeric output. The external code can be used for a wide variety of functions including simple math functions, a specialized function (such as one which sets a coagulant dose based on raw water turbidity) proportional-integral-derivative control that can be used to force a controlled parameter to a desired set point, data acquisition functions that acquire digital data from instruments, and control functions that set the speed of peristaltic pumps that are connected to a USB port and a Modbus network.


\subsection{Meters and Modbus}
\label{\detokenize{ProCoDA/ProCoDA:meters-and-modbus}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-meters}}
Turbidimeters, particle counters, peristaltic pumps, and many industrial devices, can communicate with ProCoDA through a Modbus network. These devices are treated like functions and their data is accessed with an external function call in the set point list (Accessed through \sphinxincludegraphics{{config_edit_rules1}.png}).

ProCoDA connects to a Modbus network through either a serial port or a USB port with an adaptor that converts to RS485 (a serial communication standard that is widely used in industry). The Modbus system uses digital communication and enables ProCoDA to precisely control pumps and to acquire data from various meters.


\subsubsection{Tips for Modbus success!}
\label{\detokenize{ProCoDA/ProCoDA:tips-for-modbus-success}}\begin{itemize}
\item {} 
Make sure all devices that are connected to the Modbus network are turned on (have power)! Otherwise the entire network will fail.

\item {} 
When changing the unit ID on a device it is necessary to turn the device off and back on again to ensure that it has switched to the new unit ID.

\item {} 
Make sure that all devices have unique unit IDs. (Double check this!!!)

\item {} 
Use the \sphinxincludegraphics{{MB_Set_ID}.png} to see which com ports are available to know how to correctly select the com port number for configuring the Modbus communication.

\item {} 
Make sure that the communication protocol for all devices is
* Even Parity (default on Golander pumps, not default on HF turbidimeters - in the extended configuration)
* 9600 Baud
* Modbus RTU (not ASCII)

\item {} 
Use a data interval greater than 1 s for meters because the Modbus read takes a significant fraction of a second \sphinxstylestrong{per device}. This will significantly improve ProCoDA’s responsiveness

\item {} 
Set the NI Input/Output device to read 25 samples per read so that it is effectively collecting data at 100 Hz. This will also speed up ProCoDA’s responsiveness when using Modbus.

\end{itemize}


\subsubsection{Connect an HF Scientific MicroTol turbidimeter}
\label{\detokenize{ProCoDA/ProCoDA:connect-an-hf-scientific-microtol-turbidimeter}}\begin{enumerate}
\item {} 
Go to the Configuration tab and select \sphinxincludegraphics{{config_set_modbus_ID}.png}

\item {} 
Select the serial port on \sphinxincludegraphics{{MB_Set_ID}.png} to see which com ports are available to know how to correctly select the com port number for configuring the Modbus communication. Select Exit to close the dialog.

\item {} 
Go to \sphinxincludegraphics{{config_edit_rules1}.png} on the Configuration tab.

\item {} 
Add a set point for the data rate (the time interval that ProCoDA will request a turbidity update from the meter). 1 second would be very fast, 60 s would be slow.\textbar{}SetPoints\_turbidimeter\_datarate\textbar{}

\item {} 
Add a second setpoint for the com port on the computer that the turbidity meter is connected to. \sphinxincludegraphics{{SetPoints_turbidimeter_com_port}.png}

\item {} 
Enter the com port number that you discovered in step 2.

\item {} 
Add a third set point for the Turbidimeter address \sphinxincludegraphics{{SetPoints_turbidimeter_address}.png}

\item {} 
Check the unit ID on the turbidimeter (press \sphinxincludegraphics{{HF_mode_exit}.png} twice to select the config option. Then press \sphinxincludegraphics{{HF_return}.png} twice to select ADDR. You can adjust the unit ID using the up or down arrows. Press \sphinxincludegraphics{{HF_mode_exit}.png} once more to exit and return to the turbidity view screen.)

\item {} 
Add a fourth setpoint that will be the measured turbidity.

\item {} 
Change the setpoint from a constant to a variable

\item {} 
Now more options will appear click on the folder icon which will open a dialog box

\item {} 
Select \sphinxstyleemphasis{Modbus devices} and then select \sphinxstyleemphasis{HF turbidimeter}

\item {} 
Select the required set points. \sphinxincludegraphics{{SetPoints_code_inputs}.png} If successful the turbidity displayed on the meter should show up as the value. If there is a communication error you will get a -999.

\end{enumerate}


\subsubsection{Connect a Golander Peristaltic Pump}
\label{\detokenize{ProCoDA/ProCoDA:connect-a-golander-peristaltic-pump}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-golander-peristaltic-pump}}
The first step in setting up a pump is to calculate the required flow rate and then select the type of pump head (Easy-Load or 6 roller Ismatec) and the tubing size. For Easy-Load L/S Masterflex pump heads the recommended tubing sizes and corresponding range of flow rates are given below. Note that the \#13 tubing is NOT recommended because the Easy-Load pump heads don’t create a seal with this small tubing. There are usually many viable solutions for tubing size. The Golander pumps have a minimum of 0.1 rpm and the maximum rpm is a function of the pump model.
The Ismatec pump heads are useful for dosing coagulant, clay, fluoride, acid, base, etc. that are used to amend the properties of a primary flow that is pumped with an Easy-Load pump head.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Pump tubing selection.}\label{\detokenize{ProCoDA/ProCoDA:id15}}\label{\detokenize{ProCoDA/ProCoDA:table-procoda-pump-tubing}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Tubing Size
&\sphinxstyletheadfamily 
14
&\sphinxstyletheadfamily 
16
&\sphinxstyletheadfamily 
17
&\sphinxstyletheadfamily 
18
\\
\hline
Tubing diameter
&
1.6 (mm)
&
3 (mm)
&
6.3 (mm)
&
8 (mm)
\\
\hline
Flow per revolution
&
0.21 (mL/rev)
&
0.80 (mL/rev)
&
2.8 (mL/rev)
&
3.8 (mL/rev)
\\
\hline
1 (rpm)
&
0.0035 (mL/s)
&
0.0133 (mL/s)
&
0.0467 (mL/s)
&
0.0633 (mL/s)
\\
\hline
50 (rpm)
&
0.1750 (mL/s)
&
0.6667 (mL/s)
&
2.3333 (mL/s)
&
3.1667 (mL/s)
\\
\hline
100 (rpm)
&
0.3500 (mL/s)
&
1.3333 (mL/s)
&
4.6667 (mL/s)
&
6.3333 (mL/s)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

A similar table is available for 3-stop tubing used on \sphinxhref{http://www.ismatec.com/int\_e/pumps/t\_mini\_s\_ms\_ca/tubing\_msca2.htm}{Ismatec 6 roller pump heads}.
The volume per revolution can also be obtained using the following python code.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{c+c1}{\PYGZsh{} to find the volume per rev for Masterflex L/S pump heads}
\PYG{n}{ac}\PYG{o}{.}\PYG{n}{vol\PYGZus{}per\PYGZus{}rev\PYGZus{}LS}\PYG{p}{(}\PYG{l+m+mi}{14}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} to find the volume per rev for Ismatec 6 roller pump heads with 3 stop Tubing}
\PYG{n}{ac}\PYG{o}{.}\PYG{n}{vol\PYGZus{}per\PYGZus{}rev\PYGZus{}3\PYGZus{}stop}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{purple\PYGZhy{}white}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} or using the ID of the Tubing}
\PYG{n}{ac}\PYG{o}{.}\PYG{n}{vol\PYGZus{}per\PYGZus{}rev\PYGZus{}3\PYGZus{}stop}\PYG{p}{(}\PYG{n}{inner\PYGZus{}diameter}\PYG{o}{=}\PYG{l+m+mf}{0.12}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\end{sphinxVerbatim}

After selecting the pump head and tubing it is time to set up ProCoDA control of the pump.


\subsubsection{Change the Unit ID of a Golander pump}
\label{\detokenize{ProCoDA/ProCoDA:change-the-unit-id-of-a-golander-pump}}
The model BT50S Golander pumps do not have the ability to change the unit ID using the controls on the pump. The unit ID is set instead using ProCoDA. Changing the unit ID is a little complicated because we start with the assumption that we don’t know the unit ID of the device that we want to set. The method that Modbus provides for this case is to broadcast a command to ALL DEVICES telling them to change their unit ID. But, of course, this would be a bad idea if there are multiple devices listening because we don’t want all of the devices to have the same unit ID! The solution is to disconnect all of the other Modbus devices by unplugging their cables. After the cables are disconnected
\begin{enumerate}
\item {} 
Disconnect all other Modbus devices (unplug their cables) so that ProCoDA is only communicating with ONE DEVICE! This is important because the command to change the address is broadcast to all devices on the Modbus network.

\item {} 
Open \sphinxincludegraphics{{config_set_modbus_ID}.png} on the Configuration tab.

\item {} 
Select the serial port that is connected to the Modbus network

\item {} 
Select the Unit ID that you would like for the one device that is connected to the Modbus network

\item {} 
Hit Set device ID and Exit!

\item {} 
Turn off the device and turn it back on again!!!!!!! This is REQUIRED because otherwise the change you made won’t be implemented by the device and communication will fail!

\item {} 
Golander 50S pumps display the unit ID on startup.

\end{enumerate}

Now you can configure a Golander pump using the Rule Editor. The external code for Golander pumps require 5 inputs: com port, pump address, on state, pump (ml/rev), and flow (mL/s).
\begin{enumerate}
\item {} 
Go to the Configuration tab and select \sphinxincludegraphics{{config_set_modbus_ID}.png}

\item {} 
Select the serial port on \sphinxincludegraphics{{MB_Set_ID}.png} to see which com ports are available to know how to correctly select the com port number for configuring the Modbus communication. Select Exit to close the dialog.

\item {} 
Go to \sphinxincludegraphics{{config_edit_rules1}.png} on the Configuration tab.

\item {} 
Add a set point for the com port \sphinxincludegraphics{{SetPoints_turbidimeter_com_port}.png}

\item {} 
Add a set point for the pump ID (or pump address) \sphinxincludegraphics{{SetPoints_pump_address}.png}

\item {} 
Add a set point for the states that you want the pump to run \sphinxincludegraphics{{SetPoints_on_state}.png}. The states are identified as integers with the OFF state having a value of 0. To have the pump run in more than one state simple enter the digits. The assumption here is that ProCoDA won’t have more than 10 states. Thus the on state 134 means that the pump should run in states 1, 3, and 4.

\item {} 
Add a set point for the volume of water pumped per revolution with unis of mL/rev.

\item {} 
Add a set point for the desired flow rate with units of mL/s.

\item {} 
Add a set point for the pump control

\item {} 
Change the setpoint from a constant to a variable

\item {} 
Now more options will appear click on the folder icon which will open a dialog box

\item {} 
Select \sphinxstyleemphasis{Modbus devices} and then select \sphinxstyleemphasis{Golander pump(mL per s, mL per rev)}

\item {} 
Select the required set points

\end{enumerate}

Note that the pump control is the pump rpm. The pump control will only display the correct rpm if ProCoDA is in one of the states that you have defined as an on state. Otherwise the pump control will be 0. If you want the pump to turn in a counterclockwise direction, simple set the flow rate to have a negative value.

Below is an example of a ProCoDA method that has 3 pumps and two turbidimeters. The set points are defined in an order that makes it easy to select them in the right order for each pump and turbidity meter and yet keeps the list neatly organized.
\sphinxincludegraphics{{SetPoints_Golander}.png}


\subsection{Increment functions}
\label{\detokenize{ProCoDA/ProCoDA:increment-functions}}
A common experimental task is to systematically vary a parameter (for example, coagulant dose) over a wide range to measure the response (for example, settled water turbidity) of a system. ProCoDA external functions provide linear and power law options for incrementing over a range of values.
\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:3}
\begin{split}y_{linear} = slope \cdot x + intercept\end{split}
\end{equation}\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:4}
\begin{split}y_{power} = coefficient \cdot base^x\end{split}
\end{equation}
The two increment functions are dependent on the state cycles. In the example shown in \hyperref[\detokenize{ProCoDA/ProCoDA:figure-increment-functions}]{Fig.\@ \ref{\detokenize{ProCoDA/ProCoDA:figure-increment-functions}}} the state was set to cycle between states 1, 2, and 3 with the exception of a manual reset to state 0 and then to state 1 to illustrate how the increment function is reset. The power law function is useful when it is desirable to explore a larger parameter space. However, care must be taken to ensure that the controlled processes have the ability to deliver the desired range of the varied parameter.

ProCoDA can be configured to stop an experiment after the reaching the maximum value of the parameter by using the external code called “count states”. Count states counts the number of times a “state to count” has been entered. This can be used to set an exit condition on a state. If no exit condition is created to end an experiment the increment function will reset the parameter to its initial value and begin the increment process again.

It is possible to systematically vary more than one parameter. To do this it is essential that different copies of the increment function code be used for each parameter. This is because increment function code includes a memory to track its own state and if it is used by ProCoDA to do multiple things it will give unexpected results!

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{increment_functions}.png}
\caption{Increment functions showing how the output varies as a function of the state. In this example the state cycled between states 1, 2, and 3. The increment state was 2, the number of replicates was 2, the reset state was 0, the y intercept was 200, the slope was 50, and the maximum value of x was 4. The power law relationship used a coefficient of 100 and a base of 1.5.}\label{\detokenize{ProCoDA/ProCoDA:id16}}\label{\detokenize{ProCoDA/ProCoDA:figure-increment-functions}}\end{figure}


\subsection{Feedback Control}
\label{\detokenize{ProCoDA/ProCoDA:feedback-control}}\label{\detokenize{ProCoDA/ProCoDA:id4}}
Feedback control uses a measured value to make a decision in real time and change an output to achieve a desired effect. ProCoDA offers two types of feedback control. ALl of the feedback controller code has a memory and thus if multiple feedback controllers are used at the same time to control different outputs it is necessary to use external code with different names so that each process has its own memory. Different versions of these control codes are already available in the feedback control folder for this purpose.


\subsubsection{On-Off Controller}
\label{\detokenize{ProCoDA/ProCoDA:on-off-controller}}\label{\detokenize{ProCoDA/ProCoDA:id5}}
The on-off controller turns an output on when a measured value is below a threshold and turns the output off when a measured value is above a threshold.
The “off value” is the output value of the controller when the controller is off and the “on value” is the output value when the controller is on. The minimum and maximum targets can be the same value. The controller turns on when the measured process value drops below the maximum target and then turns off again when the measured process value rises above the maximum target. Under ideal conditions the measured process value will oscillate between the minimum and maximum targets. Depending on the process the measured process value may oscillate far beyond the minimum and maximum targets.


\subsubsection{Proportional Integral Derivative Control}
\label{\detokenize{ProCoDA/ProCoDA:proportional-integral-derivative-control}}\label{\detokenize{ProCoDA/ProCoDA:id6}}
Proportional Integral Derivative (PID) Control is a commonly used control strategy that provides an algorithm to adjust an output to produce the desired response in a process. A simple example is cruise control that uses the measured speed of the vehicle and a target setpoint speed to adjust the voltage to an electric motor to minimize the error between the target speed and the measured speed.

The equation for PID control is given below (\sphinxhref{https://en.wikipedia.org/wiki/PID\_controller\#PID\_controller\_theory}{see the wikipedia article}).
\begin{equation}\label{equation:ProCoDA/ProCoDA:ProCoDA/ProCoDA:5}
\begin{split}u(t) = K_{\mathrm{p}} e(t) + K_{\mathrm{i}} \int_{0}^{t} e(\tau) d \tau + K_{\mathrm{d}} \frac{d e(t)}{d t}\end{split}
\end{equation}
where \(u(t)\) is the controller output, \(t\) is the current time, \(e(t)\) is the current error (target value - measured value) \(K_{\mathrm{i}}\) and \(K_{\mathrm{d}}\) have units of minutes as implemented in ProCoDA.

To establish constants for PID control in ProCoDA, follow the \sphinxhref{https://en.wikipedia.org/wiki/PID\_controller\#Manual\_tuning}{manual tuning procedure}. The steps will be summarized below.

Select a PID controller that uses either a sensor or a setpoint as the measured process value. For example if a pressure sensor is used as the measured process value then use \sphinxstyleemphasis{PID sensor no reset.vi} because pressure sensors are handled as sensors by ProCoDA. If a turbidity meter is used as the measured process value then use \sphinxstyleemphasis{PID setpoint no reset.vi} because the turbidity is handled as a setpoint by ProCoDA. The next step is to create all of the required inputs (target value, P Kc, I Ti (min), D Td (min), Measured process value). Note that the “no reset” designation on this code means that the PID control does NOT reset when ProCoDA changes states. That is normally the preferred behavior. The exception would be if there are some states where PID is not being used to control the process. AguaClara researchers typically use PI control (the value of D is set to zero).
\begin{enumerate}
\item {} 
Set the I and D set points to zero.

\item {} 
Set P to a small value and change the target value to provoke a response from the PID control.

\item {} 
Observe the graph of the variable being controlled for this value of P. If the result is an oscillation that becomes damped (decreasing amplitude), increase the value of P (perhaps by a factor of 5) and repeat the process. If the result is an oscillation that becomes amplified (increasing amplitude), lower the value of P and repeat the process. The objective is to find a value of P for which there is a periodic oscillation of the value with a constant amplitude.

\item {} 
Record the critical P value, (:math:{}` K\_\{mathrm\{u\}\}{}`), and also record the period of the wave (time between two consecutive crests of the oscillation , (:math:{}` P\_\{mathrm\{u\}\}{}`), in minutes).

\item {} 
To find the value of P required, use the equation: \(P = \frac{K_{\mathrm{u}}}{2.2}\).

\item {} 
To find the value of I required, use the equation: \(I = \frac{P_{\mathrm{u}}}{1.2}\). This should result in a value in minutes, which is the correct unit for I.

\end{enumerate}

Change your set points (P and I) to the new values. Ensure that there is less than 10\% variation in your variable, and fine tune if necessary. This calibration method may result in oscillatory behavior. To reduce variability in the output, consider reducing P to damp the oscillations. This will reduce the responsiveness of the algorithm and will increase the stability.


\subsection{States}
\label{\detokenize{ProCoDA/ProCoDA:states}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-states}}
The list of states is created by adding new states and then naming the states in the Rules control. The states don’t necessarily have to be listed in the order of the cycle. The first state should be the default off state. This state is used by the software as the default when the process is first turned on. The off state is also used as an emergency shutdown in case of a data acquisition failure.

The control output settings for each state indicate which set point is used to control that state. All set points used for control should be in the range of 0 to 1. Fractional values for the outputs 0 to 5 will cause the output to cycle and thus control the duty cycle. Fractional values for the pump speed will control the pump speed.


\subsection[Rules]{Rules \lowercase{\sphinxincludegraphics}{{config_edit_rules1}.png}}
\label{\detokenize{ProCoDA/ProCoDA:rules-config-edit-rules}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-rules}}
The list of rules is created by adding new rules and then naming each rule in the Rules control. The rules are the logical comparisons that determine if the process should change to a new state. The logic for changing process state can include a requirement of meeting several conditions simultaneously (conditions that are “anded”). There may also be more than one rule that can cause the process to change state. These two options are incorporated into the rule editor. The “anded” rules have multiple conditions and multiple rules can be created that are essentially “ored”.
\sphinxincludegraphics{{Rules_filter}.png}

Rules that have multiple conditions that must be fulfilled simultaneously are created by increasing the number of conditions. Each conditional test will have its own logical comparison. An example of a completed rule containing two conditions is if the effluent turbidity exceeds regulations AND the time in the filtration state is greater than a minimum amount of time, then switch to backwash. Each logical comparison consists of a measured value (either a sensor value or the elapsed time in the current state) that can be selected from the drop down menu. The measured value is compared with a set point that can also be selected from a drop down menu. The type of comparison can either be less than or greater than.

Each rule can select which state the process should go to next. Thus it is possible that within the same state different rules would cause the process to change to different states. In the example here the “shut down” rule will end filtration if the clearwell is full.

The rules are implemented in the order indicated by the Current Rule control. If two rules would cause a state change at the same time, the first rule is used.


\subsection{Outputs}
\label{\detokenize{ProCoDA/ProCoDA:outputs}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-outputs}}
The ProCoDA hardware is designed and fabricated around an NI USB data acquisition board is used for on/off control of up to six devices and for variable control of up to two peristaltic pumps. The on/off devices are controlled with 24 V outputs that can be used to control solenoid valves, pinch valves, relays, or other low current devices.


\subsubsection{Analog control of pumps}
\label{\detokenize{ProCoDA/ProCoDA:analog-control-of-pumps}}\begin{description}
\item[{The older style of analog-controlled Masterflex pumps can be controlled through pump 0 or pump 1 ports using a 4-20 mA control system. There are many ways to connect a pump, I am going to stick to one pump head because it is easier and adding more is fairly straight-forward. I will also be doing it with the code that uses mL/s and tubing ID, but you can use the other external code as long as you ensure that you have the required set points.}] \leavevmode\begin{enumerate}
\item {} 
Add a constant set point with the flow in mL/s \sphinxincludegraphics{{SetPoints_pump_flow_rate}.png}

\item {} 
Add a constant set point with the tubing size that you will be using \sphinxincludegraphics{{SetPoints_pump_tubing_ID}.png}

\item {} 
Add a variable set point and call it something like “pump speed control” \sphinxincludegraphics{{SetPoints_pump_code_inputs}.png}

\item {} 
Click on the folder and open the peristaltic folder and choose the right code you want to use for this tutorial it is single head pump control (mL per second, Tubing Size)

\item {} 
Select the set points

\item {} 
It should display the speed of the pump as a fraction of maximum speed

\item {} 
Navigate to the Rules \& Outputs tab and select Outputs \sphinxincludegraphics{{Outputs_filter_waste}.png}

\item {} 
Select (or create) a state where you want the pump to be running

\item {} 
Select “On” for the pump off/on value

\item {} 
Select either “Off” for clockwise rotation or “On” for counterclockwise rotation

\item {} 
Select the variable that you created (pump speed control) for the pump speed.

\item {} 
To test the pump go to process operation and change the state to the state that has the pump running

\item {} 
If your pump is not running at the speed ProCoDA displays you can calibrate it using the \sphinxincludegraphics{{config_calibrate_pump}.png} button

\end{enumerate}

\end{description}


\subsubsection{Calibrate peristaltic pump flow rates}
\label{\detokenize{ProCoDA/ProCoDA:calibrate-peristaltic-pump-flow-rates}}\begin{enumerate}
\item {} 
If you are using an anolog controlled peristaltic pump and it is not running at full speed when ProCoDA sends it a “1” you can calibrate it using the \sphinxincludegraphics{{config_calibrate_pump}.png} button.

\item {} 
To make flow calibration easy for both analog and digital pumps, use the external code that has mL per rev as an input. For analog pumps use the \sphinxstylestrong{pump control (mL per s, mL per rev).vi} in the \sphinxstylestrong{peristaltic} folder and for Modbus pumps use \sphinxstylestrong{Golander pump(mL per s, mL per rev).vi} in the \sphinxstylestrong{Modbus devices} folder.

\item {} 
Run the pump at a known and constant rpm and measure the flow obtained. Turn that flow into mL per revolution of the pump based on the pump rpm.

\item {} 
Enter the measured value of mL/rev as a setpoint input to the external code so that the pump delivers the target flow.

\end{enumerate}


\subsubsection{On-off devices}
\label{\detokenize{ProCoDA/ProCoDA:on-off-devices}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-on-off-devices}}
Devices that are controlled with a 24 volt signal can be cycled on and off using ProCoDA. These devices are connected to ports labeled 24V 2 to 24V 7. These ports can directly control small 24V solenoid valves or they can be used with a 24V relay to provide 110V power to any device that can be safely cycled on and off. The 24V relay is connected to one of the ports and then the AC electrical power for the device is routed through the relay. A common example of this would be to turn the stirrer on and off automatically so that it doesn’t continue to run after an experiment ends. These devices are typically controlled using the setpoints ON and OFF with different values selected for each state to achieve the desired operation. It is also possible to have a device cycle on and off within a state by using feedback control (for example the on-off controller in the feedback control folder). Here is an example of a stirrer that is set to be OFF in the OFF state and is set to be ON in the warmup and run states. Note that the output settings are drop down menus showing all of the setpoint you have defined.
\sphinxincludegraphics{{Control_stirrer}.png}


\section{Process Operation}
\label{\detokenize{ProCoDA/ProCoDA:process-operation}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-process-operation}}
ProCoDA can operate in either a manual or an automated mode. In “Manual Locked in State” mode the user sets the state and ProCoDA stays in that state forever. In “Automatic Operation” the user sets the starting state and then ProCoDA uses the rule logic to move from state to state.
\sphinxincludegraphics{{Mode_of_operation1}.png}


\subsection{How to set up a timed test}
\label{\detokenize{ProCoDA/ProCoDA:how-to-set-up-a-timed-test}}\begin{enumerate}
\item {} 
Edit Rules

\item {} 
Create a constant set point with the value as the number of SECONDS you want to test to go on for

\item {} 
Go to Rules \& Outputs

\item {} 
Click on the state that runs the test then click on rules

\item {} 
Create a rule: If elapsed time in current state \textgreater{} run time of test then go to next state (the next state could be OFF if you want a simple timed test)

\item {} 
You can also do many other conditional statements with this function like have states change based on any sensor data or other variable.

\end{enumerate}


\section{Troubleshooting}
\label{\detokenize{ProCoDA/ProCoDA:troubleshooting}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-troubleshooting}}
This is complex software with lots of capabilities and thus there are many opportunities for failure. The goal is to recognize failure quickly and then fix it!
\begin{enumerate}
\item {} 
States change unexpectedly. Use data averaging on sensor and meter data to prevent noisy data signals from causing state changes.\textbar{}data\_average\textbar{}

\item {} 
Sensor out of range (change the voltage range on the {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-configure}]{\sphinxcrossref{\DUrole{std,std-ref}{data acquisition system}}}})

\item {} 
Red LED indicators indicate failures. Make sure there are no red LEDs on the configuration tab. The only allowable red LED is the Datalog File Failure if you don’t want to log data using that method.

\item {} 
A red LED next to the \sphinxincludegraphics{{config_select_daq}.png} on the configure tab indicates that the computer is not connected to a ProCoDA box. Check the USB connections. If this is the first time using ProCoDA on this computer, then make sure you have followed all of the \sphinxhref{https://github.com/monroews/LabVIEW/wiki/ProCoDA}{installation steps} because data acquisition won’t work without the data acquisition drivers.

\item {} 
Sensors give zero or close to zero response. Check the 24 volt power supply for the ProCoDA box. Check to ensure that the power supply LED lights on the back end of the ProCoDA box are lit. ProCoDA boxes built in 2014 didn’t have automatic overload protection and thus it is possible for an internal fuse to blow.

\item {} 
Software is slow and data acquisition is slow. External code that uses serial or USB port communication (turbidimeters, balances, etc.) may be incorrectly configured. If serial communication fails to these devices ProCoDA software waits until a serial port timeout occurs and during that wait everything slows down. Always switch external code that accesses meters back to constant from variable when the meter is no longer accessible by ProCoDA.

\end{enumerate}


\section{Tutorial}
\label{\detokenize{ProCoDA/ProCoDA:tutorial}}\label{\detokenize{ProCoDA/ProCoDA:heading-procoda-tutorial}}
Your goal is to set up an experiment that has one pump for the flow of water into a floc/sed apparatus and a 2nd pump that sets the coagulant dose. The target upflow velocity for the sedimentation tank is 1 mm/s and the sed tank diameter is 1 inch. Below is the code to design the experimental setup.


\subsection{Experimental design}
\label{\detokenize{ProCoDA/ProCoDA:experimental-design}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k+kn}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{n}{D} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{n}{A} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{D}\PYG{p}{)}
\PYG{n}{v\PYGZus{}up} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Q\PYGZus{}water} \PYG{o}{=} \PYG{p}{(}\PYG{n}{A} \PYG{o}{*} \PYG{n}{v\PYGZus{}up}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The water flow rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Q\PYGZus{}water}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Use an easy\PYGZhy{}load pump head with tubing codes 14, 16, 17, or 18.}
\PYG{c+c1}{\PYGZsh{} Tubing 14 won\PYGZsq{}t work because the 50 rpm pump can\PYGZsq{}t deliver the required flow}
\PYG{c+c1}{\PYGZsh{} The choice of which tubing to use is somewhat arbitrary. High rpm wears out the tubing faster}
\PYG{c+c1}{\PYGZsh{}. Low rpm likely has bigger pulsations. Your choice! Here I compromise...}
\PYG{n}{Water\PYGZus{}tubingcode} \PYG{o}{=} \PYG{l+m+mi}{17}
\PYG{c+c1}{\PYGZsh{} find the volume per rev for Masterflex L/S pump heads}
\PYG{n}{Pump\PYGZus{}water\PYGZus{}per\PYGZus{}rev} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{vol\PYGZus{}per\PYGZus{}rev\PYGZus{}LS}\PYG{p}{(}\PYG{n}{id\PYGZus{}number} \PYG{o}{=} \PYG{n}{Water\PYGZus{}tubingcode}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume of water per revolution is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pump\PYGZus{}water\PYGZus{}per\PYGZus{}rev}\PYG{p}{)}
\PYG{n}{Pump\PYGZus{}water\PYGZus{}rpm} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q\PYGZus{}water}\PYG{o}{/}\PYG{n}{Pump\PYGZus{}water\PYGZus{}per\PYGZus{}rev}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{rpm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The water pump rpm is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pump\PYGZus{}water\PYGZus{}rpm}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{for tubing size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Water\PYGZus{}tubingcode}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} The coagulant dose range is 0.5 to 8 mg/L of aluminum.}
\PYG{c+c1}{\PYGZsh{} We need the peristaltic pump pulses to be very fast compared with the residence time of the flocculator}
\PYG{c+c1}{\PYGZsh{} Let\PYGZsq{}s assume flocculator residence time 5 minutes (300 seconds)}
\PYG{c+c1}{\PYGZsh{} Set max pulse time to be 10\PYGZpc{} of flocculator residence time (3 seconds)}
\PYG{c+c1}{\PYGZsh{} Ismatec pump heads have 6 rollers, thus 6 pulses per rev}
\PYG{c+c1}{\PYGZsh{} minimum time for a pump revolution is 18 s}
\PYG{n}{Pump\PYGZus{}dosing\PYGZus{}min\PYGZus{}rpm} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min} \PYG{o}{*} \PYG{l+m+mf}{0.1} \PYG{o}{*} \PYG{l+m+mi}{6}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{turn}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{rpm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum dosing pump rpm is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pump\PYGZus{}dosing\PYGZus{}min\PYGZus{}rpm}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} The coagulant stock has 70 grams/L of aluminum}
\PYG{n}{C\PYGZus{}PACl\PYGZus{}super\PYGZus{}stock} \PYG{o}{=} \PYG{l+m+mi}{70} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{c+c1}{\PYGZsh{} Define a set of coagulant dosages over the target range with a logarithmic scaling}
\PYG{c+c1}{\PYGZsh{} the number of coagulant dosages to test. This doesn\PYGZsq{}t include an extra \PYGZdq{}free\PYGZdq{} starting value of 0 to create a control that ProCoDA adds automatically}
\PYG{n}{Max\PYGZus{}x} \PYG{o}{=} \PYG{l+m+mi}{5}
\PYG{n}{dose\PYGZus{}min} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{dose\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{C\PYGZus{}PACl\PYGZus{}dose} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{dose\PYGZus{}max}\PYG{o}{/}\PYG{n}{dose\PYGZus{}min}\PYG{p}{)}\PYG{p}{,}\PYG{n}{Max\PYGZus{}x}\PYG{p}{)}\PYG{o}{*} \PYG{n}{dose\PYGZus{}min}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The coagulant dosages in the geometric series are}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{C\PYGZus{}PACl\PYGZus{}dose}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,} \PYG{n}{C\PYGZus{}PACl\PYGZus{}dose}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Find the multiplication factor (the base) between each dose}
\PYG{n}{base} \PYG{o}{=} \PYG{p}{(}\PYG{n}{dose\PYGZus{}max}\PYG{o}{/}\PYG{n}{dose\PYGZus{}min}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{n}{Max\PYGZus{}x}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The base of the geometric series is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{base}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} The coefficient for our increment function is the minimum dose.}

\PYG{c+c1}{\PYGZsh{} Use the smallest tubing possible so we can use as high a concentration of PACl as possible.}
\PYG{c+c1}{\PYGZsh{} The smallest diameter tubing that we like to work with is 1.52 mm yellow\PYGZhy{}blue.}
\PYG{n}{Pump\PYGZus{}coag\PYGZus{}per\PYGZus{}rev} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{vol\PYGZus{}per\PYGZus{}rev\PYGZus{}3\PYGZus{}stop}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{yellow\PYGZhy{}blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The coagulant tubing volume per turn is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pump\PYGZus{}coag\PYGZus{}per\PYGZus{}rev}\PYG{p}{)}
\PYG{n}{Coag\PYGZus{}min\PYGZus{}Q} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Pump\PYGZus{}coag\PYGZus{}per\PYGZus{}rev}\PYG{o}{*}\PYG{n}{Pump\PYGZus{}dosing\PYGZus{}min\PYGZus{}rpm}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum coagulant flow is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Coag\PYGZus{}min\PYGZus{}Q}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} now we can find the maximum coagulant stock concentration using the min dose and min flow rate}
\PYG{n}{C\PYGZus{}PACl\PYGZus{}stock} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{floor\PYGZus{}step}\PYG{p}{(}\PYG{n}{dose\PYGZus{}min}\PYG{o}{*}\PYG{n}{Q\PYGZus{}water}\PYG{o}{/}\PYG{n}{Coag\PYGZus{}min\PYGZus{}Q}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The PACl stock concentration is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{C\PYGZus{}PACl\PYGZus{}stock}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Now find the flow of the PACl stock for these target dosages}
\PYG{n}{Q\PYGZus{}PACl\PYGZus{}stock} \PYG{o}{=} \PYG{n}{Q\PYGZus{}water}\PYG{o}{*}\PYG{n}{C\PYGZus{}PACl\PYGZus{}dose}\PYG{o}{/}\PYG{n}{C\PYGZus{}PACl\PYGZus{}stock}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The coagulant flow rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Q\PYGZus{}PACl\PYGZus{}stock}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mL/s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{Pump\PYGZus{}coag\PYGZus{}rpm} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q\PYGZus{}PACl\PYGZus{}stock}\PYG{o}{/}\PYG{n}{Pump\PYGZus{}coag\PYGZus{}per\PYGZus{}rev}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{rpm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The pump rpm for the different flow rates are}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pump\PYGZus{}coag\PYGZus{}rpm}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,} \PYG{n}{Pump\PYGZus{}coag\PYGZus{}rpm}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{Below are the results from the calculations above.}] \leavevmode\begin{itemize}
\item {} 
The water flow rate is 0.5067 milliliter / second

\item {} 
The volume of water per revolution is 2.8 milliliter / turn

\item {} 
The water pump rpm is 10.86 revolutions\_per\_minute for tubing size 17

\item {} 
The minimum dosing pump rpm is 0.3333 revolutions\_per\_minute

\item {} 
The coagulant dosages in the geometric series are {[}0.5 1.  2.  4.  8. {]} milligram / liter

\item {} 
The base of the geometric series is 2 dimensionless

\item {} 
The coagulant tubing volume per turn is 0.1488 milliliter / rev

\item {} 
The minimum coagulant flow is 0.0008269 milliliter / second

\item {} 
The PACl stock concentration is 300 milligram / liter

\item {} 
The coagulant flow rate is {[}0.00084451 0.00168902 0.00337805 0.0067561  0.0135122 {]} mL/s

\item {} 
The pump rpm for the different flow rates are {[}0.34042406 0.68084811 1.36169622 2.72339245 5.4467849 {]} revolutions\_per\_minute

\end{itemize}

\end{description}


\subsection{Set up a timed cycle of two states (run and warmup)}
\label{\detokenize{ProCoDA/ProCoDA:set-up-a-timed-cycle-of-two-states-run-and-warmup}}
We will use the rule editor to set up the {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-logic}]{\sphinxcrossref{\DUrole{std,std-ref}{ProCoDA logic}}}} for the experiment.
\begin{enumerate}
\item {} 
Go to \sphinxincludegraphics{{config_edit_rules1}.png} on the Configuration tab.

\item {} 
Go to the Set Points tab

\item {} 
Delete All Set Points to create a new clean method

\item {} 
Create a new set point that is the total plant flow (water + coag) with a value of 0.5067 mL/s

\item {} 
Create a new set point that is the duration of run in seconds with a value of 5

\item {} 
Create a new set point that is the duration of warmup in seconds with a value of 1 \sphinxincludegraphics{{Tutorial_timers}.png}

\item {} 
Select the Rules and Outputs tab

\item {} 
Select the Rules tab

\item {} 
Add State After and call it Run (this is in the state 1 position)

\item {} 
Add State After and call it Warmup (this is in the state 2 position)

\item {} 
Edit the exit rule for the Warmup as shown \sphinxincludegraphics{{Tutorial_rule_reset}.png}

\item {} 
Edit the exit rule for the Run state so that the two states cycle

\end{enumerate}


\subsection{Set up two pumps}
\label{\detokenize{ProCoDA/ProCoDA:set-up-two-pumps}}
{\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-golander-peristaltic-pump}]{\sphinxcrossref{\DUrole{std,std-ref}{Connect a Golander Peristaltic Pump}}}} provides an explanation of how the pumps are controlled. Use the table below as a guide. Go through the table below and add all of these set points. Note that when you load external code it always lists what the required inputs are at the bottom of the dialog box.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{ProCoDA tutorial method to vary coagulant dose for a series of 6 experiments}\label{\detokenize{ProCoDA/ProCoDA:id17}}\label{\detokenize{ProCoDA/ProCoDA:table-procoda-tutorial-method}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Set Point
&\sphinxstyletheadfamily 
unit
&\sphinxstyletheadfamily 
type
&\sphinxstyletheadfamily 
value
&\sphinxstyletheadfamily 
notes
\\
\hline
Plant flow
&
mL/s
&
constant
&
0.5067
&
total flow of water
\\
\hline
Duration of run
&
s
&
constant
&
5
&
perhaps steady state operation for data collection
\\
\hline
Duration of warmup
&
s
&
constant
&
1
&
time required for startup (start with a small value for testing!)
\\
\hline
data interval
&
s
&
constant
&
5
&
used to set data interval for turbidimeters
\\
\hline
com
&
none
&
constant
&
?
&
different for each workstation
\\
\hline
water pump ID
&
none
&
constant
&
2
&
change this to match your pumps
\\
\hline
coag pump ID
&
none
&
constant
&
1
&
change this to match your pumps
\\
\hline
on state
&
none
&
constant
&
12
&
on for both states 1 and 2 (run and warmup)
\\
\hline
water volume per rev
&
mL/rev
&
constant
&
2.8
&
based on \#17 tubing
\\
\hline
coag volume per rev
&
mL/rev
&
constant
&
0.1488
&
based on yellow-blue 3 stop tubing
\\
\hline
water flow
&
mL/s
&
variable
&
subtract function
&
Plant flow - coag flow
\\
\hline
coag flow
&
mL/s
&
variable
&
increment by factor rep
&
will systematically vary coag flow!
\\
\hline
water pump control
&
rpm
&
variable
&
Golander pump
&
controls the water pump
\\
\hline
coag pump control
&
rpm
&
variable
&
Golander pump
&
controls the coagulant pump
\\
\hline
state to increment
&
none
&
constant
&
2 (reset state)
&
increment x whenever it enters the run state
\\
\hline
coefficient
&
mL/s
&
constant
&
0.0008269 (min coag flow)
&
sets the first nonzero value of the series
\\
\hline
base
&
none
&
constant
&
2
&
base that is raised to the power of x
\\
\hline
max x
&
none
&
constant
&
5
&
number of nonzero coagulant dosages
\\
\hline
reps
&
none
&
constant
&
2
&
number of times to repeat each test
\\
\hline
max x + 1
&
none
&
variable
&
add
&
add max x + ON
\\
\hline
max cycles
&
none
&
variable
&
multiply
&
max x +1 times reps
\\
\hline
cycles
&
none
&
variable
&
count states
&
counts number of times the run state is called
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

The ProCoDA method file for this setup is available for you to try. Use the \sphinxincludegraphics{{Config_open_save_export2}.png} on the ProCoDA configuration tab (select the left open folder icon) to load the \sphinxhref{https://github.com/monroews/EnvEngLabTextbook/raw/master/ProCoDA/methods/Tutorial\_method.pcm}{method file for the tutorial}. Remember to check the com port and the pump ID addresses to make sure they match your setup!


\subsection{Set the end condition for the experiment}
\label{\detokenize{ProCoDA/ProCoDA:set-the-end-condition-for-the-experiment}}
We want ProCoDA to turn everything off after each of the coagulant dosages is tested twice. We can do that by adding a second exit condition for the Warmup state that exits to the OFF state when the total number of times that the Warmup state should execute has been reached.
\begin{enumerate}
\item {} 
Open the Rules and Outputs tab

\item {} 
Select the Warmup state

\item {} 
Add a new rule to exit to OFF \sphinxincludegraphics{{Tutorial_rule_end}.png}

\end{enumerate}


\subsection{Test your automation sequence}
\label{\detokenize{ProCoDA/ProCoDA:test-your-automation-sequence}}\begin{enumerate}
\item {} 
Close the rule editor

\item {} 
go to the Process Operation tab

\item {} 
Change the mode of operation to Automatic

\item {} 
Select the Warmup state

\item {} 
Go to the Graphs tab

\item {} 
Select \sphinxstyleemphasis{water pump control (rpm)}, \sphinxstyleemphasis{water pump control (rpm)}, and \sphinxstyleemphasis{cycles} (use the control key as you select multiple entries)

\item {} 
Set which axis (left or right) each plot is graphed on by right clicking on the legend where the color of the plot is shown and select y-scale and then select left or right. Use the left axis for the pump rpm and the right axis for the cycles.

\item {} 
Change the left y axis to log scale \sphinxincludegraphics{{Tutorial_log_axis}.png} because we are using a geometric series of flow rates

\item {} 
Return to the Process Operation tab

\item {} 
Right click on Warmup in the operator selected state to tell ProCoDA to return to that state. (Note that the operator selected state is NOT necessarily the state that ProCoDA is in! It is the state that the operator told ProCoDA to start in!)

\item {} 
Return to the Graphs tab

\item {} 
Select Clear graphs

\item {} 
See if you can create this graph \sphinxincludegraphics{{Tutorial_graph}.png}

\end{enumerate}


\subsection{Play}
\label{\detokenize{ProCoDA/ProCoDA:play}}\begin{enumerate}
\item {} 
Set up {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-logging-data}]{\sphinxcrossref{\DUrole{std,std-ref}{data logging}}}} using the method that also creates a state log

\item {} 
Run your experiment again

\item {} 
Open the data file and the state file to see what ProCoDA is recording

\item {} 
Add a  {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-pressure-measurement}]{\sphinxcrossref{\DUrole{std,std-ref}{pressure sensor}}}} or a {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-temperature-measurement}]{\sphinxcrossref{\DUrole{std,std-ref}{temperature sensor}}}}

\item {} 
Change the {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-configure}]{\sphinxcrossref{\DUrole{std,std-ref}{sensor data rate}}}} to be super fast or super slow and then change the graph update interval to see if you can detect the big difference in the sensor data noise.

\item {} 
Add a device (perhaps a stirrer) that turns {\hyperref[\detokenize{ProCoDA/ProCoDA:heading-procoda-on-off-devices}]{\sphinxcrossref{\DUrole{std,std-ref}{on and off depending on the state}}}}. The \sphinxhref{https://github.com/monroews/EnvEngLabTextbook/raw/master/ProCoDA/methods/Tutorial\_method.pcm}{method file for the tutorial} is configured to turn a device on and off on port 24V 2.

\end{enumerate}


\section{References}
\label{\detokenize{ProCoDA/ProCoDA:references}}\begin{quote}

anonymous (1993) MAXIM 1.2 mA Max, Single/Dual/Quad, Single-Supply Op Amps. Accessed 4/16 2007. \sphinxurl{http://www.ortodoxism.ro/datasheets/maxim/MAX406-MAX419.pdf}

Braatz, R. D. and Johnson, M. R. (1998) Process control laboratory education using a graphical operator interface. Computer Applications in Engineering Education 6(3), 151.

Choi, C. H. (2004) Undergraduate controls laboratory experience. In: ASEE Annual Conference Proceedings, 14425.

Rehg, J. A., Swain, W. H., Yangula, B. P., Wheatman, S. (1999) Fieldbus in the process control laboratory - its time has come. In: Proceedings - Frontiers in Education Conference, 13b4-12.
\end{quote}

\sphinxhref{https://github.com/monroews/EnvEngLabTextbook/releases/latest}{PDF and LaTeX versions} %
\begin{footnote}[1]\sphinxAtStartFootnote
PDF and LaTeX versions may contain visual oddities because it is generated automatically. The website is the recommended way to read this textbook. \sphinxhref{https://github.com/monroews/EnvEngLabTextbook}{Please visit our GitHub site} to submit an issue, contribute, or comment.
%
\end{footnote}.
\paragraph{\sphinxstylestrong{Notes}}



\renewcommand{\indexname}{Index}
\printindex
\end{document}